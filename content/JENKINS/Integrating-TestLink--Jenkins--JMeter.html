<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Integrating TestLink  Jenkins  JMeter</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                    <li>
                                <span><a href="TestLink-Plugin.html">TestLink Plugin</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Integrating TestLink  Jenkins  JMeter
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (mibj)</span>, last modified on Jan 07, 2014
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="IntegratingTestLinkJenkinsJMeter-IntegratingTestLink/Jenkins/JMeter-described">Integrating TestLink / Jenkins / JMeter - described</h1>

<h2 id="IntegratingTestLinkJenkinsJMeter-Required/referencedartifacts">Required/referenced artifacts</h2>

<p>The listed artifacts below were the currently available versions at the time of integration.</p>
<div class="table-wrap"><table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Artifact </p></th>
<th class="confluenceTh"><p> Installed/coherent version </p></th>
<th class="confluenceTh"><p> Homepage​/Download page </p></th>
<th class="confluenceTh"><p> Installed​ </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> TestLink </p></td>
<td class="confluenceTd"><p> 1.9.9 </p></td>
<td class="confluenceTd"><p> <a href="http://testlink.org/" class="external-link" rel="nofollow">http://testlink.org/</a> </p></td>
<td class="confluenceTd"><p> TestLink server </p></td>
</tr>
<tr>
<td class="confluenceTd"><p> Jenkins </p></td>
<td class="confluenceTd"><p> 1.542 </p></td>
<td class="confluenceTd"><p> <a href="http://jenkins-ci.org/" class="external-link" rel="nofollow">http://jenkins-ci.org/</a> </p></td>
<td class="confluenceTd"><p> Jenkins build machine </p></td>
</tr>
<tr>
<td class="confluenceTd"><p> JMeter </p></td>
<td class="confluenceTd"><p> 2.10 </p></td>
<td class="confluenceTd"><p> <a href="http://jmeter.apache.org/" class="external-link" rel="nofollow">http://jmeter.apache.org/</a> </p></td>
<td class="confluenceTd"><p> Jenkins build machine </p></td>
</tr>
<tr>
<td class="confluenceTd"><p> libxml-xpath-perl </p></td>
<td class="confluenceTd"><p> 1.13-7 </p></td>
<td class="confluenceTd"><p> <a href="http://packages.debian.org/search?keywords=libxml-xpath-perl" class="external-link" rel="nofollow">http://packages.debian.org/search?keywords=libxml-xpath-perl</a> </p></td>
<td class="confluenceTd"><p> Jenkins build machine </p></td>
</tr>
<tr>
<td class="confluenceTd"><p> ​TestLink plugin </p></td>
<td class="confluenceTd"><p> 3.9 </p></td>
<td class="confluenceTd"><p> <a href="https://wiki.jenkins-ci.org/display/JENKINS/TestLink+Plugin" class="external-link" rel="nofollow">https://wiki.jenkins-ci.org/display/JENKINS/TestLink+Plugin</a> </p></td>
<td class="confluenceTd"><p> – </p></td>
</tr>
<tr>
<td class="confluenceTd"><p> Ant </p></td>
<td class="confluenceTd"><p> 1.7.1 </p></td>
<td class="confluenceTd"><p> <a href="http://ant.apache.org/" class="external-link" rel="nofollow">http://ant.apache.org/</a> </p></td>
<td class="confluenceTd"><p> Jenkins build machine </p></td>
</tr>
<tr>
<td class="confluenceTd"><p> jmeter-ant-task </p></td>
<td class="confluenceTd"><p> 1.1.1 </p></td>
<td class="confluenceTd"><p> <a href="http://www.programmerplanet.org/projects/jmeter-ant-task/" class="external-link" rel="nofollow">http://www.programmerplanet.org/projects/jmeter-ant-task/</a> </p></td>
<td class="confluenceTd"><p> Jenkins build machine </p></td>
</tr>
<tr>
<td class="confluenceTd"><p> TAP (Test Anything Protocol) </p></td>
<td class="confluenceTd"><p> 13 </p></td>
<td class="confluenceTd"><p> <a href="http://podwiki.hexten.net/TAP/TAP13.html?page=TAP13" class="external-link" rel="nofollow">http://podwiki.hexten.net/TAP/TAP13.html?page=TAP13</a> </p></td>
<td class="confluenceTd"><p> Standard adherence - RTM </p></td>
</tr>
</tbody></table></div>


<p>All underlying framework, such as a stable ubuntu version, mysql and perl on the Jenkins build machine and TestLink server machine above are expected to be in place prior to adding the listed artifacts.</p>

<h2 id="IntegratingTestLinkJenkinsJMeter-Intendedaudienceofthisdescription">Intended audience of this description</h2>

<p>Staff working with:</p>
<ul>
	<li>Requirements authoring (requirement owners / solution architects / senior testers)</li>
	<li>Test case authoring (test staff / solution developer working with test)</li>
</ul>


<h2 id="IntegratingTestLinkJenkinsJMeter-Theintendedoutcomeofthisdescription">The intended outcome of this description</h2>

<p>For descriptions on the bulleted items below, see their respective link in the table above.</p>

<p>This documentation <strong>DOES NOT</strong> describe:</p>
<ul>
	<li>How to install TestLink</li>
	<li>How to install Jenkins</li>
	<li>How to install Jenkins plugins</li>
	<li>How to install JMeter</li>
	<li>How to install libxml-xpath-perl</li>
	<li>How to install Ant</li>
	<li>The TAP 13 file format</li>
</ul>


<p>This documentation <strong>DO</strong> describe:</p>
<ul>
	<li>How to setup Ant and TestLink plugin in Jenkins</li>
	<li>How to &quot;connect&quot; Jenkins to TestLink</li>
	<li>How to &quot;connect&quot; Jenkins to JMeter</li>
	<li>How to &quot;backwards annotate&quot; gained results from JMeter to TestLink via Jenkins</li>
</ul>


<h2 id="IntegratingTestLinkJenkinsJMeter-HowtosetupAntandTestLinkplugininJenkins">How to setup Ant and TestLink plugin in Jenkins</h2>

<p>To make sure the jmeter-ant-task is found, a Jenkins external ant shall be in place.<br/>
To comply with where most other java library jars are located, the jmeter-ant-task jar file shall be stored in &quot;java's own library directory&quot; - for me it was /usr/share/java<br/>
Download the ant-jmeter-task jar file from the download link found on the programmerplanet link in the table above.<br/>
Create a relative, soft link to the jar file in the same location as where you put the physical file.<br/>
Finally, create a relative link to the newly created, relative link in the &quot;ant library directory&quot; - for me it was /usr/share/ant/lib<br/>
After downloading the jar and creating the links you'll have something resembling this:</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696390.png" data-image-src="attachments/71434364/71696390.png" data-unresolved-comment-count="0" data-linked-resource-id="71696390" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="00.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>Then, in jenkins, you shall make the following settings. As stated  above, installation of ant is outside scope of this description.</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696391.png" data-image-src="attachments/71434364/71696391.png" data-unresolved-comment-count="0" data-linked-resource-id="71696391" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="01.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>Before setting up the TestLink plugin in Jenkins, you must prepare a 'Personal API access key' in TestLink.</p>

<p>Creation of the key is done in TestLink under 'My Settings', as shown below.</p>

<p>The key is known as 'Developer Key' from Jenkins point of view, when setting up the TestLink plugin:</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696392.png" data-image-src="attachments/71434364/71696392.png" data-unresolved-comment-count="0" data-linked-resource-id="71696392" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="02.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>After having set-up the ant part in Jenkins, you'll need to make Jenkins aware of TestLink:</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696389.png" data-image-src="attachments/71434364/71696389.png" data-unresolved-comment-count="0" data-linked-resource-id="71696389" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="03.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<h2 id="IntegratingTestLinkJenkinsJMeter-Howto&quot;connect&quot;JenkinstoTestLink">How to &quot;connect&quot; Jenkins to TestLink</h2>

<p>In Jenkins, create a new 'free-style software project'  job as shown below. This sequence is done only once per project and connects the testcases from TestLink with a stated TestLink project name AND TestLink testplan. Using Jenkins to start different sets of testcases, either select different TestLink projects, different TestLink testplans or a combination of the two, for each defined Jenkins job.</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696388.png" data-image-src="attachments/71434364/71696388.png" data-unresolved-comment-count="0" data-linked-resource-id="71696388" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="04.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>When the job is created, it need to be set-up as shown below.<br/>
The details on the following pictures are shown in the order they are listed, top-most first, in Jenkins' project's 'Configure' view.</p>

<p>A good idea is to control certain test settings at build time.<br/>
To enable this, define - when configuring the Jenkins job or change it at a later stage - the parameters you want to control.<br/>
The parameters defined here will be forward-able - at build time - to JMeter indirectly via ant, thus enabling detailed control also at build time.</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696395.png" data-image-src="attachments/71434364/71696395.png" data-unresolved-comment-count="0" data-linked-resource-id="71696395" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="05.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>The mercurial repository must be set-up, to always be able to run the tests using the latest checked in test cases &quot;from&quot; JMeter.</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696396.png" data-image-src="attachments/71434364/71696396.png" data-unresolved-comment-count="0" data-linked-resource-id="71696396" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="06.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>It may be a good idea to also turn on explicit time stamping of each build step in Jenkins.</p>

<p>This is how I set it up and is, of course, not mandatory.</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696397.png" data-image-src="attachments/71434364/71696397.png" data-unresolved-comment-count="0" data-linked-resource-id="71696397" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="07.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>In the 'Build' part of the job definition, I selected to start the build sequence with an 'Invoke Ant' step, ti discard any old build log files and intermediate files.</p>

<p>This is not mandatory but, if any old TAP files still exists, may give inconsistent results returned to TestLink when executing the 'Result Seeking'...</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696394.png" data-image-src="attachments/71434364/71696394.png" data-unresolved-comment-count="0" data-linked-resource-id="71696394" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="08.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>The next step, of the 'build' sequence, is to pinpoint the exact TestLink artifacts I'm interested in.</p>

<p>Here, you select the defined (previous chapter) TestLink instance.</p>

<p>The 'build name' will automatically create a new build instance in TestLink, which is very convenient.</p>

<p>The 'custom fields' are used by ant when selecting the test file to execute in JMeter and by the TestLink TAP parser when parsing the results returned originally from JMeter.</p>

<p>The parameters to define are:</p>
<ul>
	<li>TestLink Project Name</li>
	<li>TestLink Test Plan Name</li>
	<li>Build Name. Here I used a static text followed by build-time parameters provided by Jenkins</li>
	<li>Custom Fields. These must match the defined Custom fields from TestLink that you must use...</li>
</ul>


<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696393.png" data-image-src="attachments/71434364/71696393.png" data-unresolved-comment-count="0" data-linked-resource-id="71696393" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="09.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>Connected to the TestLink Configuration you must execute the ant build script located in the jmeter directory at the top level of the test case repository. For this to work, you must already have installed an external ant version and added the jmeter-ant-task library jar to it.</p>

<p>There's only ONE build target for Jenkins to use - the AutoTest target.  The AutoTest target can be used from a command line in linux as well, given that you provide the required parameters that come automagically when running from Jenkins.  A working example - when standing in the top level directory of the JMeter project (/repository/igloo_tester/jmeter) is shown below.  This will produce xml log files and xslt'ed html files only and wont propagate gained results to TestLink.  For a full listing of the ant script, see chapter 'How to &quot;connect&quot; Jenkins to JMeter' further down:</p>

<p><code>ant -DGUI=false -DTEST_ENVIRONMENT=2 -DTESTLINK_TESTCASE_TESTFILEPATH=utils/SkapaEngagemang.jmx AutoTest</code></p>

<p>The two parameters to set here are:</p>
<ul>
	<li>Targets - Autotest</li>
	<li>Build File - jmeter/build.xml</li>
</ul>


<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696399.png" data-image-src="attachments/71434364/71696399.png" data-unresolved-comment-count="0" data-linked-resource-id="71696399" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="10.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>After having executed all testcases in the iterative test build steps above, the xml output files from JMeter must be translated into one of the formats that the TestLink plugin support.  The three available formats are logs formatted according to log file formats JUnit, TAP and TestNG.  The testcases we execute are not performance related, thus we have no direct use for any performance data, which is what JMeter is mainly made for.  We're instead focused on verifying the functionality of the target system and are more interested in recording the assertions outcome and will constrain our effort to record PASS or FAIL on a per test step basis.</p>

<p>The script executed below (partly shown in the Command part) will translate the xml files from JMeter XML log file format to TAP 13 format, to enable the TestLink plugin to interpret the outcome.  See chapter 'How to &quot;backwards annotate&quot; gained results from JMeter to TestLink via Jenkins' further down for the bash script details.  The script can be pasted into the 'Execute shell' 'Command' part below.</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696400.png" data-image-src="attachments/71434364/71696400.png" data-unresolved-comment-count="0" data-linked-resource-id="71696400" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="11.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>The Result Seeking Strategy indicate to TestLink plugin what output to look for. In our case it is TAP 13.</p>

<p>The parameters to set here are:</p>
<ul>
	<li>Include Pattern (ant'ish) - **<strong>/out/</strong>.tap</li>
	<li>Key Custom Field (this must match what you state on a test case basis) - in my case 'JMeter TestCase'</li>
	<li>Select the Attach TAP YAMLish attachments (I'm not sure if this is required to interpret the YAMLish provided by the bash script, but it doesn't hurt)</li>
</ul>


<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696401.png" data-image-src="attachments/71434364/71696401.png" data-unresolved-comment-count="0" data-linked-resource-id="71696401" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="12.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<p>The final part is optional. If you want the test results reflected also in Jenkins, you must have the TAP plugin installed in Jenkins.</p>

<p>Then, to make it work, state the following parameters:</p>
<ul>
	<li>Test results (ant'ish) - **<strong>/out/</strong>.tap</li>
	<li>Check the checkbox 'Is TAP plan required?'.</li>
</ul>


<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71434364/71696398.png" data-image-src="attachments/71434364/71696398.png" data-unresolved-comment-count="0" data-linked-resource-id="71696398" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="13.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71434364" data-linked-resource-container-version="12"></span></p>

<h2 id="IntegratingTestLinkJenkinsJMeter-Howto&quot;connect&quot;JenkinstoJMeter">How to &quot;connect&quot; Jenkins to JMeter</h2>

<p>The ant build script listed below is required to enable Jenkins starting JMeter with all needed parameters.</p>

<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: xml; gutter: false; theme: Confluence" data-theme="Confluence">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project name=&quot;JmeterTest&quot;&gt;
  &lt;!-- For details of how to use this jMeter wrapper, see information on:                --&gt;
  &lt;!-- http://www.programmerplanet.org/projects/jmeter-ant-task/                         --&gt;
  &lt;!--                                                                                   --&gt;
  &lt;!-- For an example of a jmeter ant build script, see:                                 --&gt;
  &lt;!-- http://sub-second.blogspot.se/2012/03/how-to-integrate-jmeter-into-ant-build.html --&gt;
  &lt;!--                                                                                   --&gt;

  &lt;!-- The ant build script is located in our project&#39;s top directory jmeter...          --&gt;
  &lt;!-- The script is normally started either from command line in directory jmeter or    --&gt;
  &lt;!-- from within a Jenkins project.                                                    --&gt;
  &lt;property name=&quot;project.root&quot; value=&quot;.&quot;/&gt;
  &lt;property name=&quot;output.root&quot; value=&quot;${project.root}/out&quot;/&gt;
  &lt;property name=&quot;jmeterhome&quot; value=&quot;/opt/apps/jmeter/current&quot;/&gt;

  &lt;!-- Disclose all defined environment variables to ant.                                --&gt;
  &lt;property environment=&quot;env&quot;/&gt;

  &lt;!-- If either of user root or jenkins started the ant build (in our project)set the   --&gt;
  &lt;!-- property jenkinsBuild.                                                            --&gt;
  &lt;!-- The list below can grow with other &quot;jenkins users&quot; when needed.                   --&gt;
  &lt;condition property=&quot;jenkinsBuild&quot;&gt;
    &lt;or&gt;
      &lt;equals arg1=&quot;${env.USER}&quot; arg2=&quot;jenkins&quot;/&gt;
      &lt;equals arg1=&quot;${env.USER}&quot; arg2=&quot;root&quot;/&gt;
    &lt;/or&gt;
  &lt;/condition&gt;

  &lt;!-- If one of the defined &quot;jenkins users&quot; above started the ant script, here&#39;s where  --&gt;
  &lt;!-- the stylesheetHome variable is set.                                               --&gt;
  &lt;target name=&quot;JenkinsIgnited&quot; if=&quot;jenkinsBuild&quot;&gt;
    &lt;property name=&quot;stylesheetHome&quot; value=&quot;${project.root}/stylesheets&quot;/&gt;
  &lt;/target&gt;

  &lt;!-- Otherwise - if an ordinary user started this script - here&#39;s where the            --&gt;
  &lt;!-- stylesheetHome variable is set.                                                   --&gt;
  &lt;target name=&quot;UserIgnited&quot; unless=&quot;jenkinsBuild&quot;&gt;
    &lt;property name=&quot;stylesheetHome&quot; value=&quot;${jmeterhome}/extras&quot;/&gt;
  &lt;/target&gt;

  &lt;!-- A build target to remove an existing output directory and all its content.        --&gt;
  &lt;target name=&quot;clean&quot;&gt;
    &lt;delete dir=&quot;${output.root}&quot;/&gt;
  &lt;/target&gt;

  &lt;!-- Create the output directory if not already done.                                  --&gt;
  &lt;!-- Declare the testplan.filename variable to be used when running jmeter.            --&gt;
  &lt;!-- The declaration MUST have a defined variable TESTLINK_TESTCASE_TESTFILEPATH in    --&gt;
  &lt;!-- calling environment to know what file to use for test by jmeter.                  --&gt;
  &lt;!-- Thus, the correct syntax for starting this ant build script from command line is: --&gt;
  &lt;!-- ant -DGUI=false -DTEST_ENVIRONMENT=2 -DTESTLINK_TESTCASE_TESTFILEPATH=test.jmx    --&gt;
  &lt;!--     AutoTest                                                                      --&gt;
  &lt;target name=&quot;create-output-directory&quot;&gt;
    &lt;!-- Prepare the out directory.                                                      --&gt;
    &lt;mkdir dir=&quot;${output.root}&quot; /&gt;

    &lt;!-- Sort out filename of the testplan.                                              --&gt;
    &lt;basename property=&quot;testplan.filename&quot; file=&quot;${env.TESTLINK_TESTCASE_TESTFILEPATH}&quot; suffix=&quot;.jmx&quot;/&gt;
    &lt;echo message=&quot;testplan.filename: ${testplan.filename}&quot;/&gt;
  &lt;/target&gt;

  &lt;!-- Define jmeter task. Needed to trigger the ant-jmeter add-on.                      --&gt;
  &lt;taskdef name=&quot;jmeter&quot; classname=&quot;org.programmerplanet.ant.taskdefs.jmeter.JMeterTask&quot;/&gt;

  &lt;!-- Run the specified JMeter TestPlan file.                                           --&gt;
  &lt;target name=&quot;AutoTest&quot; depends=&quot;create-output-directory,JenkinsIgnited,UserIgnited&quot;&gt;
    &lt;echo message=&quot;Test started by ${env.USER}.&quot;/&gt;
    &lt;jmeter
      jmeterhome=&quot;${jmeterhome}&quot;
      testplan=&quot;${env.TESTLINK_TESTCASE_TESTFILEPATH}&quot;
      resultlog=&quot;${output.root}/${testplan.filename}.xml&quot;
      jmeterlogfile=&quot;${output.root}/jmeter.log&quot;&gt;

      &lt;property name=&quot;user.classpath&quot; value=&quot;${jmeterhome}/lib/ext/ApacheJMeter_core.jar:${jmeterhome}/lib/ext/ApacheJMeter_java.jar&quot;/&gt;
      &lt;!-- Force suitable defaults                                                       --&gt;
      &lt;property name=&quot;jmeter.save.saveservice.output_format&quot; value=&quot;xml&quot;/&gt;
      &lt;property name=&quot;jmeter.save.saveservice.assertion_results&quot; value=&quot;all&quot;/&gt;
      &lt;property name=&quot;jmeter.save.saveservice.bytes&quot; value=&quot;true&quot;/&gt;

      &lt;property name=&quot;GUI&quot; value=&quot;false&quot;/&gt;
      &lt;property name=&quot;TEST_ENVIRONMENT&quot; value=&quot;${env.TEST_ENVIRONMENT}&quot;/&gt;
    &lt;/jmeter&gt;

    &lt;xslt
      in=&quot;${output.root}/${testplan.filename}.xml&quot;
      out=&quot;${output.root}/${testplan.filename}.html&quot;
      style=&quot;${stylesheetHome}/jmeter-results-detail-report_21.xsl&quot;/&gt;
  &lt;/target&gt;
&lt;/project&gt;
</pre>
</div></div>

<h2 id="IntegratingTestLinkJenkinsJMeter-Howto&quot;backwardsannotate&quot;gainedresultsfromJMetertoTestLinkviaJenkins">How to &quot;backwards annotate&quot; gained results from JMeter to TestLink via Jenkins</h2>

<p>The bash script listed below is required to translate the JMeter XML log file into TAP 13 format that can be read by the TestLink plugin and the TAP plugin.</p>

<div class="code panel pdl" style="border-style: solid;border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>jmeter-xml-2-tap13.sh</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">
#!/bin/bash

# Parse each result file from the tests, created by JMeter when run by ant.
# Every file created by JMeter will be parsed consecutively by the following for loop.
for XML_resultfile in $(ls -1 jmeter/out/*.xml); do
  # debug
  echo &quot;XML_resultfile: ${XML_resultfile}&quot;
  # debug
  BASE_filename=$(basename ${XML_resultfile} .xml)
  TAP_filename=${BASE_filename}.tap

  # Create an array with just the testcases labels
  TestCases=( $(xpath -e &#39;//@lb&#39; ${XML_resultfile} 2&gt;/dev/null | tr -d &#39;&quot;&#39; | tr &#39; &#39; &#39;_&#39; | sed &#39;s/^_//&#39;) )
  # Create an array with testcases labels and results
  ResultLines=( $(xpath -e &#39;//@lb|//assertionResult/failure|//assertionResult/error|//assertionResult/failureMessage&#39; ${XML_resultfile} 2&gt;/dev/null | tr -d &#39;&quot;&#39; | tr &#39; &#39; &#39;_&#39; | sed &#39;s/^_//&#39;) )
  # Keep track of how many testcases there were
  num_of_testcases=${#TestCases[@]}

  # Reference to TAP13 file standard:
  # http://podwiki.hexten.net/TAP/TAP13.html?page=TAP13

  echo &quot;TAP version 13&quot; &gt; jmeter/out/${TAP_filename}
  echo &quot;1..${num_of_testcases}&quot; &gt;&gt; jmeter/out/${TAP_filename}
  result_selector=0
  if [ ${num_of_testcases} -gt 0 ]; then
    for ((line=0; ${line} &lt; ${num_of_testcases}; line++)); do
      # bash indices start at 0. Use presLine to present testcase number correctly.
      (( presLine=${line} + 1 ))
      # Some results are collected with no asserted results. When this is the case
      # all information is kept in one array item in the ResultLines array.
      # Some results come with passed or failed assertions. In these cases the
      # information is in the ResultsLine array, adjacent to the label. The res1
      # and res2 variables are used to index the adjacent array items.
      (( res1=${result_selector} + 1 ))
      (( res2=${result_selector} + 2 ))
      (( res3=${result_selector} + 3 ))
      # The label is parsed from the &lt;sample&gt; tag and has name &#39;lb&#39; as can be seen
      # in the xpath call above.
      label=&quot;${BASE_filename} - ${TestCases[${line}]:3}&quot;
      error_message=&quot;&quot;

      if [ &quot;${TestCases[${line}]}&quot; == &quot;${ResultLines[${result_selector}]}&quot; ]; then
        # When a ResultLines array item is a label and the following item is a label
        # too, the result shall be translated to PASS - TAP13: &#39;ok&#39;
        if [ &quot;${ResultLines[${res1}]:0:3}&quot; == &quot;lb=&quot; ]; then
          result=&quot;ok ${presLine} - ${label}&quot;
        fi
        # Index must be increased by one
        (( result_selector+=1 ))
      fi

      if [ &quot;${ResultLines[${res1}]:0:13}&quot; == &quot;&lt;failure&gt;fals&quot; ]; then
        if [ &quot;${ResultLines[${res2}]:0:11}&quot; == &quot;&lt;error&gt;fals&quot; ]; then
          # When a ResultLines array item is a label and the following item have the
          # error tag set to &#39;false&#39;, the result shall be translated to PASS
          # - TAP13: &#39;ok&#39;
          result=&quot;ok ${presLine} - ${label}&quot;
          # When no error occurs, there&#39;s no failureMessage
          # Index must be increased by two
          (( result_selector+=2 ))
        fi

        if [ &quot;${ResultLines[${res2}]:0:11}&quot; == &quot;&lt;error&gt;true&quot; ]; then
          # When a ResultLines array item is a label and the following item have the
          # error tag set to &#39;true&#39;, the result shall be translated to FAIL
          # - TAP13: &#39;not ok&#39;
          result=&quot;not ok ${presLine} - ${label}&quot;
          error_message=&quot;message: &#39;$(echo ${ResultLines[${res3}]} | cut -d &#39;&gt;&#39; -f 2 | cut -d &#39;&lt;&#39; -f 1)&#39;&quot;
          # When an error occurs, there&#39;s an accompanying failureMessage
          # Index must be increased by three
          (( result_selector+=3 ))
        fi
      else
        # The test step couldn&#39;t be executed for some reason
        if [ &quot;${ResultLines[${res2}]:0:11}&quot; == &quot;&lt;error&gt;fals&quot; ]; then
          # When a ResultLines array item is a label and the following item have the
          # failure tag set to &#39;false&#39;, the result shall be translated to FAIL
          # - TAP13: &#39;not ok&#39;
          result=&quot;not ok ${presLine} - ${label} # TODO The test step failed in JMeter&quot;
          error_message=&quot;message: &#39;$(echo ${ResultLines[${res3}]} | cut -d &#39;&gt;&#39; -f 2 | cut -d &#39;&lt;&#39; -f 1)&#39;&quot;
          # When no error occurs, there&#39;s no failureMessage
          # Index must be increased by three
          (( result_selector+=3 ))
        fi

        if [ &quot;${ResultLines[${res2}]:0:11}&quot; == &quot;&lt;error&gt;true&quot; ]; then
          # When a ResultLines array item is a label and the following item have the
          # error tag set to &#39;true&#39;, the result shall be translated to FAIL
          # - TAP13: &#39;not ok&#39;
          result=&quot;not ok ${presLine} - ${label} # TODO The test step failed in JMeter&quot;
          error_message=&quot;message: &#39;$(echo ${ResultLines[${res3}]} | cut -d &#39;&gt;&#39; -f 2 | cut -d &#39;&lt;&#39; -f 1)&#39;&quot;
          # When an error occurs, there&#39;s an accompanying failureMessage
          # Index must be increased by three
          (( result_selector+=3 ))
        fi
      fi

      if [ &quot;${label}&quot; != &quot;&quot; ]; then
        echo &quot;${result}&quot; | tr &#39;_&#39; &#39; &#39; &gt;&gt; jmeter/out/${TAP_filename}
      fi

      if [ &quot;${error_message}&quot; != &quot;&quot; ]; then
        echo &quot;  ---&quot; &gt;&gt; jmeter/out/${TAP_filename}
        echo &quot;  ${error_message}&quot; &gt;&gt; jmeter/out/${TAP_filename}
        echo &quot;  severity: fail&quot; &gt;&gt; jmeter/out/${TAP_filename}
        echo &quot;  ...&quot; &gt;&gt; jmeter/out/${TAP_filename}
      fi
    done
  else
    echo &quot;TAP version 13&quot; &gt; jmeter/out/${TAP_filename}
    echo &quot;1..1&quot; &gt;&gt; jmeter/out/${TAP_filename}
    echo &quot;not ok 1 - ${BASE_filename}&quot; &gt;&gt; jmeter/out/${TAP_filename}
  fi
done
</pre>
</div></div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696388.png">04.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696389.png">03.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696390.png">00.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696391.png">01.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696392.png">02.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696393.png">09.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696394.png">08.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696395.png">05.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696396.png">06.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696397.png">07.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696398.png">13.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696399.png">10.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696400.png">11.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71434364/71696401.png">12.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:52</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
