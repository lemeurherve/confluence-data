<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Durable Task Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Durable Task Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (jglick)</span>, last modified by <span class='editor'> Unknown User (dnusbaum)</span> on Jul 05, 2019
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>Library offering an extension point for processes which can run outside of Jenkins yet be monitored.<table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View Durable Task <a href="https://plugins.jenkins.io/durable-task" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>
Offers no direct features on its own but can be used by other feature plugins. <a href="https://github.com/jenkinsci/workflow-durable-task-step-plugin" class="external-link" rel="nofollow">Example</a></p><p><a href="https://web.archive.org/web/20141227025217/http://tupilabs.com/2014/06/13/durable-tasks-in-jenkins.html" class="external-link" rel="nofollow">Blog post</a></p><h2 id="DurableTaskPlugin-Changelog">Changelog</h2><h3 id="DurableTaskPlugin-Version1.30(Jul05,2019)">Version 1.30 (Jul 05, 2019)</h3><ul><li>Bugfix: Run the wrapper process for shell scripts in the background. (<a href="https://issues.jenkins-ci.org/browse/JENKINS-58290" class="external-link" rel="nofollow">JENKINS-58290</a>)</li><li>Bugfix: Use <code>sh</code> to run shell scripts rather than attempting to use the absolute path to the default shell from the master on agents. (<a href="https://github.com/jenkinsci/durable-task-plugin/pull/95" class="external-link" rel="nofollow">PR 95</a>)</li><li>Bugfix: Make PowerShell exit codes propagate correctly. Fixes a regression from version 1.23 (<a href="https://issues.jenkins-ci.org/browse/JENKINS-52884" class="external-link" rel="nofollow">JENKINS-52884</a>)</li></ul><h3 id="DurableTaskPlugin-Version1.29(Jan31,2019)">Version 1.29 (Jan 31, 2019)</h3><ul><li>Enhancement: Add support for z/OS Unix System Services to the <code>sh</code> step. (<a href="https://issues.jenkins-ci.org/browse/JENKINS-37341" class="external-link" rel="nofollow">JENKINS-37341</a>)</li></ul><h3 id="DurableTaskPlugin-Version1.28(Nov14,2018)">Version 1.28 (Nov 14, 2018)</h3><ul><li>Bugfix: Do not rely on a shebang line to select the interpreter for <code>sh</code> scripts. This means that Pipelines can now use relative names for interpreters accessible from the <code>PATH</code> environment variable. (<a href="https://issues.jenkins-ci.org/browse/JENKINS-50902" class="external-link" rel="nofollow">JENKINS-50902</a>)</li></ul><h3 id="DurableTaskPlugin-Version1.27(Nov01,2018)">Version 1.27 (Nov 01, 2018)</h3><ul><li>Do not print the working directory or the type of script being run when a durable task starts. (<a href="https://github.com/jenkinsci/durable-task-plugin/pull/83" class="external-link" rel="nofollow">PR #83</a>)</li><li>Internal: Shut down thread pools when Jenkins shuts down. Should only affect other plugins using this plugin in their tests.</li></ul><h3 id="DurableTaskPlugin-Version1.26(Sep25,2018)">Version 1.26 (Sep 25, 2018)</h3><ul><li>Bugfix: Increase the default heartbeat interval used to detect dead processes from 15 seconds to 5 minutes (<a href="https://issues.jenkins-ci.org/browse/JENKINS-48300" class="external-link" rel="nofollow">JENKINS-48300</a>)</li><li>Developer: Define API for pushing durable task logs from build agents directly instead of having the Jenkins master pull logs from build agents (<a href="https://issues.jenkins-ci.org/browse/JENKINS-52165" class="external-link" rel="nofollow">JENKINS-52165</a>)</li></ul><h3 id="DurableTaskPlugin-Version1.25(Aug8,2018)">Version 1.25 (Aug 8, 2018)</h3><ul><li>Major bugfix: Fix regressions in 1.23 and 1.24 that caused build failures when running <code>sh</code> steps in minimal environments such as Alpine and Cygwin (<a href="https://issues.jenkins-ci.org/browse/JENKINS-52881" class="external-link" rel="nofollow">JENKINS-52881</a>)</li></ul><h3 id="DurableTaskPlugin-Version1.24(Aug7,2018)">Version 1.24 (Aug 7, 2018)</h3><ul><li><strong>(Warning: Fix is incomplete. Full fix is in version 1.25)</strong> Major bugfix: Fix regression in 1.23 that caused build failures on Alpine-based build agents (<a href="https://issues.jenkins-ci.org/browse/JENKINS-52847" class="external-link" rel="nofollow">JENKINS-52847</a><a href="https://issues.jenkins-ci.org/browse/JENKINS-52847" class="external-link" rel="nofollow">)</a></li><li>Developer: Define API for gathering command output in a local encoding (<a href="https://github.com/jenkinsci/jep/blob/master/jep/206/README.adoc" class="external-link" rel="nofollow">JEP-206</a>)</li></ul><h3 id="DurableTaskPlugin-Version1.23(Jul31,2018)">Version 1.23 (Jul 31, 2018)</h3><ul><li>Major bugfix: properly count log content sent to avoid endlessly-repeating logs (<a href="https://issues.jenkins-ci.org/browse/JENKINS-37575">JENKINS-37575</a>)</li><li>Bugfix: Ensure that the logfile-touching process exits when the wrapper script running the durable task dies (<a href="https://issues.jenkins-ci.org/browse/JENKINS-50892">JENKINS-50892</a>)</li><li>Fix/Enhancement: Simplify Powershell execution and make it more consistent (<a href="https://issues.jenkins-ci.org/browse/JENKINS-50840">JENKINS-50840</a>)</li><li>Admin: support incrementals</li></ul><h3 id="DurableTaskPlugin-Version1.22(Mar13,2018)">Version 1.22 (Mar 13, 2018)</h3><ul><li>Bugfix: Fix issues with Powershell error handling (<a href="https://issues.jenkins-ci.org/browse/JENKINS-50029">JENKINS-50029</a>)</li></ul><h3 id="DurableTaskPlugin-Version1.21(Mar8,2018)">Version 1.21 (Mar 8, 2018)</h3><ul><li>Bugfix: Resolves regression with Batch steps &quot;hanging&quot; on some Windows build agents (<a href="https://issues.jenkins-ci.org/browse/JENKINS-50025">JENKINS-50025</a>) introduced by 1.19<ul><li>Fix for existing builds suffering the issue: go into the control directory in the workspace and run 'move jenkins-result.txt.tmp jenkins-result.txt' - the batch step will complete normally</li></ul></li></ul><h3 id="DurableTaskPlugin-Version1.20(Mar7,2018)">Version 1.20 (Mar 7, 2018)</h3><ul><li>Bugfix: Prevent PowerShell stdout pollution when using returnStdout (<a href="https://issues.jenkins-ci.org/browse/JENKINS-49754">JENKINS-49754</a>)</li></ul><p><br/></p><h3 id="DurableTaskPlugin-Version1.19(Mar6,2018)">Version 1.19 (Mar 6, 2018)</h3><ul><li>Bugfix: Fix bogus DurableTask failures with &quot;exit status code -1&quot; due to non-atomic write of exit status code from processes (<a href="https://issues.jenkins-ci.org/browse/JENKINS-25519">JENKINS-25519</a>)</li></ul><h3 id="DurableTaskPlugin-Version1.18(Feb16,2018)">Version 1.18 (Feb 16, 2018)</h3><ul><li><strong>Major Bug Fixes to PowerShell step:</strong><ul><li>Incorrect exit codes (<a href="https://issues.jenkins-ci.org/browse/JENKINS-46876">JENKINS-46876</a>)</li><li>Hanging (<a href="https://issues.jenkins-ci.org/browse/JENKINS-46508">JENKINS-46508</a>)</li><li>Does not output UTF-8 byte order mark (<a href="https://issues.jenkins-ci.org/browse/JENKINS-46496">JENKINS-46496</a>)</li><li>Does not show live output as of version 1.15 (<a href="https://issues.jenkins-ci.org/browse/JENKINS-48057">JENKINS-48057</a>)</li><li>Step always returns success (<a href="https://issues.jenkins-ci.org/browse/JENKINS-47797">JENKINS-47797</a>)</li></ul></li><li>Add passing of TaskListener API (<a href="https://issues.jenkins-ci.org/browse/JENKINS-48300">JENKINS-48300</a>)</li><li>Test fixes</li></ul><h3 id="DurableTaskPlugin-Version1.17(Nov21,2017)">Version 1.17 (Nov 21, 2017)</h3><ul><li>Version 1.16 accidentally declared a Java dependency of 8+, despite being otherwise compatible with Jenkins 2.7.x+ which run on Java 7. Reverted to 7+.</li><li>Internal: improved resilience of Docker-based test suites.</li></ul><h3 id="DurableTaskPlugin-Version1.16(Nov14,2017)">Version 1.16 (Nov 14, 2017)</h3><div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>This version (1.16) temporarily introduced a dependency on Java 8 which was reverted to Java 7 with version 1.17</p></div></div><ul><li>
<span class="jira-issue resolved" data-jira-key="JENKINS-47791" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-47791?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14680&amp;avatarType=issuetype"/>JENKINS-47791</a>
                            -
            <span class="summary">Eliminate ProcessLiveness</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Resolved</span>
                </span>
Using a new system for determining whether <code>sh</code> step processes are still alive, which should solve various robustness issues.</li><li><p>Fixed BOM issue with the <code>powershell</code> step, perhaps 
<span class="jira-issue resolved" data-jira-key="JENKINS-46496" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-46496?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14673&amp;avatarType=issuetype"/>JENKINS-46496</a>
                            -
            <span class="summary">Powershell step in pipeline job outputs UTF-8 BOM</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Closed</span>
                </span>
.</p><p><br/></p></li></ul><h3 id="DurableTaskPlugin-Version1.15(Oct13,2017)">Version 1.15 (Oct 13, 2017)</h3><ul><li>Apply a timeout to checking when processes are started, so that we can't hang indefinitely</li></ul><h3 id="DurableTaskPlugin-Version1.14(Jun152017)">Version 1.14 (Jun 15 2017)</h3><ul><li>JENKINS-34581 Powershell support.</li><li>JENKINS-43639 File descriptor leak.</li></ul><h3 id="DurableTaskPlugin-Version1.13(Jan182017)">Version 1.13 (Jan 18 2017)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-40734">JENKINS-40734</a> Environment variable values containing <code>$</code> were not correctly passed to subprocesses.</li><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-40225">JENKINS-40225</a> Replace backslashes when on Cygwin to allow <code>sh</code> to be used.</li></ul><div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Users setting node (or global) environment variables like <code>PATH=/something:$PATH</code> will see Pipeline <code>sh</code> failures with this update unless you also update the <a href="Pipeline-Nodes-and-Processes-Plugin.html">Pipeline Nodes and Processes Plugin</a> to 2.9 or later (<a href="https://issues.jenkins-ci.org/browse/JENKINS-41339">JENKINS-41339</a>). Anyway you are advised to use the syntax <code>PATH+ANYKEY=/something</code>, as documented in inline help.</p></div></div><h3 id="DurableTaskPlugin-Version1.12(Jul282016)">Version 1.12 (Jul 28 2016)</h3><ul><li>Infrastructure for <a href="https://issues.jenkins-ci.org/browse/JENKINS-26133">JENKINS-26133</a>.</li></ul><h3 id="DurableTaskPlugin-Version1.11(Jun292016)">Version 1.11 (Jun 29 2016)</h3><ul><li>Infrastructure for <a href="https://issues.jenkins-ci.org/browse/JENKINS-31842">JENKINS-31842</a>.</li></ul><h3 id="DurableTaskPlugin-Version1.10(May192016)">Version 1.10 (May 19 2016)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-34150">JENKINS-34150</a> <code>bat</code> hangs under some conditions.</li></ul><h3 id="DurableTaskPlugin-Version1.9(Mar242016)">Version 1.9 (Mar 24 2016)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-32701">JENKINS-32701</a> Handle percent signs in the working directory for batch scripts, for example due to a Pipeline branch project based on a Git branch with a <code>/</code> in its name.</li></ul><h3 id="DurableTaskPlugin-Version1.8(Mar032016)">Version 1.8 (Mar 03 2016)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-27152">JENKINS-27152</a> Store control directory outside of the workspace.</li><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-28400">JENKINS-28400</a> Better diagnostics when wrapper shell script fails to start.</li><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-25678">JENKINS-25678</a> Refinement of fix in 1.4.</li></ul><h3 id="DurableTaskPlugin-Version1.8-beta-1(Jan192016)">Version 1.8-beta-1 (Jan 19 2016)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-32264">JENKINS-32264</a> Linux-only process liveness check broke usage on FreeBSD.</li></ul><h3 id="DurableTaskPlugin-Version1.7(Dec032015)">Version 1.7 (Dec 03 2015)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-27152">JENKINS-27152</a> Not a fix, but use a more predictable control directory name.</li><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-27419">JENKINS-27419</a> Handle batch scripts that <code>exit</code> without <code>/b</code>.</li></ul><h3 id="DurableTaskPlugin-Version1.6(Aug042015)">Version 1.6 (Aug 04 2015)</h3><ul><li>Do not kill a one-shot slave merely because a flyweight task happened to run on it (rather than on master as usual). Works around a bug in the Multibranch API plugin.</li></ul><h3 id="DurableTaskPlugin-Version1.5(May042015)">Version 1.5 (May 04 2015)</h3><ul><li>Requires Jenkins 1.565.3+.</li><li>Richer API for launching and stopping processes.</li></ul><h3 id="DurableTaskPlugin-Version1.4(Mar062015)">Version 1.4 (Mar 06 2015)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-25678">JENKINS-25678</a> Space-in-path bug affecting Windows builds.</li></ul><h3 id="DurableTaskPlugin-Version1.3(Feb022015)">Version 1.3 (Feb 02 2015)</h3><ul><li>Continuing to try to fix deadlocks.</li></ul><h3 id="DurableTaskPlugin-Version1.2(Jan132015)">Version 1.2 (Jan 13 2015)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-26380">JENKINS-26380</a> Occasional deadlocks when running against Jenkins 1.592+.</li></ul><h3 id="DurableTaskPlugin-Version1.1(Dec052014)">Version 1.1 (Dec 05 2014)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-25848">JENKINS-25848</a> Failure to run shell tasks on some Mac OS X installations.</li></ul><h3 id="DurableTaskPlugin-Version1.0(Nov252014)">Version 1.0 (Nov 25 2014)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-25727">JENKINS-25727</a> Race condition causing spurious -1 exit codes, especially for short-lived shell scripts.</li><li>Print a warning when asked to run an empty shell script.</li><li>Avoid allocating a useless thread on the slave while running a task.</li></ul><h3 id="DurableTaskPlugin-Version0.7(Oct102014)">Version 0.7 (Oct 10 2014)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-25727">JENKINS-25727</a> Better reliability of liveness checker when short-lived scripts are being run. (Amended in 1.0.)</li></ul><h3 id="DurableTaskPlugin-Version0.6(Oct082014)">Version 0.6 (Oct 08 2014)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-22249">JENKINS-22249</a> Detect if the wrapper shell script is dead, for example because the machine was rebooted.</li><li>Efficiency improvements in log copying.</li></ul><h3 id="DurableTaskPlugin-Version0.5(Sep242014)">Version 0.5 (Sep 24 2014)</h3><ul><li>New APIs <code>ContinuableExecutable</code> and <code>OnceRetentionStrategy</code>.</li><li>Moved <code>ContinuedTask</code> into a subpackage.</li></ul><h3 id="DurableTaskPlugin-Version0.4(Aug272014)">Version 0.4 (Aug 27 2014)</h3><ul><li>New API: <a href="https://trello.com/c/JKJFUWXo/33-prioritizedtask" class="external-link" rel="nofollow">https://trello.com/c/JKJFUWXo/33-prioritizedtask</a></li><li>Better error handling.</li><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-23027">JENKINS-23027</a> Print nicer output when running on newer versions of Jenkins.</li></ul><h3 id="DurableTaskPlugin-Version0.3(Jul222014)">Version 0.3 (Jul 22 2014)</h3><ul><li>Supporting <code>java.io.Serializable</code>.</li></ul><h3 id="DurableTaskPlugin-Version0.2(May292014)">Version 0.2 (May 29 2014)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-22248">JENKINS-22248</a> Allow multiple scripts to run in the same workspace concurrently.</li><li>Allow a “shell” script to override the interpreter.</li><li>Use the default configured shell.</li><li>Start the shell with <code>-xe</code> (echo commands, fail on error).</li></ul><h3 id="DurableTaskPlugin-Version0.1(Mar182014)">Version 0.1 (Mar 18 2014)</h3><ul><li>Initial release.</li></ul>
                    </div>

                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:21</p>
                    <div id="footer-logo"><a href="/display/">Wiki home</a></div>
                </section>
            </div>
        </div>     </body>
</html>
