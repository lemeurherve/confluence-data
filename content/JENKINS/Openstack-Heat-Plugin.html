<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Openstack Heat Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Openstack Heat Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (methodes_arkea)</span>, last modified on Dec 11, 2017
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View Openstack Heat <a href="https://plugins.jenkins.io/openstack-heat" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>
Openstack Heat Plugin allows to interact with OpenStack by using the Heat API in Jenkins.<h2 id="OpenstackHeatPlugin-Summary">Summary</h2><p>Openstack Heat is a Jenkins plugin that allows to interact with OpenStack by using the Heat API.<br/> When you configure a project, you can add a step build HOT player. At this time, you can choose a tenant/yaml file/env file from differents lists.<br/> When a selection is done, the plugin generates automatically the interface from the differents parameters (yaml file, env file...) and you can configure the heat interactions. You can create differents HOT player steps and exchange data between them.<br/> When the job is launched, the plugin calls OpenStack via the Heat API with the configuration and the Jenkins console shows the outputs from the interaction.</p><h2 id="OpenstackHeatPlugin-Installation">Installation</h2><p>The plugin can be install with the differents methods described in the Jenkins documentation : <a href="https://wiki.jenkins-ci.org/display/JENKINS/Plugins#Plugins-Howtoinstallplugins" class="external-link" rel="nofollow">Jenkins Plugins - How to install plugins</a></p><h2 id="OpenstackHeatPlugin-Usage">Usage</h2><h3 id="OpenstackHeatPlugin-Globalconfiguration">Global configuration</h3><hr/><h4 id="OpenstackHeatPlugin-OpenStackConfiguration">OpenStack Configuration</h4><p>This section permits to add one or more OpenStack platform(s) by the button <strong>Add a new Project(Tenant) configuration</strong>.</p><p>You need to fill the fields :</p><ul><li><em>Project(Tenant) OpenStack</em> : Project (Tenant) associated with the identification.</li><li><em>URL Identity OpenStack</em> : Url to access the identity service.</li><li><em>Identity V3</em> : If the identity uses v3, the check box permits to configure the domain.</li><li><em>Domain</em> : Domain used for the identification when the identity V3 is checked.</li><li><em>User OpenStack</em> : User to identify on the project(tenant).</li><li><em>Password OpenStack</em> : Password associated.</li><li>Region (optional) : If you want used a specific region on your openstack, it's optional<br/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="400" width="1171" src="attachments/100696705/132940679.png" data-image-src="attachments/100696705/132940679.png" data-unresolved-comment-count="0" data-linked-resource-id="132940679" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Capture d’écran 2017-07-04 à 08.48.04.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="100696705" data-linked-resource-container-version="46"></span><br/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" width="1157" src="attachments/100696705/132940681.png" data-image-src="attachments/100696705/132940681.png" data-unresolved-comment-count="0" data-linked-resource-id="132940681" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Capture d’écran 2017-07-04 à 08.49.54.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="100696705" data-linked-resource-container-version="46"></span></li></ul><p><em>Test connection</em> : This button permits to test the parameters by creating a connection.<br/> <em>Delete</em> : This button permits to delete this configuration panel.<br/> <em>Add a new Project(Tenant) configuration</em> : This button permits to add multiple projects(tenants) to deploy on different OpenStack.</p><h4 id="OpenstackHeatPlugin-OpenStackTimeConfiguration">OpenStack Time Configuration</h4><p>This section permits to configure the differents timeout associated with OpenStack Heat API.</p><ul><li><em>Polling Status OpenStack (s)</em> : This input allows to put the interval in seconds in order that the plugin checks the status of a stack in Openstack. By default, the time is 20 seconds.</li><li><em>Timeout Operation OpenStack (s)</em> : This input allows to put the interval in seconds in order that the operation via Heat falls in timeout. By default, the time is 15 minutes (900 s).</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="97" width="1024" src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/openstack_time_configuration.png" data-image-src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/openstack_time_configuration.png"></span></p><h4 id="OpenstackHeatPlugin-HeatOrchestrationTemplate(HOT)LoaderSettings">Heat Orchestration Template (HOT) Loader Settings</h4><p>This section allows to choose a loader to consume the HOT data.</p><p>A loader is divided in two distincts parts:</p><ol><li>The configuration to load the files yaml to manage stack, this is mandatory.</li><li>The configuration to load optional files env to facilitate sending parameters via the client OpenStack to manage the stacks.</li></ol><p>Currently, it exits two defaults loaders:</p><h5 id="OpenstackHeatPlugin-LoaderFromDir"><em>LoaderFromDir</em></h5><ul class="alternate"><li><em>Path to the directory Heat Template</em> : The absolute path (in the same physical machine that hosting Jenkins server) to the repository containing the yaml files.</li><li><em>Extension for the Heat Template File</em> : The extension associated with the yaml files.</li><li><em>Test Path Hot</em> : This button permits to test the yaml files configuration.</li><li><em>Use optional path to the directory Env File</em> : When you check this box, you can configure the optional files env.</li><li><em>Path to the directory Env</em> : The absolute path (in the same physical machine that hosting Jenkins server) to the repository containing the env files.</li><li><em>Extension for the Env File</em> : The extension associated with the env files.</li><li><em>Default full Env filename</em> : You can indicate a file by default. The plugin tries to find an env file with the same name of the hot file else it uses the default or nothing if this field is empty.</li><li><em>Test Path Env</em> : This button permits to test the env files configuration.</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="360" width="1024" src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/openstack_loaderfromdir_configuration.png" data-image-src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/openstack_loaderfromdir_configuration.png"></span></p><h5 id="OpenstackHeatPlugin-LoaderHttpREST"><em>LoaderHttpREST</em></h5><p>We suppose to use an Api REST. So the root url via a Get retrieve the list of the yaml file and the root url + path to a file via a Get download this specific file.</p><ul class="alternate"><li><em>Url to access to the Hot API Rest</em>: The url to access at the list of the yaml file, it is the root url. The format is an array json. You can find an example (listHots) in the package /openstack.heat/src/test/resources/com/arkea/jenkins/openstack/heat/yaml.</li><li><em>Test Url Hot</em> : This button permits to test the url Hot API Rest configuration.</li><li><em>Use optional url to Envs File</em> : When you check this box, you can configure the optional files env.</li><li><em>Url to access to the Env API Rest</em> : The url to access at the list of the yaml file, it is the root url. The format is an array json. You can find an example (listEnvs) in the package /openstack.heat/src/test/resources/com/arkea/jenkins/openstack/heat/yaml.</li><li><em>Test Url Env</em> : This button permits to test the url env files configuration.</li><li><em>Default full Env filename</em> : You can indicate a file by default. The plugin tries to find an env file with the same name of the hot file else it uses the default or nothing if this field is empty.</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="293" width="1024" src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/openstack_loaderhttprest_configuration.png" data-image-src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/openstack_loaderhttprest_configuration.png"></span></p><h3 id="OpenstackHeatPlugin-Stepconfiguration">Step configuration</h3><hr/><p>If the global configuration is done and all is correct, then in a free-style project you can see the item <strong>Heat Orchestration Template (HOT) player</strong> in the list build step.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="203" width="343" src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/step_menu_configuration.png" data-image-src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/step_menu_configuration.png"></span></p><p>If you have configured many projects, a selectbox appears to choose which project you want to use. Otherwise, if you have only one project, it's selected by default without selectbox.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="79" width="1024" src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/openstack_project_configuration.png" data-image-src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/openstack_project_configuration.png"></span></p><p>The Heat Orchestration Template (HOT) player allows to play HOT file to OpenStack.<br/> The HOT player load the HOT file choose in the selectbox and generate dynamically the inputs.<br/> If the Associate Env File is configured than the selectbox permits to choose one file env file.<br/> By default when you choose a HOT file, the selectbox Associate Env File tries to select the same env file name if it exits or the default env file if it is configured. In this case, the differents inputs are fills with the data from env file.<br/> The inputs are divided in 4 categories :</p><ol><li>Properties:<ul><li><em>Stack name</em> : Corresponding to the the name used in OpenStack.</li><li><em>Delete stack if already exists ?</em> : If you want reuse the same name for a stack, the plugin destroys the stack if already exits.</li><li><em>Debug mode ?</em> : If it's checked than the console print all the differents values parameters.</li></ul></li><li>Tags<ul><li>If you checked &quot;Add tags ?&quot;, this category permits to add tags to the stacks. Input should be a string, multiple tags can be added separated by &quot;,&quot;</li></ul></li><li>Parameters:<ul><li>This category is generated dynamically from the differents parameters present in the HOT.</li></ul></li><li>Outputs:<ul><li>This category is generated dynamically from the differents outputs present in the HOT.</li></ul></li></ol><div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Variable environment</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>You can use variable environment in each input. The variable must be start with &quot;$&quot; without &quot;-&quot;.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="571" width="1024" src="attachments/100696705/132940684.png" data-image-src="attachments/100696705/132940684.png" data-unresolved-comment-count="0" data-linked-resource-id="132940684" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Capture d’écran 2017-07-04 à 09.00.47.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="100696705" data-linked-resource-container-version="46"></span></p></div></div><div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Content file</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>If you fly over the help's icon from the <em>Associate Env File</em> when an entry is selected, you can watch the content of the file.<br/> <span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="156" width="1024" src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/step_env_help.png" data-image-src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/step_env_help.png"></span></p></div></div><h3 id="OpenstackHeatPlugin-Postbuildaction">Post build action</h3><hr/><p>In the post build action list, you can see the item <strong>Delete HOT player stacks when build done</strong>.</p><div>This task permits to clean the environment by deleting all the stacks created during the different previous build step in the job<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/100696705/132940694.png" data-image-src="attachments/100696705/132940694.png" data-unresolved-comment-count="0" data-linked-resource-id="132940694" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Capture d’écran 2017-07-04 à 09.12.59.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="100696705" data-linked-resource-container-version="46"></span></div><h3 id="OpenstackHeatPlugin-Execution">Execution</h3><hr/><p>When the job is launched, you can follow the interactions between Jenkins and Openstack in the console. If you have checked the debug mode, the outputs are more verbose.<br/> If the job have a problem, the console shows the stacktrace.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="680" width="1024" src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/execution_hot.png" data-image-src="https://raw.githubusercontent.com/jenkinsci/openstack-heat-plugin/master/doc/images/execution_hot.png"></span></p><p>When you choose the post build action, the console looks like this :</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="173" width="911" src="attachments/100696705/132940699.png" data-image-src="attachments/100696705/132940699.png" data-unresolved-comment-count="0" data-linked-resource-id="132940699" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="hot_clean_info.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="100696705" data-linked-resource-container-version="46"></span></p><h2 id="OpenstackHeatPlugin-Development">Development</h2><p>You need <strong>Java 7</strong> and <strong>Maven 3</strong> (3.3.1 minimum) to develop on your computer.<br/> The first step consists to extract the source via the command <strong>git clone</strong>.<br/> If you need to clean the project, you can do that via the command <strong>mvn clean</strong> and by deleting the work directory.</p><h3 id="OpenstackHeatPlugin-Eclipse">Eclipse</h3><p>If you want import the project under Eclipse, you need to launch <strong>mvn eclipse:eclipse</strong> under a terminal in the project's directory.<br/> After, you just import the project via the menu <em>File/Import.../Existing Projects into Workspace</em> under Eclipse.</p><h3 id="OpenstackHeatPlugin-Launch">Launch</h3><p>On a terminal, you can launch a jenkins to test the plugin via the command : <strong>mvn hpi:run -Djetty.port=8080</strong>. You can choose the port.</p><p>If you want to debug the plugin, you need to add these options to <strong>MAVEN_OPTS</strong> env variable : <strong>-Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=8000,suspend=n</strong> and to create a debug configuration under Eclipse via the menu <em>Run/Debug configurations.../Remote Java Application/New</em>. Select the <em>openstack.heat</em> project.<br/> After jenkins runs, under Eclipse, launch the previous configuration. If you put a breakpoint, you can debug the code under Eclipse.</p><h3 id="OpenstackHeatPlugin-Test">Test</h3><p>The source have some tests. If you want to pass them, it's via the command : <strong>mvn test</strong>.<br/> If you want to launch a specific test, execute the command : <strong>mvn -Dtest=ClassNameTest test</strong> where <em>ClassNameTest</em> equals the single class test.</p><p>If you want to debug the test, you need to create a debug configuration under Eclipse via the menu <em>Run/Debug configurations.../Remote Java Application/New</em>. Select the <em>openstack.heat</em> project and change the port to 5005.<br/> You need to launch the application via the command : <strong>mvn -Dmaven.surefire.debug test</strong>.<br/> During the launching, the starter wait a connection to the debug port, so under Eclipse, launch the previous configuration. If you put a breakpoint, you can debug the code under Eclipse.</p><p>It is possible to combine the twice, for example : <strong>mvn -Dtest=ClassNameTest -Dmaven.surefire.debug test</strong></p><h2 id="OpenstackHeatPlugin-License">License</h2><div class="confluence-information-macro confluence-information-macro-information"><p class="title">License</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><br class="atl-forced-newline"/> Copyright 2015 Credit Mutuel Arkea</p><p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);<br/> you may not use this file except in compliance with the License.<br/> You may obtain a copy of the License at</p><p><a href="http://www.apache.org/licenses/LICENSE-2.0" class="external-link" rel="nofollow">http://www.apache.org/licenses/LICENSE-2.0</a></p><p>Unless required by applicable law or agreed to in writing, software distributed under<br/> the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,<br/> either express or implied.<br/> See the License for the specific language governing permissions and limitations under the License.</p></div></div><h2 id="OpenstackHeatPlugin-Feedbackwanted">Feedback wanted</h2><p>Let me know via the maintainer email at the top of the page!</p><h2 id="OpenstackHeatPlugin-Versionhistory">Version history</h2><h3 id="OpenstackHeatPlugin-Version1.5(November16,2017)">Version 1.5 (November 16, 2017)</h3><ul><li>Roll back to dependency OpenStack4j 3.0.4</li></ul><h3 id="OpenstackHeatPlugin-Version1.4(November14,2017)">Version 1.4 (November 14, 2017)</h3><ul><li>Bugs fixed : Integer ,default list, size constraints</li><li>Update dependency OpenStack4j to 3.1.0</li><li>Add configuration for <code><a href="https://github.com/CreditMutuelArkea/Openstack-Jenkins-HeatPlugin-closed-see-readme-/commit/3fa14b72fa0f7eaba9454c8c408656721e3662a9" class="external-link" rel="nofollow">http://ci.jenkins.io</a></code></li></ul><h3 id="OpenstackHeatPlugin-Version1.3(June28,2017)">Version 1.3 (June 28, 2017)</h3><ul><li>Add optional Region to the project configuration</li><li>Add optional support tag on stack</li><li>Add optional post build task to clean (delete) all the stacks created</li><li>Bugs fixed : missing env file, multi project</li><li>Update test, documentation</li></ul><h3 id="OpenstackHeatPlugin-Version1.2(April5,2017)">Version 1.2 (April 5, 2017)</h3><ul><li>Update dependency and constructor OpenStack to avoid java.lang.NoSuchMethodError: org.openstack4j.api.heat.StackService.delete</li><li>Update test, documentation</li></ul><h3 id="OpenstackHeatPlugin-Version1.1(November9,2016)">Version 1.1 (November 9, 2016)</h3><ul><li>Upgrade constraints (Implementation + test)</li><li>Add I18n and constants</li><li>Loader HttpRest Ihm simplified</li></ul><h3 id="OpenstackHeatPlugin-Version1.0(September15,2016)">Version 1.0 (September 15, 2016)</h3><ul><li>Initial release</li></ul>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/100696705/132940679.png">Capture d’écran 2017-07-04 à 08.48.04.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/100696705/132940681.png">Capture d’écran 2017-07-04 à 08.49.54.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/100696705/132940684.png">Capture d’écran 2017-07-04 à 09.00.47.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/100696705/132940694.png">Capture d’écran 2017-07-04 à 09.12.59.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/100696705/132940699.png">hot_clean_info.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:36</p>
                    <div id="footer-logo"><a href="/display/">Wiki home</a></div>
                </section>
            </div>
        </div>     </body>
</html>
