<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Worksoft Execution Manager Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Worksoft Execution Manager Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (dtheobald)</span>, last modified on Aug 16, 2019
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View Worksoft Execution Manager <a href="https://plugins.jenkins.io/ws-execution-manager" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>
<br/></p><h1 id="WorksoftExecutionManagerPlugin-Description">Description</h1><p>This is the official Worksoft Supported Plugin.  The plugin adds build steps for interacting with a Worksoft's Execution Manager to run your Certify processes or ALM labs.</p><h1 id="WorksoftExecutionManagerPlugin-Installation">Installation</h1><p><strong>Note</strong>: This plugin requires Worksoft's Execution Manager version 10.0.20 or later.  If you use an earlier version of Execution Manager you will see a runtime error 405 Method Not Allowed.</p><h5 id="WorksoftExecutionManagerPlugin-UpdateCenter">Update Center</h5><ol><li>Open Jenkins in a browser (e.g. http://&lt;<em>jenkins-host</em>&gt;:8080)</li><li>Navigate to <strong>Manage Jenkins → Manage Plugins</strong> view</li><li>Under the <strong>Available</strong> tab find the <em>Worksoft Execution Manager</em> plugin and check the box adjacent to the plugin and click <strong>Install without restart</strong>:</li></ol><p><br/></p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/165579425/165580857.png" data-image-src="attachments/165579425/165580857.png" data-unresolved-comment-count="0" data-linked-resource-id="165580857" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2018-12-12_9-6-57.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><h5 id="WorksoftExecutionManagerPlugin-Manual">Manual</h5><ol><li>Download <strong>ws-execution-manager.hpi</strong> from <a href="https://plugins.jenkins.io/ws-execution-manager" class="external-link" rel="nofollow">https://plugins.jenkins.io/ws-execution-manager</a></li><li>Open Jenkins in a browser (e.g. http://&lt;<em>jenkins-host</em>&gt;:8080)</li><li>Navigate to <strong>Manage Jenkins</strong> → <strong>Manage Plugins</strong> and select the <strong>Advanced</strong> tab.</li><li>Click the <strong>Choose File </strong>button in the <strong>Upload Plugin</strong> section.</li><li>Find the location of the <strong>ws-execution-manager.hpi</strong> file and click the <strong>Open</strong> button and <strong>Upload</strong> the file.</li><li>Restart Jenkins, if necessary.</li></ol><h1 id="WorksoftExecutionManagerPlugin-Usage">Usage</h1><h2 id="WorksoftExecutionManagerPlugin-ConfigureGlobalWorksoftExecutionManagerSettings">Configure Global Worksoft Execution Manager Settings</h2><p>The plugin provides a means to configure an Execution Manager's URL and credentials used by all Execution Manager build steps (unless overridden). To configure this, navigate to <em>Jenkins global configuration settings and paths</em> (Jenkins → Manage Jenkins → Configure System) and locate the <strong>Global Worksoft Execution Manager Settings</strong> section:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="224" src="attachments/165579425/165579875.jpg" data-image-src="attachments/165579425/165579875.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579875" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="GlobCfg.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Configure the URL of the Execution Manager (typically http://&lt;em-host&gt;/executionmanager):</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="224" src="attachments/165579425/165579876.jpg" data-image-src="attachments/165579425/165579876.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579876" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="GlobCfg1.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>And credentials:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="224" src="attachments/165579425/165579877.jpg" data-image-src="attachments/165579425/165579877.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579877" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="GlobCfg2.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Save these configuration settings after which they can be used by Execution Manager build steps (Freestyle and Pipeline).</p><h2 id="WorksoftExecutionManagerPlugin-FreestyleProject">Freestyle Project</h2><p>Create a Freestyle project and add the <strong>Run Execution Manager Request</strong> build step: </p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579880.jpg" data-image-src="attachments/165579425/165579880.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579880" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepSelect1.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Select the type of request to execute:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579882.jpg" data-image-src="attachments/165579425/165579882.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579882" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg1.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><h3 id="WorksoftExecutionManagerPlugin-ExecutionManagerRequest">Execution Manager Request</h3><p>Select <strong>EM Request</strong> to run a predefined request configured on the Execution Manager. The <strong>Name</strong> list box will be populated with all available requests of which one must be selected.</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="212" src="attachments/165579425/165579883.jpg" data-image-src="attachments/165579425/165579883.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579883" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg2.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><h3 id="WorksoftExecutionManagerPlugin-ExecutionManagerBookmark">Execution Manager Bookmark</h3><p>Select <strong>EM Bookmark</strong> to run a predefined bookmark configured on the Execution Manager via the Management Studio. The <strong>Name</strong> list box will be populated with all available bookmarks of which one must be selected.</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/165579425/165579886.jpg" data-image-src="attachments/165579425/165579886.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579886" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg4.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Optionally, a result folder can be specified by filling in the <strong>Results folder</strong> text box:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/165579425/165579887.jpg" data-image-src="attachments/165579425/165579887.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579887" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg5.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><h3 id="WorksoftExecutionManagerPlugin-CertifyProcesses">Certify Processes</h3><p>Select <strong>Certify Processes</strong> to execute a list of Certify processes without creating a request or bookmark first.</p><h2 style="margin-left: 30.0px;" id="WorksoftExecutionManagerPlugin-"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579890.jpg" data-image-src="attachments/165579425/165579890.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579890" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg6.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></h2><p>Provide an database alias name of the Certify connection saved in Management Studio -&gt; Configuration -&gt; Certify Configuration:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579892.jpg" data-image-src="attachments/165579425/165579892.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579892" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg7.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Specify the Certify project where processes reside:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579893.jpg" data-image-src="attachments/165579425/165579893.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579893" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg8.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Optionally, specify a folder where Certify Results will be saved. If not specified, results go to the root results folder:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579894.jpg" data-image-src="attachments/165579425/165579894.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579894" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg9.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Specify a name to be given to the request execution:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579895.jpg" data-image-src="attachments/165579425/165579895.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579895" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg10.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Provide a fully qualified path to each process to execute:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579896.jpg" data-image-src="attachments/165579425/165579896.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579896" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg11.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Add additional processes by clicking the Add Certify Process button:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/165579425/165579897.jpg" data-image-src="attachments/165579425/165579897.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579897" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="BuildStepCfg12.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><h3 id="WorksoftExecutionManagerPlugin-ConfigureAlternativeExecutionManager">Configure Alternative Execution Manager</h3><p>An Execution Manager build step can override the globally Execution Manager configuration (see above) by configuring an alternative:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="77" src="attachments/165579425/165579905.jpg" data-image-src="attachments/165579425/165579905.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579905" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="AltCfg.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Configure the URL of the Execution Manager (typically http://&lt;em-host&gt;/executionmanager):</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="204" src="attachments/165579425/165579906.jpg" data-image-src="attachments/165579425/165579906.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579906" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="AltCfg2.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>And credentials:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="204" src="attachments/165579425/165579907.jpg" data-image-src="attachments/165579425/165579907.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579907" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="AltCfg3.jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><h3 id="WorksoftExecutionManagerPlugin-AdditionalOptions">Additional Options</h3><p>Each request type (request, bookmark and processes) can be configured to be executed with additional Certify parameters and wait configuration:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="131" src="attachments/165579425/165579908.jpg" data-image-src="attachments/165579425/165579908.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579908" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Opts..jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><h4 id="WorksoftExecutionManagerPlugin-CertifyParameters">Certify Parameters</h4><p>Optionally, Certify parameters can be specified. Both a key and value must be specified. The value can refer to Jenkins environment variables using this syntax - <strong>${</strong><em>JENKINS_ENV_VAR</em><strong>}</strong>. For example - <strong>${BUILD_ID}</strong>:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/165579425/165579909.jpg" data-image-src="attachments/165579425/165579909.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579909" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Opts1..jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><p>Optionally, execution wait configuration can be specified. Both the polling interval and maximum run time must be specified in seconds:</p><p style="margin-left: 30.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="168" src="attachments/165579425/165579910.jpg" data-image-src="attachments/165579425/165579910.jpg" data-unresolved-comment-count="0" data-linked-resource-id="165579910" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Opts2..jpg" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="165579425" data-linked-resource-container-version="26"></span></p><pre><br/></pre><h2 id="WorksoftExecutionManagerPlugin-Output">Output</h2><p>Plugin version 10.0.1 and later outputs the Worksoft Execution Manager result set in JSON format to a file named - <strong>execMan-result.json</strong> - in the associated Jenkins job's workspace directory. For example:</p><pre><code>    {
        &quot;Status&quot;: &quot;Completed&quot;,
        &quot;Description&quot;: &quot;FAILED&quot;,
        &quot;ExecutionStatus&quot;: &quot;FAILED&quot;,
        &quot;Tasks&quot;: [
            {
                &quot;Name&quot;: &quot;test login&quot;,
                &quot;ExecutionStatus&quot;: &quot;Failed&quot;,
                &quot;ResourceName&quot;: &quot;CKAgentBox1&quot;,
                &quot;LastReportedError&quot;: &quot;&quot;,
                &quot;Status&quot;: &quot;Completed&quot;,
                &quot;CertifyDatabaseAliasName&quot;: &quot;CK_Certify&quot;,
                &quot;CertifyResultID&quot;: 20075
            }
        ]
    }<br/></code></pre><p style="margin-left: 30.0px;"><strong>Note: </strong>See Certify Execution Manager's API specification for a complete description of the result set.</p><p>This file can be read/processed in either a freestyle or pipeline job. For example, in a freestyle job, to retrieve from Certify the failed test steps, add a Groovy build step with Groovy code like:</p><pre><code>    // Requires Groovy plugin - http://wiki.jenkins-ci.org/display/JENKINS/Groovy+plugin
    import groovy.json.JsonSlurper
    import groovy.json.JsonOutput
    import hudson.*
    import hudson.model.*
    import java.lang.*
      
    def build = Thread.currentThread().executable
    def resolver = build.buildVariableResolver
    def workspace = build.getModuleRoot().absolutize().toString()
    
    // Retrieve job paramaters
    def API_TOKEN = resolver.resolve(&quot;API_TOKEN&quot;)
    def API_URL = resolver.resolve(&quot;API_URL&quot;)
    <br/>    def execManResult = new FilePath(build.getModuleRoot().getChannel(), workspace + &quot;/execMan-result.json&quot;)<br/>    if (execManResult.exists()) {
        def result = new JsonSlurper().parse(execManResult.read())<br/>        println &quot;result=&quot; + JsonOutput.prettyPrint(JsonOutput.toJson(result))
    
        // Loop through all tasks looking for failed tasks and their result ID
        for(int i=0; i &lt; result['Tasks'].size(); i++) {
            def logHeaderID = result['Tasks'][i]['CertifyResultID']
            def executionStatus = result['Tasks'][i]['ExecutionStatus']
            if (logHeaderID != null &amp;&amp; executionStatus.toUpperCase().equals(&quot;FAILED&quot;)) {
                // Retrieve failed test steps from Certify and display them
                def url = API_URL + &quot;?logHeaderID=&quot; + logHeaderID
                def api = url.toURL().openConnection()
                api.addRequestProperty(&quot;Accept&quot;, &quot;application/json&quot;)
                api.addRequestProperty(&quot;token&quot;, API_TOKEN)
                api.setRequestMethod(&quot;GET&quot;)
                api.connect()
    
               println &quot;Tasks[&quot; + i +&quot;] logHeaderID=&quot; + logHeaderID + &quot;:&quot; +  JsonOutput.prettyPrint(api.content.text)
            }
        } 
    }</code></pre><p>Similarly, a pipeline job could process the output file as follows:</p><pre><code>    // Requires the following In-Process script approvals:
    //    method java.net.HttpURLConnection setRequestMethod java.lang.String
    //    method java.net.URL openConnection
    //    method java.net.URLConnection addRequestProperty java.lang.String java.lang.String
    //    method java.net.URLConnection connect
    //    method java.net.URLConnection getContent
    //    staticMethod org.codehaus.groovy.runtime.DefaultGroovyMethods getText java.io.InputStream
    //    staticMethod org.codehaus.groovy.runtime.DefaultGroovyMethods hasProperty java.lang.Object java.lang.String
    //    staticMethod org.codehaus.groovy.runtime.DefaultGroovyMethods toURL java.lang.String
    
    import groovy.json.JsonOutput
    
    pipeline {
        agent {
            node {
                label &quot;master&quot;
            }
        }
        stages {
            stage('build') {
                steps {
                    // Execute an Execution Manager request
                    execMan request: [name: '&lt;an-execution-manager-request-name&gt;'], requestType: 'request'
                    script {
                        if (fileExists('execMan-result.json')) {
                            def result = readJSON file: 'execMan-result.json'
                            echo &quot;result=&quot; + JsonOutput.prettyPrint(JsonOutput.toJson(result))
    
                            for(int i=0; i &lt; result['Tasks'].size(); i++) {
                                def logHeaderID = result['Tasks'][i]['CertifyResultID']
                                def executionStatus = result['Tasks'][i]['ExecutionStatus']
                                if (logHeaderID != null &amp;&amp; executionStatus.toUpperCase().equals(&quot;FAILED&quot;)) {
                                    // Retrieve failed test steps from Certify and display them
                                    def url = API_URL + &quot;?logHeaderID=&quot; + logHeaderID
                                    def api = url.toURL().openConnection()
                                    api.addRequestProperty(&quot;Accept&quot;, &quot;application/json&quot;)
                                    api.addRequestProperty(&quot;token&quot;, API_TOKEN)
                                    api.setRequestMethod(&quot;GET&quot;)
                                    api.connect()
    
                                    echo &quot;Tasks[&quot; + i +&quot;] logHeaderID=&quot; + logHeaderID + &quot;:&quot; + JsonOutput.prettyPrint(api.content.text)
                                }
                            }
                        }
                    }
                }
            }
        }
    }</code></pre><h2 id="WorksoftExecutionManagerPlugin-Pipeline">Pipeline</h2><h3 id="WorksoftExecutionManagerPlugin-DSLReference-execMan:RunExecutionManagerRequest">DSL Reference - <strong><em>execMan: Run Execution Manager Request</em></strong></h3><p><strong>requestType</strong></p><p><strong>Type: </strong>String</p><p><br/></p><p><strong>altEMConfig</strong> (optional)</p><p style="margin-left: 30.0px;">| Optional alternative Execution Manager configuration. If provided, these parameters override those specified in Jenkins global configuration.</p><p style="margin-left: 30.0px;">Nested object:</p><p style="margin-left: 60.0px;"><strong>url</strong></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p style="margin-left: 60.0px;"><strong>credentials</strong></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p><strong><br/></strong></p><p><strong>bookmark </strong>(optional)</p><p style="margin-left: 30.0px;"><span style="color: rgb(51,51,51);letter-spacing: 0.0px;">| Select this to run a predefined bookmark configured on the Execution Manager via the Management Studio.</span></p><p style="margin-left: 30.0px;">Nested object:</p><p style="margin-left: 60.0px;"><strong>name</strong></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p style="margin-left: 60.0px;"><strong>folder </strong>(optional)</p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p><strong><br/></strong></p><p><strong>execParms </strong>(optional)</p><p style="margin-left: 30.0px;"><span style="color: rgb(51,51,51);letter-spacing: 0.0px;">| Optional execution request parameters. Both a key and value must be specified. The value can refer to Jenkins environment variables using this syntax - </span><strong style="color: rgb(51,51,51);letter-spacing: 0.0px;">${</strong><em style="color: rgb(51,51,51);letter-spacing: 0.0px;">JENKINS_ENV_VAR</em><strong style="color: rgb(51,51,51);letter-spacing: 0.0px;">}</strong><span style="color: rgb(51,51,51);letter-spacing: 0.0px;">. For example - </span><strong style="color: rgb(51,51,51);letter-spacing: 0.0px;">${BUILD_ID}</strong><span style="color: rgb(51,51,51);letter-spacing: 0.0px;">.</span></p><p style="margin-left: 30.0px;"><strong>list</strong> (optional)</p><p style="margin-left: 30.0px;"><strong>Type</strong>: <em>ArrayList</em> of emParam</p><p style="margin-left: 60.0px;"><strong>key</strong></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p style="margin-left: 60.0px;"><strong>value</strong></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p><strong><br/></strong></p><p><strong>processList </strong>(optional)</p><p style="margin-left: 30.0px;"><span style="color: rgb(51,51,51);letter-spacing: 0.0px;">| Select this to execute a list of Certify processes without creating a request or bookmark first.</span></p><p style="margin-left: 30.0px;">Nested object:</p><p style="margin-left: 60.0px;"><strong>database</strong></p><p style="margin-left: 60.0px;">| Alias name of the Certify connection saved in Management Studio -&gt; Configuration -&gt; Certify Configuration.</p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p style="margin-left: 60.0px;"><br/></p><p style="margin-left: 60.0px;"><strong>project</strong></p><p style="margin-left: 60.0px;">| <span style="color: rgb(51,51,51);">Certify project where processes reside.</span></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p style="margin-left: 60.0px;"><br/></p><p style="margin-left: 60.0px;"><strong>processes</strong></p><p style="margin-left: 60.0px;">| <span style="color: rgb(51,51,51);">List of the fully qualified path to each process.</span></p><p style="margin-left: 60.0px;"><em><strong>Type</strong>: ArrayList</em> of certifyProcess</p><p style="margin-left: 90.0px;"><strong>processPath</strong></p><p style="margin-left: 90.0px;"><strong>Type</strong>: String</p><p style="margin-left: 60.0px;"><br/></p><p style="margin-left: 60.0px;"><strong>folder</strong></p><p style="margin-left: 60.0px;">| <span style="color: rgb(51,51,51);">Folder where Certify Results will be saved. If not specified, results go to the root results folder.</span></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p style="margin-left: 60.0px;"><br/></p><p style="margin-left: 60.0px;"><strong>requestName</strong></p><p style="margin-left: 60.0px;">| <span style="color: rgb(51,51,51);">Name given to the request execution.</span></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p><strong><br/></strong></p><p><strong>request </strong>(optional)</p><p style="margin-left: 30.0px;"><span style="color: rgb(51,51,51);letter-spacing: 0.0px;">| Select this to run a predefined request configured on the Execution Manager.</span></p><p style="margin-left: 30.0px;"><strong>name</strong></p><p style="margin-left: 30.0px;"><strong>Type</strong>: String</p><p><br/></p><p><strong>waitConfig </strong>(optional)</p><p style="margin-left: 30.0px;"><span style="color: rgb(51,51,51);letter-spacing: 0.0px;">| Optional execution request wait configuration. Both the polling interval and maximum run time must be specified in seconds</span></p><p style="margin-left: 30.0px;">Nested object:</p><p style="margin-left: 60.0px;"><strong>pollInterval</strong></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><p style="margin-left: 60.0px;"><strong>maxRunTime</strong></p><p style="margin-left: 60.0px;"><strong>Type</strong>: String</p><h3 id="WorksoftExecutionManagerPlugin-Examplepipelinesnippets">Example pipeline snippets</h3><p>Simple Request execution:</p><p style="margin-left: 30.0px;">execMan request: [name: '<span style="color: rgb(255,0,0);"><em>name-of-request</em></span>'], requestType: 'request'</p><p>Simple Bookmark execution:</p><p style="margin-left: 30.0px;">execMan bookmark: [folder: '<span style="color: rgb(255,0,0);"><em>result-folder-name</em></span>', name: '<span style="color: rgb(255,0,0);"><em>name-of-bookmark</em></span>'], requestType: 'bookmark'</p><p>Simple Process List execution:</p><p style="margin-left: 30.0px;">execMan processList: [database: '<em><span style="color: rgb(255,0,0);">database-alias</span></em>', folder: '<em><span style="color: rgb(255,0,0);">result-folder-name</span></em>', processes: [[processPath: '<span style="color: rgb(255,0,0);"><em>Project1\\Folder1\\Folder2\\Process1</em></span>'], [processPath: '<em><span style="color: rgb(255,0,0);">testproject\\testfolder\\testprocess</span></em>']], project: '<span style="color: rgb(255,0,0);"><em>certify-project-name</em></span>', requestName: '<span style="color: rgb(255,0,0);"><em>request-name</em></span>'], requestType: 'processList'</p><p>Bookmark request with wait config specified:</p><p style="margin-left: 30.0px;">execMan bookmark: [folder: '<span style="color: rgb(255,0,0);"><em>result-folder-name</em></span>', name: '<em><span style="color: rgb(255,0,0);">name-of-bookmark</span></em>'], requestType: 'bookmark', waitConfig: [maxRunTime: '<em><span style="color: rgb(255,0,0);">600</span></em>', pollInterval: '<em><span style="color: rgb(255,0,0);">10</span></em>']</p><p>Request with Parameters:</p><p style="margin-left: 30.0px;">execMan request: [name: '<em><span style="color: rgb(255,0,0);">name-of-request</span></em>'], requestType: 'request', execParams: [list: [[key: '<em><span style="color: rgb(255,0,0);">key1-name</span></em>', value: '<em><span style="color: rgb(255,0,0);">value1</span></em>'], [key: '<em><span style="color: rgb(255,0,0);">key2-name</span></em>', value: '<em><span style="color: rgb(255,0,0);">value2</span></em>']]]</p><h1 id="WorksoftExecutionManagerPlugin-Changelog">Changelog</h1><h3 id="WorksoftExecutionManagerPlugin-Version10.0.0.7(Dec112018)">Version 10.0.0.7 (Dec 11 2018)</h3><ul><li>Initial version</li></ul><h3 id="WorksoftExecutionManagerPlugin-Version10.0.1.19(April242019)">Version 10.0.1.19 (April 24 2019)</h3><ul><li>Output Certify Execution Manager result set to <em>&lt;<span style="color: rgb(255,0,0);">workspace-path</span></em><em>&gt;</em><strong><em>/execMan-result.json</em></strong></li></ul><h3 id="WorksoftExecutionManagerPlugin-Version10.0.2.27(August162019)">Version 10.0.2.27 (August 16 2019)</h3><ul><li>Fix problem writing to <em>&lt;<span style="color: rgb(255,0,0);">workspace-path</span></em><em>&gt;</em><strong><em>/execMan-result.json </em></strong>on slave nodes</li></ul><p><br/></p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579507.png">image2018-11-21_5-33-17.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579509.png">image2018-11-21_5-34-54.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579511.png">image2018-11-21_5-36-28.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579513.png">image2018-11-21_5-37-42.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579875.jpg">GlobCfg.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579876.jpg">GlobCfg1.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579877.jpg">GlobCfg2.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579881.jpg">BuildStepSelect1.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579880.jpg">BuildStepSelect1.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579882.jpg">BuildStepCfg1.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579884.jpg">BuildStepCfg2.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579883.jpg">BuildStepCfg2.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579885.jpg">BuildStepCfg3.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579886.jpg">BuildStepCfg4.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579887.jpg">BuildStepCfg5.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579891.jpg">BuildStepCfg6.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579890.jpg">BuildStepCfg6.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579892.jpg">BuildStepCfg7.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579893.jpg">BuildStepCfg8.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579894.jpg">BuildStepCfg9.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579895.jpg">BuildStepCfg10.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579896.jpg">BuildStepCfg11.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579897.jpg">BuildStepCfg12.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579905.jpg">AltCfg.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579906.jpg">AltCfg2.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579907.jpg">AltCfg3.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579908.jpg">Opts..jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579909.jpg">Opts1..jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165579910.jpg">Opts2..jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165580855.png">image2018-12-12_9-3-18.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165580856.png">image2018-12-12_9-4-7.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/165579425/165580857.png">image2018-12-12_9-6-57.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:58</p>
                    <div id="footer-logo"><a href="/display/">Wiki home</a></div>
                </section>
            </div>
        </div>     </body>
</html>
