<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Ansible Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Ansible Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (sirot)</span>, last modified by <span class='editor'> Unknown User (danielbeck)</span> on Mar 26, 2018
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View Ansible <a href="https://plugins.jenkins.io/ansible" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>

<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Older versions of this plugin may not be safe to use. Please review the following warnings before using an older version:</p>

<ul>
	<li><a href="https://jenkins.io/security/advisory/2018-03-26/#SECURITY-630" class="external-link" rel="nofollow">Host key verification disabled by default</a></li>
	<li><a href="https://www.jenkins.io/security/advisory/2020-11-04/#SECURITY-1943" class="external-link" rel="nofollow">Missing permission checks allow enumerating credentials IDs</a></li>
</ul>

</div></div>
 </p><p> This plugin allows to execute <a href="http://www.ansible.com/" class="external-link" rel="nofollow">Ansible</a> tasks as a job build step.</p><h2 id="AnsiblePlugin-TableofContents">Table of Contents</h2><p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1631020295774 {padding: 0px;}
div.rbtoc1631020295774 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1631020295774 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1631020295774'>
<ul class='toc-indentation'>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-GlobalConfiguration'>Global Configuration</a>
<ul class='toc-indentation'>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-GlobalToolConfiguration'>Global Tool Configuration</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-OSUserPATH'>OS User PATH</a></li>
</ul>
</li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Adhoc'>Adhoc</a>
<ul class='toc-indentation'>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Examples'>Examples</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Arguments'>Arguments</a></li>
</ul>
</li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Playbook'>Playbook</a>
<ul class='toc-indentation'>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Examples.1'>Examples</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Arguments.1'>Arguments</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Authentication'>Authentication</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-VaultCredentials'>Vault Credentials</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-ColorizedOutput'>Colorized Output</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-ExtraParameters'>Extra Parameters</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Inventory'>Inventory</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-UsingJenkinsEnvironmentVariables'>Using Jenkins Environment Variables</a></li>
</ul>
</li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Vault'>Vault</a>
<ul class='toc-indentation'>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Examples.2'>Examples</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Arguments.2'>Arguments</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-VaultCredentials.1'>Vault Credentials</a></li>
</ul>
</li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-OpenIssues'>Open Issues</a></li>
<li><a href='https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin#AnsiblePlugin-Changelog'>Changelog</a></li>
</ul>
</div></p><h2 id="AnsiblePlugin-GlobalConfiguration"><strong>Global Configuration</strong></h2><p style="margin-left: 30.0px;">Ansible needs to be on the PATH for the build job in order to be used. This can be done through either Jenkins Global Tool Configuration or including Ansible on the OS User PATH variable.</p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-GlobalToolConfiguration">Global Tool Configuration</h3><p style="margin-left: 60.0px;">Configuring Ansible through the Global Tool Configuration in Jenkins (Jenkins → Manage Jenkins → Global Tool Configuration) allows for multiple Ansible installations to be present and used by different Jenkins jobs.</p><ol><li style="margin-left: 30.0px;">Click Add Ansible</li><li style="margin-left: 30.0px;"><p>Configure the name and path<br/><br/></p><div class="table-wrap"><table class="wrapped confluenceTable" style="margin-left: 30.0px;"><colgroup><col/><col/></colgroup><tbody style="margin-left: 30.0px;"><tr style="margin-left: 30.0px;"><th class="confluenceTh"><p style="margin-left: 30.0px;">Field name</p></th><th class="confluenceTh"><p style="margin-left: 30.0px;">Description</p></th></tr><tr style="margin-left: 30.0px;"><td class="confluenceTd"><p style="margin-left: 30.0px;">Name</p></td><td class="confluenceTd"><p style="margin-left: 30.0px;">Symbolic name used to identify a specific Ansible installation when multiple installations are configured</p></td></tr><tr style="margin-left: 30.0px;"><td class="confluenceTd"><p style="margin-left: 30.0px;">Path to ansible executables directory</p></td><td class="confluenceTd"><p style="margin-left: 30.0px;">Directory containing the <em>ansible,</em> <em>ansible-playbook</em>, and<em> ansible-vault</em> binaries</p></td></tr></tbody></table></div></li><li style="margin-left: 30.0px;">Repeat for any additional desired installations</li></ol><p style="margin-left: 90.0px;"> </p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-OSUserPATH">OS User PATH</h3><p style="margin-left: 60.0px;">Ansible can also be added to the PATH user used by the Jenkins executor instead of configured through Global Tool Configuration. This is done through normal OS tools outside of Jenkins and is not covered by this guide.</p><p> </p><hr/><h2 id="AnsiblePlugin-Adhoc"><strong><span style="color: rgb(210,73,57);">Adhoc</span></strong></h2><p><span style="color: rgb(51,51,51);"><a href="http://docs.ansible.com/ansible/latest/intro_adhoc.html" class="external-link" rel="nofollow">Adhoc commands</a> allow for simple operations to be done without writing a full playbook. This allows for a convenient way of doing quick tasks with Ansible.</span></p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-Examples">Examples</h3><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Scripted">Scripted</h4><p style="margin-left: 90.0px;">Due to <a href="https://issues.jenkins-ci.org/browse/JENKINS-43782" class="external-link" rel="nofollow">JENKINS-43782</a> and <a href="https://issues.jenkins-ci.org/browse/JENKINS-49056" class="external-link" rel="nofollow">JENKINS-49056</a>, adhoc commands cannot be run with a pipeline job.</p><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Declarative">Declarative</h4><p> </p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-Arguments">Arguments</h3><p style="margin-left: 60.0px;">See also <a href="https://jenkins.io/doc/pipeline/steps/ansible/" class="external-link" rel="nofollow">jenkins.io</a> documentation.</p><div class="table-wrap"><table class="wrapped confluenceTable" style="margin-left: 30.0px;"><colgroup><col/><col/><col/></colgroup><tbody style="margin-left: 30.0px;"><tr style="margin-left: 30.0px;"><th class="confluenceTh">Freestyle Name</th><th class="confluenceTh">Pipeline Name</th><th colspan="1" class="confluenceTh">Description</th></tr><tr style="margin-left: 60.0px;"><td class="confluenceTd">Ansible installation</td><td class="confluenceTd"> </td><td colspan="1" class="confluenceTd">Ansible installation to use for the playbook invocation</td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd">Host pattern</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">The host pattern to manage. See <a href="http://docs.ansible.com/ansible/latest/intro_patterns.html" class="external-link" rel="nofollow">Ansible Patterns</a> for details.</td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd"><span>Module</span></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">CLI arg: -m</td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd"><span>Module arguments or command to execute</span></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><span>CLI arg: -a</span></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Inventory file or host list</td><td class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><p>See the <a href="#AnsiblePlugin-Inventory">Inventory</a> section for additional details.</p><p>CLI arg: -i</p></td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd">Inventory Inline content</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><p>See the <a href="#AnsiblePlugin-Inventory">Inventory</a> section for additional details.</p><p>CLI arg: -i</p></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Credentials</td><td class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><p>The Jenkins credential to use for the SSH connection. See the <a href="#AnsiblePlugin-Authentication">Authentication</a> section for additional details.</p></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Vault Credentials</td><td class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><p>The Jenkins credential to use as the vault credential. See the <a href="#AnsiblePlugin-VaultCredentials">Vault Credentials</a> section for additional details.</p><p>CLI arg: --vault-password-file</p></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">sudo</td><td class="confluenceTd"> </td><td colspan="1" class="confluenceTd">CLI arg: -s</td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd">sudo user</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">CLI arg: -U</td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Number of parallel processes</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">CLI arg: -f</td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Check host SSH key</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><p>Toggle checking of the host key.</p><p>Sets the environment variable ANSIBLE_HOST_KEY_CHECKING, similar to the recommendations for running with <a href="http://docs.ansible.com/ansible/latest/guide_vagrant.html" class="external-link" rel="nofollow">Vagrant</a>.</p></td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd"><span>Unbuffered stdout</span></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><p>Toggle buffering of standard out.</p><p>Sets the environment variable PYTHONUNBUFFERED, similar to the recommendations for running with <a href="http://docs.ansible.com/ansible/latest/guide_vagrant.html" class="external-link" rel="nofollow">Vagrant</a>.</p></td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Colorized stdout</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><p>Toggle color codes in console text. See <a href="#AnsiblePlugin-ColorizedOutput">Colorized Output</a> section for example usage.</p><p>Sets the environment variable ANSIBLE_FORCE_COLOR, similar to the recommendations for running with <a href="http://docs.ansible.com/ansible/latest/guide_vagrant.html" class="external-link" rel="nofollow">Vagrant</a>.</p></td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Extra Variables</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">CLI arg: -e</td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Additional parameters</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">String passed to the Ansible Command Line invocation as-is</td></tr></tbody></table></div><p><strong style="color: rgb(210,73,57);font-size: 20.0px;"><span> </span></strong></p><hr/><h2 id="AnsiblePlugin-Playbook"><strong><span>Playbook</span></strong></h2><p> </p><p><a href="http://docs.ansible.com/ansible/latest/playbooks.html" class="external-link" rel="nofollow">Ansible playbook</a> operations can be run with the plugin. The plugin provides several conveniences such as easily using credentials from the Jenkins credential store, unbuffered color output in the log, etc. </p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-Examples.1">Examples</h3><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Scripted.1">Scripted</h4><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Jenkinsfile</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: groovy; gutter: false; theme: Confluence" data-theme="Confluence">ansiblePlaybook credentialsId: &#39;private_key&#39;, inventory: &#39;inventories/a/hosts&#39;, playbook: &#39;my_playbook.yml&#39;</pre>
</div></div><p style="margin-left: 60.0px;"> </p><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Declarative.1">Declarative</h4><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Jenkinsfile</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: groovy; gutter: false; theme: Confluence" data-theme="Confluence">ansiblePlaybook(credentialsId: &#39;private_key&#39;, inventory: &#39;inventories/a/hosts&#39;, playbook: &#39;my_playbook.yml&#39;)</pre>
</div></div><p style="margin-left: 60.0px;"> </p><p style="margin-left: 60.0px;">Additional scripted and declarative pipeline examples can be found on the plugin's <a href="https://github.com/jenkinsci/ansible-plugin" class="external-link" rel="nofollow">GitHub readme</a>.</p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-Arguments.1">Arguments</h3><p style="margin-left: 60.0px;"><a href="https://jenkins.io/doc/pipeline/steps/ansible/" class="external-link" rel="nofollow">jenkins.io</a> documentation</p><div class="table-wrap"><table class="wrapped confluenceTable" style="margin-left: 30.0px;"><colgroup><col/><col/><col/></colgroup><tbody style="margin-left: 30.0px;"><tr style="margin-left: 30.0px;"><th class="confluenceTh">Freestyle Name</th><th class="confluenceTh">Pipeline Name</th><th colspan="1" class="confluenceTh"><span>Description</span></th></tr><tr style="margin-left: 60.0px;"><td class="confluenceTd">Ansible <span>installation</span></td><td class="confluenceTd">installation</td><td colspan="1" class="confluenceTd">Ansible installation to use for the playbook invocation</td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Playbook path</td><td class="confluenceTd">playbook</td><td colspan="1" class="confluenceTd">Mandatory. The name of the playbook to run.</td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Inventory file or host list</td><td class="confluenceTd">inventory</td><td colspan="1" class="confluenceTd"><p>See the <a href="#AnsiblePlugin-Inventory">Inventory</a> section for additional details.</p><p>CLI arg: -i</p></td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd">Inventory Inline content</td><td colspan="1" class="confluenceTd">inventoryContent</td><td colspan="1" class="confluenceTd"><p>See the <a href="#AnsiblePlugin-Inventory">Inventory</a> section for additional details.</p><p>CLI arg: -i</p></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd"><span>Credentials</span></td><td class="confluenceTd">credentialsId</td><td colspan="1" class="confluenceTd"><p>The Jenkins credential to use for the SSH connection. See the <a href="#AnsiblePlugin-Authentication">Authentication</a> section for additional details.</p></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Vault <span>C</span>redentials</td><td class="confluenceTd">vaultCredentialsId</td><td colspan="1" class="confluenceTd"><p>The Jenkins credential to use as the vault credential. See the <a href="#AnsiblePlugin-VaultCredentials">Vault Credentials</a> section for additional details.</p><p>CLI arg: --vault-password-file</p></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">sudo</td><td class="confluenceTd">sudo</td><td colspan="1" class="confluenceTd">CLI arg: -s</td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd"><span>sudo user</span></td><td colspan="1" class="confluenceTd">sudoUser</td><td colspan="1" class="confluenceTd">CLI arg: -U</td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd">Host subset</td><td colspan="1" class="confluenceTd">limit</td><td colspan="1" class="confluenceTd">CLI arg: -l</td></tr><tr style="margin-left: 90.0px;"><td colspan="1" class="confluenceTd"><span>Tags to run</span></td><td colspan="1" class="confluenceTd">tags</td><td colspan="1" class="confluenceTd">CLI arg: -t</td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Tags to skip</td><td colspan="1" class="confluenceTd">skippedTags</td><td colspan="1" class="confluenceTd">CLI arg: --skip-tags</td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Task to start at</td><td colspan="1" class="confluenceTd">startAtTask</td><td colspan="1" class="confluenceTd">CLI arg: --start-at-task</td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Number of parallel processes</td><td colspan="1" class="confluenceTd">forks</td><td colspan="1" class="confluenceTd">CLI arg: -f</td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Check host SSH key</td><td colspan="1" class="confluenceTd">hostKeyChecking</td><td colspan="1" class="confluenceTd"><p>Toggle checking of the host key.</p><p>Sets the environment variable ANSIBLE_HOST_KEY_CHECKING, similar to the recommendations for running with <a href="http://docs.ansible.com/ansible/latest/guide_vagrant.html" class="external-link" rel="nofollow">Vagrant</a>.</p></td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd">Colorized <span>stdout</span></td><td colspan="1" class="confluenceTd">colorized</td><td colspan="1" class="confluenceTd"><p>Toggle color codes in console text. See <a href="#AnsiblePlugin-ColorizedOutput">Colorized Output</a> section for example usage.</p><p>Sets the environment variable ANSIBLE_FORCE_COLOR, similar to the recommendations for running with <a href="http://docs.ansible.com/ansible/latest/guide_vagrant.html" class="external-link" rel="nofollow">Vagrant</a>.</p></td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd"><span>Additional parameters</span></td><td colspan="1" class="confluenceTd">extras</td><td colspan="1" class="confluenceTd">String passed to the Ansible Command Line invocation as-is</td></tr><tr style="margin-left: 60.0px;"><td colspan="1" class="confluenceTd"><span>Extra Variables</span></td><td colspan="1" class="confluenceTd">extraVars</td><td colspan="1" class="confluenceTd">CLI arg: -e</td></tr></tbody></table></div><p style="margin-left: 60.0px;">Refer to the ansible-playbook manual page for details on how each command line argument is interpretted.</p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-Authentication">Authentication</h3><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-SSHKeys">SSH Keys</h4><p style="margin-left: 90.0px;"><a href="https://help.ubuntu.com/community/SSH/OpenSSH/Keys" class="external-link" rel="nofollow">SSH keys</a> are the recommended authentication method for SSH connections. The plugin supports the credential type &quot;SSH Username with private key&quot; configured in the Jenkins credential store through the <a href="https://plugins.jenkins.io/ssh-credentials" class="external-link" rel="nofollow">SSH crendentials plugin</a>.</p><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Password">Password</h4><p style="margin-left: 90.0px;">Even if using SSH keys is recommended authentication method, password authentication may sometimes be required. The plugin has supported password based authentication since 0.3.0. When using password based authentication, the <a href="http://sourceforge.net/projects/sshpass/" class="external-link" rel="nofollow">sshpass</a> binary is expected to be on the PATH. The plugin supports the credential type &quot;Username with password&quot; configured in the Jenkins credential store through the <a href="https://plugins.jenkins.io/ssh-credentials" class="external-link" rel="nofollow">SSH crendentials plugin</a>.</p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-VaultCredentials">Vault Credentials</h3><p style="margin-left: 60.0px;">Vault credentials can be setup in the Jenkins credential store as either a &quot;Secret text&quot; or a &quot;Secret file&quot;. </p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-ColorizedOutput"><span style="color: rgb(210,73,57);"><strong>Colorized Output</strong></span></h3><p style="margin-left: 60.0px;"><span style="color: rgb(0,0,0);">The <a href="https://plugins.jenkins.io/ansicolor" class="external-link" rel="nofollow">AnsiColor plugin</a> is needed for colorized console output. Once installed, colorized output can be enabled with the argument &quot;<span class="pl-c1">colorized</span>: <span class="pl-c1">true</span>&quot;.</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Jenkinsfile</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: groovy; gutter: false; theme: Confluence" data-theme="Confluence">ansiColor(&#39;xterm&#39;) {
    ansiblePlaybook( 
        playbook: &#39;path/to/playbook.yml&#39;,
        inventory: &#39;path/to/inventory.ini&#39;, 
        credentialsId: &#39;sample-ssh-key&#39;,
        colorized: true) 
}</pre>
</div></div><p style="margin-left: 60.0px;"><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/78676706/78938178.png" data-image-src="attachments/78676706/78938178.png" data-unresolved-comment-count="0" data-linked-resource-id="78938178" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="jenkins-deploy-ansible-console.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="78676706" data-linked-resource-container-version="62"></span><br/></span></p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-ExtraParameters">Extra Parameters</h3><p style="margin-left: 60.0px;">Extra parameters is a string passed to the Ansible Command Line invocation as-is and can be useful for arguments occasionally added to an invocation at runtime, such as tags and host limits.</p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-Inventory">Inventory</h3><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-File">File</h4><p style="margin-left: 90.0px;">A string path to the inventory file to use with the playbook invocation.</p><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Inline">Inline</h4><p style="margin-left: 90.0px;">The provided content is used as the content of the inventory file for the playbook invocation.</p><h3 style="margin-left: 30.0px;" id="AnsiblePlugin-UsingJenkinsEnvironmentVariables"><strong>Using Jenkins Environment Variables</strong></h3><p style="margin-left: 60.0px;">Jenkins environment variables can be accessed from within an Ansible playbook. The Jenkins variables are injected as environment variables making them available through the Ansible <a href="http://docs.ansible.com/ansible/latest/playbooks_lookups.html" class="external-link" rel="nofollow">lookup plugin</a>.</p><p style="margin-left: 60.0px;">The following Ansible playbook accesses the Jenkins BUILD_TAG variable:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>playbook.yml</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: xml; gutter: false; theme: Confluence" data-theme="Confluence">---
- hosts: example
  tasks:
    - debug: msg=&quot;{{ lookup(&#39;env&#39;,&#39;BUILD_TAG&#39;) }}&quot;

</pre>
</div></div><p> </p><hr/><h2 style="margin-left: 30.0px;" id="AnsiblePlugin-Vault"><strong><span style="color: rgb(210,73,57);">Vault</span></strong></h2><p style="margin-left: 60.0px;">Most <a href="https://docs.ansible.com/ansible/latest/vault.html" class="external-link" rel="nofollow">Ansible Vault</a> operations can be performed with the plugin. Interactive operations such as create, edit, and view are not supported through the plugin. One use case for this enabling developers to encrypt secret values while keeping the vault password a secret.</p><h3 style="margin-left: 60.0px;" id="AnsiblePlugin-Examples.2">Examples</h3><h4 style="margin-left: 90.0px;" id="AnsiblePlugin-Scripted.2">Scripted</h4><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Encrypts a File</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: groovy; gutter: false; theme: Confluence" data-theme="Confluence">ansibleVault action: &#39;encrypt&#39;, input: &#39;vars/secrets.yml&#39;, vaultCredentialsId: &#39;ansible_vault_credentials&#39;</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Encrypts a String</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: groovy; gutter: false; theme: Confluence" data-theme="Confluence">ansibleVault action: &#39;encrypt_string&#39;, content: &#39;secret_content&#39;, vaultCredentialsId: &#39;ansible_vault_credentials&#39;</pre>
</div></div><h4 style="margin-left: 90.0px;" id="AnsiblePlugin-Declarative.2">Declarative</h4><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Jenkinsfile</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: groovy; gutter: false; theme: Confluence" data-theme="Confluence">ansibleVault(action: &#39;encrypt&#39;, input: &#39;vars/secrets.yml&#39;, vaultCredentialsId: &#39;ansible_vault_credentials&#39;)</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Jenkinsfile</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: groovy; gutter: false; theme: Confluence" data-theme="Confluence">ansibleVault(action: &#39;encrypt_string&#39;, content: &#39;secret_content&#39;, vaultCredentialsId: &#39;ansible_vault_password&#39;)</pre>
</div></div><p> </p><h3 style="margin-left: 60.0px;" id="AnsiblePlugin-Arguments.2">Arguments</h3><p style="margin-left: 90.0px;">See also <a href="https://jenkins.io/doc/pipeline/steps/ansible/" class="external-link" rel="nofollow">jenkins.io</a> documentation.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Freestyle Name</th><th class="confluenceTh">Pipeline Name</th><th class="confluenceTh"><span>Description</span></th></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Ansible <span>installation</span></td><td class="confluenceTd">installation</td><td class="confluenceTd"><span>Ansible installation to use for the vault operation</span></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Action</td><td class="confluenceTd">action</td><td class="confluenceTd"><span>Mandatory. The name of the action to use. Interactive operations such as create, edit, and view are not supported.</span></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Vault Credentials</td><td class="confluenceTd">vaultCredentialsId</td><td class="confluenceTd"><p>The Jenkins credential to use as the vault credential. See the <a href="#AnsiblePlugin-VaultCredentials">Vault Credentials</a> section for additional details.</p><p>CLI arg: --vault-password-file</p></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">New Vault Credentials</td><td class="confluenceTd">newVaultCredentialsId</td><td class="confluenceTd"><p>The Jenkins credential to use as the vault credential. See the <a href="#AnsiblePlugin-VaultCredentials">Vault Credentials</a> section for additional details.</p><p>CLI arg: --new-vault-password-file</p></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Content</td><td class="confluenceTd">content</td><td class="confluenceTd"><span>The content to encrypt with the encrypt_string action</span></td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Input</td><td class="confluenceTd">input</td><td class="confluenceTd">The file to encrypt with the encrypt action</td></tr><tr style="margin-left: 90.0px;"><td class="confluenceTd">Output</td><td class="confluenceTd">output</td><td class="confluenceTd"><span>CLI arg: </span>--output</td></tr></tbody></table></div><h3 style="margin-left: 60.0px;" id="AnsiblePlugin-VaultCredentials.1">Vault Credentials</h3><p style="margin-left: 90.0px;">Vault credentials can be setup in the Jenkins credential store as either a &quot;Secret text&quot; or a &quot;Secret file&quot;. </p><p> </p><hr/><h2 style="margin-left: 30.0px;" id="AnsiblePlugin-OpenIssues"><span style="color: rgb(210,73,57);"><strong>Open Issues</strong></span></h2><p style="margin-left: 60.0px;"> <div class="jim-error-message jim-error-message-table">
    <table class="aui">
        <tbody>
                <tr></tr>

        <tr>
                            <th>type</th>
                            <th>key</th>
                            <th>summary</th>
                            <th>assignee</th>
                            <th>reporter</th>
                            <th>status</th>
                            <th>created</th>
                    </tr>

        <tr>
            <td colspan="7">
                <div class="aui-message aui-message-warning">
                    <p class="message">
                        <span class="icon-in-pdf"></span>
                        Can&#39;t show details. Ask your admin to whitelist this Jira URL.
                    </p>
                     <a class="jira-link" href="https://issues.jenkins-ci.org/secure/IssueNavigator.jspa?reset=true&amp;jqlQuery=component%20=%20ansible-plugin%20AND%20status%20in%20%28Open,%20%22In%20Progress%22,%20Reopened%29&amp;tempMax=1000&amp;src=confmacro">View these issues in Jira</a>                 </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</p><p style="margin-left: 30.0px;"><span style="color: rgb(210,73,57);"><span style="color: rgb(0,51,102);">See also</span> <a href="https://issues.jenkins-ci.org/browse/JENKINS-49061?jql=project%20%3D%20JENKINS%20AND%20component%20%3D%20ansible-plugin" class="external-link" rel="nofollow">All Open Items</a></span></p><p style="margin-left: 30.0px;"><span style="color: rgb(210,73,57);"> </span></p><hr/><h2 style="margin-left: 30.0px;" id="AnsiblePlugin-Changelog"><strong>Changelog</strong></h2><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version1.0(26March2018)"><strong>Version 1.0 (26 March 2018)</strong></h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li><a href="https://jenkins.io/security/advisory/2018-03-26/#SECURITY-630" class="external-link" rel="nofollow">Fix security issue</a>: Do not disable host key verification by default. <strong>This may break existing configurations as host key verification will be enabled everywhere by default.</strong></li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.8.0(16Jan2018)"><strong>Version 0.8.0 (16 Jan 2018)</strong> </h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Add support for Ansible Vault [<a href="https://issues.jenkins-ci.org/browse/JENKINS-48499" class="external-link" rel="nofollow">JENKINS-48499</a>]</li><li>Add hostKeyChecking option to pipeline [<a href="https://issues.jenkins-ci.org/browse/JENKINS-42445" class="external-link" rel="nofollow">JENKINS-42445</a>] </li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.6.2(3Jan2017)"><strong>Version 0.6.2 (3 Jan 2017)</strong> </h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Fix blocker bug when launched from a pipeline [<a href="https://issues.jenkins-ci.org/browse/JENKINS-40780" class="external-link" rel="nofollow">JENKINS-40780</a>] </li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.6.1(1Jan2017)"><strong>Version 0.6.1 (1 Jan 2017)</strong></h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Use latest parent project definition in order to deploy plugin (thanks to <a href="https://github.com/alecharp" class="external-link" rel="nofollow">alecharp</a> for the help and the PR)</li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.6(31Dec2016)"><strong>Version 0.6 (31 Dec 2016)</strong></h4><p style="margin-left: 60.0px;"><strong>WARN: 0.6.x version will be the last one to support Jenkins 1.xxx and Ansible 1.x - The 0.7.x and next releases will require Jenkins 2.32.1 (or higher) and Ansible 2.2 (or higher)</strong></p><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Add a &quot;do not specify&quot; option for inventory [<a href="https://issues.jenkins-ci.org/browse/JENKINS-34627" class="external-link" rel="nofollow">JENKINS-34627</a>]</li><li>Support inventoryContent in pipeline (thanks to <a href="https://github.com/leewin12" class="external-link" rel="nofollow">leewin12</a> for the PR)</li><li>Add support of extra variables in jobdsl (thanks to <a href="https://github.com/pawbur" class="external-link" rel="nofollow">pawbur</a> for the PR)</li><li>Support empty forks (number of parallel processes) parameter [<a href="https://issues.jenkins-ci.org/browse/JENKINS-39438" class="external-link" rel="nofollow">JENKINS-39438</a>]</li><li>Escape '%' character in private key path (thanks to <a href="https://github.com/ewollesen" class="external-link" rel="nofollow">ewollesen</a> for the PR) </li><li>Omit ansible option when expanded environment variable is empty (thanks to <a href="https://github.com/vjestin" class="external-link" rel="nofollow">vjestin</a> for the PR) </li><li>Add the --forks parameter configurable in pipeline step (thanks to <a href="https://github.com/anguswilliams" class="external-link" rel="nofollow">anguswilliams</a> for the PR)</li><li>Fix usage of environment variable in ansiblePlaybook pipeline step (thanks to <a href="https://github.com/thomasKalmar" class="external-link" rel="nofollow">thomasKalmar</a> and <a href="https://github.com/barthorre" class="external-link" rel="nofollow">barthorre</a> for the PR) [<a href="https://issues.jenkins-ci.org/browse/JENKINS-38289" class="external-link" rel="nofollow">JENKINS-38289</a>]</li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.5(5May2016)"><strong>Version 0.5 (5 May 2016)</strong><strong> </strong></h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Add support for ansible extra variables [<a href="https://issues.jenkins-ci.org/browse/JENKINS-29863" class="external-link" rel="nofollow">JENKINS-29863</a>]</li><li>Improve Pipeline plugin integration [<a href="https://issues.jenkins-ci.org/browse/JENKINS-32911" class="external-link" rel="nofollow">JENKINS-32911</a>]</li><li>Add the possibility to use the default inventory file (thanks to Johann Schmitz for the PR)</li><li>Add colorized output in pipeline jobs (thanks to Kirill Merkushev for the PR)</li><li>Make Jenkins build variables available as environment variables for ansible (thanks to Kevin Mooney for the PR) [<a href="https://issues.jenkins-ci.org/browse/JENKINS-29284" class="external-link" rel="nofollow">JENKINS-29284</a>]</li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.4(25December2015)"><strong>Version 0.4 (25 December 2015)</strong><strong> </strong></h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Support for password protected SSH keys [<a href="https://issues.jenkins-ci.org/browse/JENKINS-30656" class="external-link" rel="nofollow">JENKINS-30656</a>]</li><li>Initial support for the workflow plugin [<a href="https://issues.jenkins-ci.org/browse/JENKINS-30398" class="external-link" rel="nofollow">JENKINS-30398</a>]</li><li>Add support for Job DSL plugin (thanks to Kirill Merkushev for the PR) [<a href="https://issues.jenkins-ci.org/browse/JENKINS-31790" class="external-link" rel="nofollow">JENKINS-31790</a>]</li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.3.1(15July2015)"><span style="color: rgb(210,73,57);"><strong>Version 0.3.1 (15 July 2015)</strong></span><strong> </strong></h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Fix execution on slave nodes [<a href="https://issues.jenkins-ci.org/browse/JENKINS-29294" class="external-link" rel="nofollow">JENKINS-29294</a>]</li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.3(20June2015)"><strong>Version 0.3 (20 June 2015)<span style="color: rgb(0,0,0);"> </span></strong></h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Add support for password based SSH authentication (with sshpass)</li><li>Environment variables can be used in Module and Module arguments text field in Ad-hoc command builder</li><li>Environment variables can be used in inline inventory text box [<a href="https://issues.jenkins-ci.org/browse/JENKINS-28547" class="external-link" rel="nofollow">JENKINS-28547</a>]</li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.2(11May2015)"><strong>Version 0.2 (11 May 2015)<span style="color: rgb(0,0,0);"> </span></strong></h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Fix NullPointerException when no credentials are selected</li><li>Fix --skippedTags parameter configuration which was ignored</li><li>Fix NullPointerException and print an error message in the build console when the inventory is not set in the job configuration</li></ul></li></ul></li></ul><h4 style="margin-left: 60.0px;" id="AnsiblePlugin-Version0.1(01May2015)"><strong>Version 0.1 (01 May 2015)</strong></h4><ul><li style="list-style-type: none;background-image: none;"><ul><li style="list-style-type: none;background-image: none;"><ul><li>Initial version</li></ul></li></ul></li></ul>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/78676706/78938177.png">jenkins-deploy-ansible-config.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/78676706/138447171.png">jenkins-deploy-ansible-console.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/78676706/80871446.png">jenkins_ansible_installation.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/78676706/78938178.png">jenkins-deploy-ansible-console.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:11</p>
                    <div id="footer-logo"><a href="/display/">Wiki home</a></div>
                </section>
            </div>
        </div>     </body>
</html>
