<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Sysdig Secure Jenkins Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Sysdig Secure Jenkins Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (sysdig)</span>, last modified on Nov 11, 2018
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><span style="color: rgb(0,0,0);"><a href="https://sysdig.com/products/secure/" class="external-link" rel="nofollow"><span style="color: rgb(0,0,0);">Sysdig Secure</span></a> is a container security platform that brings together docker image scanning and run-time protection to identify vulnerabilities, block threats, enforce compliance, and audit activity across your microservices. The Sysdig Secure Jenkins plugin can be used in a Pipeline job, or added as a build step to a Freestyle job, to automate the process of running an image analysis, evaluating custom policies against images, and performing security scans.</span></p><h1 id="SysdigSecureJenkinsPlugin-Contents"><span style="color: rgb(0,0,0);">Contents</span></h1><p><span style="color: rgb(0,0,0);"><style type='text/css'>/*<![CDATA[*/
div.rbtoc1631023383084 {padding: 0px;}
div.rbtoc1631023383084 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1631023383084 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1631023383084'>
<ul class='toc-indentation'>
<li><a href='#SysdigSecureJenkinsPlugin-GettingStarted'>Getting Started</a>
<ul class='toc-indentation'>
<li><a href='#SysdigSecureJenkinsPlugin-Pre-requisites'>Pre-requisites</a></li>
<li><a href='#SysdigSecureJenkinsPlugin-Installation'>Installation</a></li>
<li><a href='#SysdigSecureJenkinsPlugin-Configuration'>Configuration</a></li>
</ul>
</li>
<li><a href='#SysdigSecureJenkinsPlugin-IntegratetheSysdigSecurePluginwithaFreestyleProject'>Integrate the Sysdig Secure Plugin with a Freestyle Project</a></li>
</ul>
</div><br/></span></p><h1 id="SysdigSecureJenkinsPlugin-GettingStarted"><span style="color: rgb(0,0,0);">Getting Started</span></h1><h2 id="SysdigSecureJenkinsPlugin-Pre-requisites"><span style="color: rgb(0,0,0);">Pre-requisites</span></h2><p><span style="color: rgb(0,0,0);">The Sysdig Secure plugin installation process has the following prerequisites:</span></p><ul><li><span style="color: rgb(0,0,0);">Sysdig Secure installed within the build environment.</span></li><li><span style="color: rgb(0,0,0);">All authentication credentials/Sysdig Secure API endpoint information prepared for input when configuring the plugin.</span></li></ul><h2 id="SysdigSecureJenkinsPlugin-Installation"><span style="color: rgb(0,0,0);">Installation</span></h2><p><span style="color: rgb(0,0,0);">The Sysdig Secure plugin is published in the Jenkins plugin registry, and is available for installation on any Jenkins server.</span></p><ol><li><a href="https://github.com/jenkinsci/sysdig-secure-plugin" class="external-link" rel="nofollow">https://github.com/jenkinsci/sysdig-secure-plugin</a></li></ol><h2 id="SysdigSecureJenkinsPlugin-Configuration"><span style="color: rgb(0,0,0);">Configuration</span></h2><p><span style="color: rgb(0,0,0);">To configure the Sysdig Secure plugin:</span></p><ol><li><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">Complete these steps after installing the hpi file from the installation link above.</span></span></li><li><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">From the main Jenkins menu, select </span><code><strong>Manage</strong><strong> Jenkins</strong></code><span style="color: rgb(0,0,0);">.</span></span></li><li><span style="color: rgb(0,0,0);">Click the <code><strong>Configure System</strong></code> link.<br/></span><strong><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="467" src="attachments/145359144/143495649.png" data-image-src="attachments/145359144/143495649.png" data-unresolved-comment-count="0" data-linked-resource-id="143495649" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image_5.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="145359144" data-linked-resource-container-version="9"></span></span></strong></li><li>Scroll to the <code><strong>Sysdig Secure Plugin Mode</strong></code> section.</li><li><p>Define the engine URL:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">https://secure.sysdig.com/api/scanning/v1/anchore</pre>
</div></div><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" width="800" src="attachments/145359144/145359140.png" data-image-src="attachments/145359144/145359140.png" data-unresolved-comment-count="0" data-linked-resource-id="145359140" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2018-08-30 at 9.31.42 PM.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="145359144" data-linked-resource-container-version="9"></span></p><p><br/></p></li><li><p>Input the API token found here: <a href="https://secure.sysdig.com/#/settings/user" class="external-link" rel="nofollow">https://secure.sysdig.com/#/settings/user</a></p></li><li>Click <code><strong>Save</strong></code>.</li></ol><h1 id="SysdigSecureJenkinsPlugin-IntegratetheSysdigSecurePluginwithaFreestyleProject"><span style="color: rgb(0,0,0);">Integrate the Sysdig Secure Plugin with a Freestyle Project</span></h1><p><span style="color: rgb(0,0,0);">The Sysdig Secure plugin reads a file called <code>sysdig_secure_images</code> for the list of images to scan. In the example below, an execute shell build step is used to build and push a container to a local registry:</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Emacs" data-theme="Emacs">TAG=$(date &quot;+%H%M%S%d%m%Y&quot;)
IMAGENAME=build.example.com/myapp
docker build -t $IMAGENAME:$TAG .
docker push $IMAGENAME:$TAG</pre>
</div></div><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>This process is an example, and should be used as a guide, rather than copying commands directly into a terminal.</p></div></div><p>To configure the build step, add a line to the script to create the <code>sysdig_secure_images</code> file:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Emacs" data-theme="Emacs">TAG=$(date &quot;+%H%M%S%d%m%Y&quot;)
IMAGENAME=build.example.com/myapp
docker build -t $IMAGENAME:$TAG .
docker push $IMAGENAME:$TAG

# Line added to create sysdig_secure_images file
echo &quot;$IMAGENAME:$TAG ${WORKSPACE}/Dockerfile &quot; &gt; sysdig_secure_images</pre>
</div></div><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Multiple lines can be added if the build produces more than a single container image.</p></div></div><p>Once the image has been built and pushed to the staging registry, the Sysdig Secure Image Scan can be called from the Jenkins UI:</p><ol><li>Open the <code><strong>Add build step</strong></code> drop-down menu, and select <code><strong>Sysdig Secure Container Image Scanner</strong></code>. This creates a new build step labeled <code>Sysdig Secure Build Options</code>.<br/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/145359144/145359146.png" data-image-src="attachments/145359144/145359146.png" data-unresolved-comment-count="0" data-linked-resource-id="145359146" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Builddropdown.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="145359144" data-linked-resource-container-version="9"></span></li><li><p>Configure the available options, and click <code><strong>Save</strong></code>.<br/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/145359144/145359141.png" data-image-src="attachments/145359144/145359141.png" data-unresolved-comment-count="0" data-linked-resource-id="145359141" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2018-08-30 at 9.55.35 PM.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="145359144" data-linked-resource-container-version="9"></span><br/>The table below describes each of the configuration options.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><span style="color: rgb(24,50,71);">Option</span></th><th class="confluenceTh"><span style="color: rgb(24,50,71);">Description</span></th></tr><tr><td class="confluenceTd"><span style="color: rgb(24,50,71);">Image list file</span></td><td class="confluenceTd">The name of the file, present in the workspace that contains the image name, and optionally the Dockerfile location.</td></tr><tr><td class="confluenceTd"><span style="color: rgb(24,50,71);">Fail build on policy check STOP result</span></td><td class="confluenceTd"><span style="color: rgb(24,50,71);">If the Sysdig Secure policy evaluate returns a fail (STOP) then the Jenkins job should be failed. If this is not selected then a failed policy evaluation will allow the build to continue.</span></td></tr><tr><td class="confluenceTd"><span style="color: rgb(24,50,71);">Fail build on critical plugin error</span></td><td class="confluenceTd"><span style="color: rgb(24,50,71);">If selected, and the Sysdig Secure Plugin experiences a critical error, the the build will be failed. This is typically used to ensure that a fault with Sysdig Secure (eg. service not available) does not permit a failing image to be promoted to production.</span></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(24,50,71);">Sysdig Secure operation retries</span></td><td colspan="1" class="confluenceTd"><span style="color: rgb(24,50,71);">How long in seconds the Sysdig Secure Plugin waits until timing out image analysis. </span><span style="color: rgb(24,50,71);">The plugin will continue operation once the image has been analyzed but will time out if this period is exceeded.</span></td></tr><tr><td colspan="1" class="confluenceTd"><span>Sysdig Secure Engine policy ID</span></td><td colspan="1" class="confluenceTd"><p>The ID of the policy that the image will be evaluated against. Policies can be found within Sysdig Secure here: <a href="https://secure.sysdig.com/#/scanning/policies" class="external-link" rel="nofollow">https://secure.sysdig.com/#/scanning/policies</a>.</p></td></tr></tbody></table></div></li></ol>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/143495647.png">image_2.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/143495648.png">image_3.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/143495649.png">image_5.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/145359139.png">Screen Shot 2018-08-30 at 9.37.46 PM.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/145359140.png">Screen Shot 2018-08-30 at 9.31.42 PM.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/145359141.png">Screen Shot 2018-08-30 at 9.55.35 PM.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/145359142.png">Screen Shot 2018-08-30 at 9.55.17 PM.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/145359143.png">image_9.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/145359144/145359146.png">Builddropdown.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 14:03</p>
                    <div id="footer-logo"><a href="/display/">Wiki home</a></div>
                </section>
            </div>
        </div>     </body>
</html>
