<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Violation Comments to GitHub Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Violation Comments to GitHub Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (tomasbjerre)</span>, last modified on Jun 13, 2019
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View Violation Comments to GitHub <a href="https://plugins.jenkins.io/violation-comments-to-github" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>
This plugin uses <a href="https://github.com/tomasbjerre/violation-comments-to-github-lib" class="external-link" rel="nofollow">Violation Comments to GitHub Lib</a>. It will find report files from static code analysis and comment GitHub pull requests with the content.<p><br/></p><p><a href="https://ci.jenkins.io/job/Plugins/job/violation-comments-to-github-plugin" rel="nofollow" class="external-link"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" alt="Build Status" src="https://camo.githubusercontent.com/c7c67df5917a189da7c056ec31d514955bc74bf2/68747470733a2f2f63692e6a656e6b696e732e696f2f6a6f622f506c7567696e732f6a6f622f76696f6c6174696f6e2d636f6d6d656e74732d746f2d6769746875622d706c7567696e2f6a6f622f6d61737465722f62616467652f69636f6e" data-image-src="https://camo.githubusercontent.com/c7c67df5917a189da7c056ec31d514955bc74bf2/68747470733a2f2f63692e6a656e6b696e732e696f2f6a6f622f506c7567696e732f6a6f622f76696f6c6174696f6e2d636f6d6d656e74732d746f2d6769746875622d706c7567696e2f6a6f622f6d61737465722f62616467652f69636f6e"></span></a></p><p><br/></p><p>This is a Jenkins plugin for <a href="https://github.com/tomasbjerre/violation-comments-to-github-lib" class="external-link" rel="nofollow">Violation Comments to GitHub Lib</a>. This plugin will find report files from static code analysis and comment GitHub pull requests with the content.</p><p><br/></p><p>It uses <a href="https://github.com/tomasbjerre/violation-comments-to-github-lib" class="external-link" rel="nofollow">Violation Comments to GitHub Lib</a> and supports the same formats as <a href="https://github.com/tomasbjerre/violations-lib" class="external-link" rel="nofollow">Violations Lib</a>.</p><p><br/></p><p>Example of supported reports are available <a href="https://github.com/tomasbjerre/violations-lib/tree/master/src/test/resources" class="external-link" rel="nofollow">here</a>.</p><p style=""><br/></p><p style="">You can also do this with a<span> </span><a style="text-decoration: none;" href="https://www.npmjs.com/package/violation-comments-to-github-command-line" rel="nofollow" class="external-link">command line tool</a>.</p><p style=""><br/></p><p>A number of <span>parsers</span> have been implemented. Some <span>parsers</span> can parse output from several <span>reporters</span>.</p><p><br/></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><thead><tr><th class="confluenceTh">Reporter</th><th class="confluenceTh">Parser</th><th class="confluenceTh">Notes</th></tr></thead><tbody><tr><td class="confluenceTd"><a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm" rel="nofollow" class="external-link"><em>ARM-GCC</em></a></td><td class="confluenceTd"><code>CLANG</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://developer.android.com/tools/help/lint.html" class="external-link"><em>AndroidLint</em></a></td><td class="confluenceTd"><code>ANDROIDLINT</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/willthames/ansible-lint" class="external-link" rel="nofollow"><em>AnsibleLint</em></a></td><td class="confluenceTd"><code>FLAKE8</code></td><td class="confluenceTd">With <code>-p</code></td></tr><tr><td class="confluenceTd"><a href="https://clang-analyzer.llvm.org/" rel="nofollow" class="external-link"><em>CLang</em></a></td><td class="confluenceTd"><code>CLANG</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="http://pmd.sourceforge.net/pmd-4.3.0/cpd.html" rel="nofollow" class="external-link"><em>CPD</em></a></td><td class="confluenceTd"><code>CPD</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://cppcheck.sourceforge.net/" class="external-link"><em>CPPCheck</em></a></td><td class="confluenceTd"><code>CPPCHECK</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/theandrewdavis/cpplint" class="external-link" rel="nofollow"><em>CPPLint</em></a></td><td class="confluenceTd"><code>CPPLINT</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/CSSLint/csslint" class="external-link" rel="nofollow"><em>CSSLint</em></a></td><td class="confluenceTd"><code>CSSLINT</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://checkstyle.sourceforge.net/" class="external-link"><em>Checkstyle</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://codenarc.sourceforge.net/" class="external-link"><em>CodeNarc</em></a></td><td class="confluenceTd"><code>CODENARC</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/arturbosch/detekt" class="external-link" rel="nofollow"><em>Detekt</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd">With <code>--output-format xml</code>.</td></tr><tr><td class="confluenceTd"><a href="http://dotnet.github.io/docfx/" rel="nofollow" class="external-link"><em>DocFX</em></a></td><td class="confluenceTd"><code>DOCFX</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://www.stack.nl/~dimitri/doxygen/" class="external-link"><em>Doxygen</em></a></td><td class="confluenceTd"><code>CLANG</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://www.puppetcookbook.com/posts/erb-template-validation.html" class="external-link"><em>ERB</em></a></td><td class="confluenceTd"><code>CLANG</code></td><td class="confluenceTd">With <code>erb -P -x -T '-' &quot;${it}&quot; | ruby -c 2&gt;&amp;1 &gt;/dev/null | grep '^-' | sed -E 's/^-([a-zA-Z0-9:]+)/${filename}\1 ERROR:/p' &gt; erbfiles.out</code>.</td></tr><tr><td class="confluenceTd"><a href="https://github.com/sindresorhus/grunt-eslint" class="external-link" rel="nofollow"><em>ESLint</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd">With <code>format: 'checkstyle'</code>.</td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://findbugs.sourceforge.net/" class="external-link"><em>Findbugs</em></a></td><td class="confluenceTd"><code>FINDBUGS</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="http://flake8.readthedocs.org/en/latest/" rel="nofollow" class="external-link"><em>Flake8</em></a></td><td class="confluenceTd"><code>FLAKE8</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://en.wikipedia.org/wiki/FxCop" class="external-link"><em>FxCop</em></a></td><td class="confluenceTd"><code>FXCOP</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://gcc.gnu.org/" rel="nofollow" class="external-link"><em>GCC</em></a></td><td class="confluenceTd"><code>CLANG</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://www.mono-project.com/docs/tools+libraries/tools/gendarme/" class="external-link"><em>Gendarme</em></a></td><td class="confluenceTd"><code>GENDARME</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/golang/lint" class="external-link" rel="nofollow"><em>GoLint</em></a></td><td class="confluenceTd"><code>GOLINT</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://golang.org/cmd/vet/" rel="nofollow" class="external-link"><em>GoVet</em></a></td><td class="confluenceTd"><code>GOLINT</code></td><td class="confluenceTd">Same format as GoLint.</td></tr><tr><td class="confluenceTd"><a href="https://github.com/golangci/golangci-lint/" class="external-link" rel="nofollow"><em>GolangCI-Lint</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd">With <code>--out-format=checkstyle</code>.</td></tr><tr><td class="confluenceTd"><a href="https://github.com/google/error-prone" class="external-link" rel="nofollow"><em>GoogleErrorProne</em></a></td><td class="confluenceTd"><code>GOOGLEERRORPRONE</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://www.iar.com/iar-embedded-workbench/" class="external-link"><em>IAR</em></a></td><td class="confluenceTd"><code>IAR</code></td><td class="confluenceTd">With <code>--no_wrap_diagnostics</code></td></tr><tr><td class="confluenceTd"><a href="http://fbinfer.com/" rel="nofollow" class="external-link"><em>Infer</em></a></td><td class="confluenceTd"><code>PMD</code></td><td class="confluenceTd">Facebook Infer. With <code>--pmd-xml</code>.</td></tr><tr><td class="confluenceTd"><a href="https://github.com/jCoderZ/fawkez/wiki/JcReport" class="external-link" rel="nofollow"><em>JCReport</em></a></td><td class="confluenceTd"><code>JCREPORT</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="http://jshint.com/" rel="nofollow" class="external-link"><em>JSHint</em></a></td><td class="confluenceTd"><code>JSHINT</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/shyiko/ktlint" class="external-link" rel="nofollow"><em>KTLint</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://www.klocwork.com/products-services/klocwork/static-code-analysis" class="external-link"><em>Klocwork</em></a></td><td class="confluenceTd"><code>KLOCWORK</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/JetBrains/kotlin" class="external-link" rel="nofollow"><em>KotlinGradle</em></a></td><td class="confluenceTd"><code>KOTLINGRADLE</code></td><td class="confluenceTd">Output from Kotlin Gradle Plugin.</td></tr><tr><td class="confluenceTd"><a href="https://github.com/JetBrains/kotlin" class="external-link" rel="nofollow"><em>KotlinMaven</em></a></td><td class="confluenceTd"><code>KOTLINMAVEN</code></td><td class="confluenceTd">Output from Kotlin Maven Plugin.</td></tr><tr><td class="confluenceTd"><a href="https://github.com/jenkinsci/violation-comments-to-github-plugin/blob/master" class="external-link" rel="nofollow"><em>Lint</em></a></td><td class="confluenceTd"><code>LINT</code></td><td class="confluenceTd">A common XML format, used by different linters.</td></tr><tr><td class="confluenceTd"><a href="https://visualstudio.microsoft.com/vs/features/cplusplus/" rel="nofollow" class="external-link"><em>MSCpp</em></a></td><td class="confluenceTd"><code>MSCPP</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://pypi.python.org/pypi/mccabe" rel="nofollow" class="external-link"><em>Mccabe</em></a></td><td class="confluenceTd"><code>FLAKE8</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://pypi.python.org/pypi/mypy-lang" class="external-link"><em>MyPy</em></a></td><td class="confluenceTd"><code>MYPY</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/uber/NullAway" class="external-link" rel="nofollow"><em>NullAway</em></a></td><td class="confluenceTd"><code>GOOGLEERRORPRONE</code></td><td class="confluenceTd">Same format as Google Error Prone.</td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://www.gimpel.com/html/pcl.htm" class="external-link"><em>PCLint</em></a></td><td class="confluenceTd"><code>PCLINT</code></td><td class="confluenceTd">PC-Lint using the same output format as the Jenkins warnings plugin, <a href="https://wiki.jenkins.io/display/JENKINS/PcLint+options" rel="nofollow"><em>details here</em></a></td></tr><tr><td class="confluenceTd"><a href="https://github.com/squizlabs/PHP_CodeSniffer" class="external-link" rel="nofollow"><em>PHPCS</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd">With <code>phpcs api.php --report=checkstyle</code>.</td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://phpmd.org/" class="external-link"><em>PHPPMD</em></a></td><td class="confluenceTd"><code>PMD</code></td><td class="confluenceTd">With <code>phpmd api.php xml ruleset.xml</code>.</td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://pmd.github.io/" class="external-link"><em>PMD</em></a></td><td class="confluenceTd"><code>PMD</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/PyCQA/pycodestyle" class="external-link" rel="nofollow"><em>Pep8</em></a></td><td class="confluenceTd"><code>FLAKE8</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/Perl-Critic" class="external-link" rel="nofollow"><em>PerlCritic</em></a></td><td class="confluenceTd"><code>PERLCRITIC</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="http://pitest.org/" rel="nofollow" class="external-link"><em>PiTest</em></a></td><td class="confluenceTd"><code>PITEST</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="http://puppet-lint.com/" rel="nofollow" class="external-link"><em>Puppet-Lint</em></a></td><td class="confluenceTd"><code>CLANG</code></td><td class="confluenceTd">With <code>-log-format %{fullpath}:%{line}:%{column}: %{kind}: %{message}</code></td></tr><tr><td class="confluenceTd"><a href="https://pypi.python.org/pypi/pydocstyle" rel="nofollow" class="external-link"><em>PyDocStyle</em></a></td><td class="confluenceTd"><code>PYDOCSTYLE</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://pypi.python.org/pypi/pyflakes" rel="nofollow" class="external-link"><em>PyFlakes</em></a></td><td class="confluenceTd"><code>FLAKE8</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://www.pylint.org/" rel="nofollow" class="external-link"><em>PyLint</em></a></td><td class="confluenceTd"><code>PYLINT</code></td><td class="confluenceTd">With <code>pylint --output-format=parseable</code>.</td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://www.jetbrains.com/resharper/" class="external-link"><em>ReSharper</em></a></td><td class="confluenceTd"><code>RESHARPER</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://rubocop.readthedocs.io/en/latest/formatters/" class="external-link"><em>RubyCop</em></a></td><td class="confluenceTd"><code>CLANG</code></td><td class="confluenceTd">With <code>rubycop -f clang file.rb</code></td></tr><tr><td class="confluenceTd"><a href="http://www.scala-sbt.org/" rel="nofollow" class="external-link"><em>SbtScalac</em></a></td><td class="confluenceTd"><code>SBTSCALAC</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="http://www.scalastyle.org/" rel="nofollow" class="external-link"><em>Scalastyle</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="http://www.harukizaemon.com/simian/" class="external-link"><em>Simian</em></a></td><td class="confluenceTd"><code>SIMIAN</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://www.sonarqube.org/" rel="nofollow" class="external-link"><em>Sonar</em></a></td><td class="confluenceTd"><code>SONAR</code></td><td class="confluenceTd">With <code>mvn sonar:sonar -Dsonar.analysis.mode=preview -Dsonar.report.export.path=sonar-report.json</code>.</td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://spotbugs.github.io/" class="external-link"><em>Spotbugs</em></a></td><td class="confluenceTd"><code>FINDBUGS</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://stylecop.codeplex.com/" class="external-link"><em>StyleCop</em></a></td><td class="confluenceTd"><code>STYLECOP</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://github.com/realm/SwiftLint" class="external-link" rel="nofollow"><em>SwiftLint</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd">With <code>--reporter checkstyle</code>.</td></tr><tr><td class="confluenceTd"><a rel="nofollow" href="https://palantir.github.io/tslint/usage/cli/" class="external-link"><em>TSLint</em></a></td><td class="confluenceTd"><code>CHECKSTYLE</code></td><td class="confluenceTd">With <code>-t checkstyle</code></td></tr><tr><td class="confluenceTd"><a href="http://xmlsoft.org/xmllint.html" rel="nofollow" class="external-link"><em>XMLLint</em></a></td><td class="confluenceTd"><code>XMLLINT</code></td><td class="confluenceTd"><br/></td></tr><tr><td class="confluenceTd"><a href="https://yamllint.readthedocs.io/en/stable/index.html" rel="nofollow" class="external-link"><em>YAMLLint</em></a></td><td class="confluenceTd"><code>YAMLLINT</code></td><td class="confluenceTd">With <code>-f parsable</code></td></tr><tr><td class="confluenceTd"><a href="https://pypi.python.org/pypi/zptlint" rel="nofollow" class="external-link"><em>ZPTLint</em></a></td><td class="confluenceTd"><code>ZPTLINT</code></td><td class="confluenceTd"><br/></td></tr></tbody></table></div><p><br/></p><p>Missing a format? Open an issue <a href="https://github.com/tomasbjerre/violations-lib/issues" class="external-link" rel="nofollow">here</a>!</p><p><br/></p><p>There is also:</p><p><br/></p><ul><li>A <a href="https://github.com/tomasbjerre/violation-comments-to-github-gradle-plugin" class="external-link" rel="nofollow">Gradle plugin</a>.</li><li>A <a href="https://github.com/tomasbjerre/violation-comments-to-github-maven-plugin" class="external-link" rel="nofollow">Maven plugin</a>.</li></ul><p><br/></p><p>Available in Jenkins <a rel="nofollow" href="https://wiki.jenkins-ci.org/display/JENKINS/Violation+Comments+to+GitHub+Plugin" class="external-link">here</a>.</p><p><br/></p><h2 id="ViolationCommentstoGitHubPlugin-NotifyJenkinsfromGitHub">Notify Jenkins from GitHub</h2><p><br/></p><p>You will need to the <span>pull request id</span> for the pull request that was built.</p><p><br/></p><ul><li><p>You may trigger with a <a href="https://developer.github.com/v3/activity/events/types/#pullrequestevent" class="external-link" rel="nofollow">webhook</a> in GitHub. And consume it with <a href="https://github.com/jenkinsci/generic-webhook-trigger-plugin" class="external-link" rel="nofollow">Generic Webhook Trigger plugin</a> to get the variables you need.</p></li><li><p>Or, trigger with <a href="https://wiki.jenkins-ci.org/display/JENKINS/GitHub+pull+request+builder+plugin" rel="nofollow" class="external-link">GitHub Pull Request Builder Plugin</a>, it provides the environment variable <code>ghprbPullId</code>.</p></li></ul><p><br/></p><h2 id="ViolationCommentstoGitHubPlugin-Merge">Merge</h2><p><br/></p><p><span>You must perform the merge before build</span>. If you don't perform the merge, the reported violations will refer to other lines then those in the pull request. The merge can be done with a shell script like this.</p><p><br/></p><pre><code>echo ---
echo --- Merging from $FROM in $FROMREPO to $TO in $TOREPO
echo ---
git clone $TOREPO
cd *
git reset --hard $TO
git status
git remote add from $FROMREPO
git fetch from
git merge $FROM
git --no-pager log --max-count=10 --graph --abbrev-commit

Your build command here!
</code></pre><p><br/></p><h1 id="ViolationCommentstoGitHubPlugin-Screenshots">Screenshots</h1><p><br/></p><p>When installed, a post build action will be available.</p><p><br/></p><p><a href="https://github.com/jenkinsci/violation-comments-to-github-jenkins-plugin/blob/master/sandbox/jenkins-postbuildmenu.png" class="external-link" rel="nofollow"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" alt="Post build action menu" src="https://github.com/jenkinsci/violation-comments-to-github-jenkins-plugin/raw/master/sandbox/jenkins-postbuildmenu.png" data-image-src="https://github.com/jenkinsci/violation-comments-to-github-jenkins-plugin/raw/master/sandbox/jenkins-postbuildmenu.png"></span></a></p><p><br/></p><p>The pull request will be commented like this.</p><p><br/></p><p><a href="https://github.com/jenkinsci/violation-comments-to-github-jenkins-plugin/blob/master/sandbox/github-pr-diff-comment.png" class="external-link" rel="nofollow"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" alt="Pull request comment" src="https://github.com/jenkinsci/violation-comments-to-github-jenkins-plugin/raw/master/sandbox/github-pr-diff-comment.png" data-image-src="https://github.com/jenkinsci/violation-comments-to-github-jenkins-plugin/raw/master/sandbox/github-pr-diff-comment.png"></span></a></p><p><br/></p><h2 id="ViolationCommentstoGitHubPlugin-JobDSLPlugin">Job DSL Plugin</h2><p><br/></p><p>This plugin can be used with the Job DSL Plugin. In this example the <a href="https://wiki.jenkins-ci.org/display/JENKINS/GitHub+pull+request+builder+plugin" rel="nofollow" class="external-link">GitHub Pull Request Builder Plugin</a> is used to trigger, merge and provide environment variables needed.</p><p><br/></p><pre><code>job('GitHub_PR_Builder') {
 concurrentBuild()
 quietPeriod(0)
 scm {
  git {
   remote {
    github('tomasbjerre/violations-test')
    refspec('+refs/pull/*:refs/remotes/origin/pr/*')
   }
   branch('${sha1}')
  }
 }

 triggers {
  githubPullRequest {
   cron('* * * * *')
   permitAll()
   extensions {
    buildStatus {
     completedStatus('SUCCESS', 'There were no errors, go have a cup of coffee...')
     completedStatus('FAILURE', 'There were errors, for info, please see...')
     completedStatus('ERROR', 'There was an error in the infrastructure, please contact...')
    }
   }
  }
 }

 steps {
  shell('''
./gradlew build
  ''')
 }

 publishers {
  violationsToGitHubRecorder {
   config {
    gitHubUrl(&quot;https://api.github.com/&quot;)
    repositoryOwner(&quot;tomasbjerre&quot;)
    repositoryName(&quot;violations-test&quot;)
    pullRequestId(&quot;\$ghprbPullId&quot;)

    // Only specify one of these!
    oAuth2Token(&quot;&quot;)
    credentialsId(&quot;githubtoken&quot;)
    
    createSingleFileComments(true)
    createCommentWithAllSingleFileComments(true)
    commentOnlyChangedContent(true)
    minSeverity('INFO')
    maxNumberOfViolations(99999)
    keepOldComments(false)
    
    commentTemplate(&quot;&quot;&quot;
    **Reporter**: {{violation.reporter}}{{#violation.rule}}
    
    **Rule**: {{violation.rule}}{{/violation.rule}}
    **Severity**: {{violation.severity}}
    **File**: {{violation.file}} L{{violation.startLine}}{{#violation.source}}
    
    **Source**: {{violation.source}}{{/violation.source}}
    
    {{violation.message}}
    &quot;&quot;&quot;)
    
    violationConfigs {
     violationConfig {
      parser(&quot;FINDBUGS&quot;)
      reporter(&quot;Findbugs&quot;)
      pattern(&quot;.*/findbugs/.*\\.xml\$&quot;)
     }
     violationConfig {
      parser(&quot;CHECKSTYLE&quot;)
      reporter(&quot;Checkstyle&quot;)
      pattern(&quot;.*/checkstyle/.*\\.xml\$&quot;)
     }
    }
   }
  }
 }
}
</code></pre><p><br/></p><p>Here is another example using <a href="https://github.com/jenkinsci/generic-webhook-trigger-plugin" class="external-link" rel="nofollow">Generic Webhook Trigger plugin</a>. You will need to add a webhook in GitHub and point it to <code><a href="http://JENKINS_URL/generic-webhook-trigger/invoke" class="external-link" rel="nofollow">http://JENKINS_URL/generic-webhook-trigger/invoke</a></code>. You may want to combine this with <a rel="nofollow" href="https://wiki.jenkins-ci.org/display/JENKINS/HTTP+Request+Plugin" class="external-link">HTTP Request Plugin</a> to comment the pull requests with a link to the job. And also <a rel="nofollow" href="https://wiki.jenkins-ci.org/display/JENKINS/Conditional+BuildStep+Plugin" class="external-link">Conditional BuildStep Plugin</a> to have different comments depending on build status.</p><p><br/></p><pre><code>job('GitHub_PR_Builder Generic') {
 concurrentBuild()
 quietPeriod(0)
 parameters {
  stringParam('PULL_REQUEST_HEAD_URL', '')
  stringParam('PULL_REQUEST_BASE_URL', '')
  stringParam('PULL_REQUEST_HEAD_REF', '')
  stringParam('PULL_REQUEST_BASE_REF', '')
 }
 scm {
  git {
   remote {
    name('origin')
    url('$PULL_REQUEST_BASE_URL')
   }
   remote {
    name('upstream')
    url('$PULL_REQUEST_HEAD_URL')
   }
   branch('$PULL_REQUEST_HEAD_REF')
   extensions {
    mergeOptions {
     remote('upstream')
     branch('$PULL_REQUEST_BASE_REF')
    }
   }
  }
 }
 triggers {
  genericTrigger {
   genericVariables {
    genericVariable {
     key(&quot;PULL_REQUEST_HEAD_URL&quot;)
     value(&quot;\$.pull_request.head.repo.clone_url&quot;)
     expressionType(&quot;JSONPath&quot;)
     regexpFilter(&quot;&quot;)
    }
    genericVariable {
     key(&quot;PULL_REQUEST_HEAD_REF&quot;)
     value(&quot;\$.pull_request.head.ref&quot;)
     expressionType(&quot;JSONPath&quot;)
     regexpFilter(&quot;&quot;)
    }
    genericVariable {
     key(&quot;PULL_REQUEST_BASE_URL&quot;)
     value(&quot;\$.pull_request.base.repo.clone_url&quot;)
     expressionType(&quot;JSONPath&quot;)
     regexpFilter(&quot;&quot;)
    }
    genericVariable {
     key(&quot;PULL_REQUEST_BASE_REF&quot;)
     value(&quot;\$.pull_request.base.ref&quot;)
     expressionType(&quot;JSONPath&quot;)
     regexpFilter(&quot;&quot;)
    }
    genericVariable {
     key(&quot;PULL_REQUEST_BASE_OWNER&quot;)
     value(&quot;\$.pull_request.base.repo.owner.login&quot;)
     expressionType(&quot;JSONPath&quot;)
     regexpFilter(&quot;&quot;)
    }
    genericVariable {
     key(&quot;PULL_REQUEST_BASE_REPO&quot;)
     value(&quot;\$.pull_request.base.repo.name&quot;)
     expressionType(&quot;JSONPath&quot;)
     regexpFilter(&quot;&quot;)
    }
    genericVariable {
     key(&quot;PULL_REQUEST_ID&quot;)
     value(&quot;\$.number&quot;)
     expressionType(&quot;JSONPath&quot;)
     regexpFilter(&quot;&quot;)
    }
    genericVariable {
     key(&quot;ACTION&quot;)
     value(&quot;\$.action&quot;)
     expressionType(&quot;JSONPath&quot;)
     regexpFilter(&quot;&quot;)
    }
   }
   regexpFilterText(&quot;\$ACTION&quot;)
   regexpFilterExpression(&quot;opened|reopened|synchronize&quot;)
  }
 }

 steps {
  shell('./gradlew build')
 }

 publishers {
  violationsToGitHubRecorder {
   config {
    gitHubUrl(&quot;https://api.github.com/&quot;)
    repositoryOwner(&quot;\$PULL_REQUEST_BASE_OWNER&quot;)
    repositoryName(&quot;\$PULL_REQUEST_BASE_REPO&quot;)
    pullRequestId(&quot;\$PULL_REQUEST_ID&quot;)

    // Only specify one of these!
    oAuth2Token(&quot;oh no!&quot;)
    credentialsId(&quot;githubtoken&quot;)

    createSingleFileComments(true)
    createCommentWithAllSingleFileComments(true)
    commentOnlyChangedContent(true)
    minSeverity('INFO')
    maxNumberOfViolations(99999)
    keepOldComments(false)
    
    commentTemplate(&quot;&quot;&quot;
    **Reporter**: {{violation.reporter}}{{#violation.rule}}
    
    **Rule**: {{violation.rule}}{{/violation.rule}}
    **Severity**: {{violation.severity}}
    **File**: {{violation.file}} L{{violation.startLine}}{{#violation.source}}
    
    **Source**: {{violation.source}}{{/violation.source}}
    
    {{violation.message}}
    &quot;&quot;&quot;)
    
    violationConfigs {
     violationConfig {
      parser(&quot;FINDBUGS&quot;)
      reporter(&quot;Findbugs&quot;)
      pattern(&quot;.*/findbugs/.*\\.xml\$&quot;)
     }
     violationConfig {
      parser(&quot;CHECKSTYLE&quot;)
      reporter(&quot;Checkstyle&quot;)
      pattern(&quot;.*/checkstyle/.*\\.xml\$&quot;)
     }
    }
   }
  }
 }
}
</code></pre><p><br/></p><h2 id="ViolationCommentstoGitHubPlugin-PipelinePlugin">Pipeline Plugin</h2><p><br/></p><p>This plugin can be used with the Pipeline Plugin:</p><p><br/></p><pre><code>node {
 def mvnHome = tool 'Maven 3.3.9'
 deleteDir()
 
 stage('Merge') {
  sh &quot;git init&quot;
  sh &quot;git fetch --no-tags --progress git@git:group/reponame.git +refs/heads/*:refs/remotes/origin/* --depth=200&quot;
  sh &quot;git checkout origin/${env.targetBranch}&quot;
  sh &quot;git merge origin/${env.sourceBranch}&quot;
  sh &quot;git log --graph --abbrev-commit --max-count=10&quot;
 }

 stage('Static code analysis') {
  sh &quot;${mvnHome}/bin/mvn package -DskipTests -Dmaven.test.failure.ignore=false -Dsurefire.skip=true -Dmaven.compile.fork=true -Dmaven.javadoc.skip=true&quot;

  step([
   $class: 'ViolationsToGitHubRecorder', 
   config: [
    gitHubUrl: 'https://api.github.com/', 
    repositoryOwner: 'tomasbjerre', 
    repositoryName: 'violations-test', 
    pullRequestId: '2', 

    // Only specify one of these!
    oAuth2Token: '',
    credentialsId: '',

    createCommentWithAllSingleFileComments: true, 
    createSingleFileComments: true, 
    commentOnlyChangedContent: true, 
    minSeverity: 'INFO',
    maxNumberOfViolations: 99999,
    keepOldComments: false,
 
    commentTemplate: &quot;&quot;&quot;
    **Reporter**: {{violation.reporter}}{{#violation.rule}}
    
    **Rule**: {{violation.rule}}{{/violation.rule}}
    **Severity**: {{violation.severity}}
    **File**: {{violation.file}} L{{violation.startLine}}{{#violation.source}}
    
    **Source**: {{violation.source}}{{/violation.source}}
    
    {{violation.message}}
    &quot;&quot;&quot;,

    violationConfigs: [
     [ pattern: '.*/checkstyle-result\\.xml$', parser: 'CHECKSTYLE', reporter: 'Checkstyle' ], 
     [ pattern: '.*/findbugsXml\\.xml$', parser: 'FINDBUGS', reporter: 'Findbugs' ], 
     [ pattern: '.*/pmd\\.xml$', parser: 'PMD', reporter: 'PMD' ], 
    ]
   ]
  ])
 }
}</code></pre><p><span style="color: rgb(210,73,57);font-size: 24.0px;letter-spacing: 0.0px;">Changelog</span></p><p><a href="https://github.com/jenkinsci/violation-comments-to-github-plugin/blob/master/CHANGELOG.md" class="external-link" rel="nofollow">https://github.com/jenkinsci/violation-comments-to-github-plugin/blob/master/CHANGELOG.md</a></p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/96076160/96305166.png">jenkins-postbuildmenu.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/96076160/96305177.png">jenkins-postbuildaction.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/96076160/96305168.png">findbugs-github-pr-file-comment.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/96076160/100106299.png">github-pr-diff-comment.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/96076160/96305167.png">jenkins-postbuildaction.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/96076160/96305176.png">github-pr-diff-comment.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:56</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
