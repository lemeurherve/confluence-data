<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : LDAP Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : LDAP Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (jglick)</span>, last modified by <span class='editor'> Unknown User (dnusbaum)</span> on Feb 19, 2018
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View LDAP <a href="https://plugins.jenkins.io/ldap" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>
<p><em>Note</em>: This plugin was part of the Jenkins core until 1.468. After that, it was split out into a separately-updateable plugin. However, for backwards compatibility purposes, subsequent core releases still bundle it. If you do not use this plugin at all, you can simply disable it.</p><p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1631021510039 {padding: 0px;}
div.rbtoc1631021510039 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1631021510039 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1631021510039'>
<ul class='toc-indentation'>
<li><a href='#LDAPPlugin-Description'>Description</a></li>
<li><a href='#LDAPPlugin-Configuration'>Configuration</a>
<ul class='toc-indentation'>

<ul class='toc-indentation'>
<li><a href='#LDAPPlugin-Server'>Server</a></li>
<li><a href='#LDAPPlugin-TestLDAPSettings'>Test LDAP Settings</a></li>
<li><a href='#LDAPPlugin-RootDN'>Root DN</a></li>
<li><a href='#LDAPPlugin-Usersearchbase'>User search base</a></li>
<li><a href='#LDAPPlugin-Usersearchfilter'>User search filter</a></li>
<li><a href='#LDAPPlugin-Groupsearchbase'>Group search base</a></li>
<li><a href='#LDAPPlugin-Groupsearchfilter'>Group search filter</a></li>
<li><a href='#LDAPPlugin-Groupmembership'>Group membership</a>
<ul class='toc-indentation'>
<li><a href='#LDAPPlugin-Searchforgroupscontaininguser'>Search for groups containing user</a></li>
<li><a href='#LDAPPlugin-Parseuserattributeforlistofgroups'>Parse user attribute for list of groups</a></li>
</ul>
</li>
<li><a href='#LDAPPlugin-ManagerDNandManagerPassword'>Manager DN and Manager Password</a></li>
<li><a href='#LDAPPlugin-DisableLDAPEmailresolver'>Disable LDAP Email resolver</a></li>
<li><a href='#LDAPPlugin-Enablecache'>Enable cache</a></li>
<li><a href='#LDAPPlugin-EnvironmentProperties'>Environment Properties</a></li>
</ul>
<li><a href='#LDAPPlugin-Troubleshooting'>Troubleshooting</a></li>
<li><a href='#LDAPPlugin-PerformanceTuning'>Performance Tuning</a>
<ul class='toc-indentation'>
<li><a href='#LDAPPlugin-TipsandTricks'>Tips and Tricks</a></li>
</ul>
</li>
<li><a href='#LDAPPlugin-VersionHistory'>Version History</a>
<ul class='toc-indentation'>
<li><a href='#LDAPPlugin-Version1.20(19thFeb2018)'>Version 1.20 (19th Feb 2018)</a></li>
<li><a href='#LDAPPlugin-Version1.19(31stJan2018)'>Version 1.19 (31st Jan 2018)</a></li>
<li><a href='#LDAPPlugin-Version1.18(9thNov2017)'>Version 1.18 (9th Nov 2017)</a></li>
<li><a href='#LDAPPlugin-Version1.17(13thSep2017)'>Version 1.17 (13th Sep 2017)</a></li>
<li><a href='#LDAPPlugin-Version1.16(3rdJuly2017)'>Version 1.16 (3rd July 2017)</a></li>
<li><a href='#LDAPPlugin-Version1.15(2ndMay2017)'>Version 1.15 (2nd May 2017)</a></li>
<li><a href='#LDAPPlugin-Version1.14(23rdJan2017)'>Version 1.14 (23rd Jan 2017)</a></li>
<li><a href='#LDAPPlugin-Version1.13(20thSep2016)'>Version 1.13 (20th Sep 2016)</a></li>
<li><a href='#LDAPPlugin-Version1.12(26thApr2016)'>Version 1.12 (26th Apr 2016)</a></li>
<li><a href='#LDAPPlugin-Version1.11(3rdOct2014)'>Version 1.11 (3rd Oct 2014)</a></li>
<li><a href='#LDAPPlugin-Version1.10.2(23rdMay2014)'>Version 1.10.2 (23rd May 2014)</a></li>
<li><a href='#LDAPPlugin-Version1.10.1(23rdMay2014)'>Version 1.10.1 (23rd May 2014)</a></li>
<li><a href='#LDAPPlugin-Version1.10(22ndMay2014)'>Version 1.10 (22nd May 2014)</a></li>
<li><a href='#LDAPPlugin-Version1.9(9thMay2014)'>Version 1.9 (9th May 2014)</a></li>
<li><a href='#LDAPPlugin-Version1.8(17thJan2014)'>Version 1.8 (17th Jan 2014)</a></li>
<li><a href='#LDAPPlugin-Version1.7(9thDec2013)'>Version 1.7 (9th Dec 2013)</a></li>
<li><a href='#LDAPPlugin-Version1.6(24thJul2013)'>Version 1.6 (24th Jul 2013)</a></li>
<li><a href='#LDAPPlugin-Version1.5(14thJun2013)'>Version 1.5 (14th Jun 2013)</a></li>
<li><a href='#LDAPPlugin-Version1.4(24thApr2013)'>Version 1.4 (24th Apr 2013)</a></li>
<li><a href='#LDAPPlugin-Version1.3(24thApr2013)'>Version 1.3 (24th Apr 2013)</a></li>
<li><a href='#LDAPPlugin-Version1.2(6thDev2012)'>Version 1.2 (6th Dev 2012)</a></li>
<li><a href='#LDAPPlugin-Version1.1(11thJun2012)'>Version 1.1 (11th Jun 2012)</a></li>
<li><a href='#LDAPPlugin-Version1.0(6thJun2012)'>Version 1.0 (6th Jun 2012)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></p><h1 id="LDAPPlugin-Description">Description</h1><p>This plugin provides yet another way of authenticating users using LDAP. It can be used with LDAP servers like Active Directory or OpenLDAP among others. Supported configuration can be found below these lines. </p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>It is <strong>strongly</strong> encouraged that you upgrade to at least version 1.15 of the LDAP plugin as that version includes the <code>Test LDAP settings</code> button which contains a number of important diagnostic checks to validate subtle issues with your LDAP configuration.</p><p>Existing LDAP users are strongly encouraged to upgrade to this version and use the button to ensure that their existing configuration does not have subtle issues (most common subtle issues revolve around group resolution and user lookup and typically surface for users as issues with API token or Jenkins CLI access but can also appear with features such as the <a href="Authorize-Project-plugin.html">Authorize Project plugin</a> or other plugins that require details of user permissions or group membership outside of a user's web session)</p></div></div><p> </p><h1 id="LDAPPlugin-Configuration">Configuration</h1><p>Select LDAP for the Security Realm. You will most likely need to configure some of the Advanced options. There is on-line help available for each option.  <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/65143077/118063707.png" data-image-src="attachments/65143077/118063707.png" data-unresolved-comment-count="0" data-linked-resource-id="118063707" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2017-05-02 at 09.52.20.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="65143077" data-linked-resource-container-version="48"></span></p><h3 id="LDAPPlugin-Server">Server</h3><p>Specify the name of the LDAP server host name (like <code>ldap.acme.org</code>).</p><p>If your LDAP server uses a port other than <code>389</code> (which is the standard for LDAP), you can also append a port number here, like <code>ldap.acme.org:1389</code>.</p><p>To connect to LDAP over SSL (AKA LDAPS), specify it with the <code>ldaps://</code> protocol, like <code>ldaps://ldap.acme.org</code> or <code>ldaps://ldap.acme.org:1636</code> (if the port is other than the default <code>636</code>).</p><p>As of version 1.6, you can specify a list of servers separated by whitespace to provide a fallback if the first server is unavailable, e.g. <code>ldap1.acme.org ldap2.acme.org:1389</code> or <code>ldaps://ldap1.acme.org:1636 ldap1.acme.org:1389 ldap://ldap2.acme.org ldap3.acme.org</code></p><h3 id="LDAPPlugin-TestLDAPSettings">Test LDAP Settings</h3><p>This button will allow you to check the full LDAP configuration settings which you have defined (as compared with the field validation which only verifies a subset of the configuration)</p><p>Clicking this button will display a modal dialog to prompt you to provide a username and password:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/65143077/118063708.png" data-image-src="attachments/65143077/118063708.png" data-unresolved-comment-count="0" data-linked-resource-id="118063708" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="test-ldap-dialog.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="65143077" data-linked-resource-container-version="48"></span></p><p>There are a number of tests that you should perform before saving a new / modified security configuration:</p><ul><li>Enter your own username &amp; password to validate that you will still be able to login after the security settings have been applied =&gt; <em>You do not want to lock yourself out</em></li><li>Ideally get a couple of other users to try their username &amp; password to ensure that other users can login. If you cannot get other users to come to your computer, you can at least verify that Jenkins can resolve their accounts by using their username and an empty password =&gt; <em>You do not want to lock legitimate users out</em></li><li>In most cases, you will be using LDAP groups, so ensure that you verify reverse group lookup by testing with a user account that is a member of at least one group (do not forget the empty password trick to perform lookup). If there are important groups for your Jenkins instance, try using at least one user for each important group =&gt; You want to ensure that group lookup functions correctly.</li></ul><p><img class="emoticon emoticon-warning" src="images/icons/emoticons/warning.svg" data-emoticon-name="warning" alt="(warning)"/> <strong>NOTE</strong> it is quite likely that existing installations may have subtle issues with group resolution, it is recommended that you validate your group resolution with the new button functionality after upgrading the LDAP plugin to 1.15 as there is a good chance that it will catch problems you didn't really know you had!</p><h3 id="LDAPPlugin-RootDN">Root DN</h3><p>For authenticating user and determining the roles given to this user, Jenkins performs multiple LDAP queries.</p><p>Since an LDAP database is conceptually a big tree and the search is performed recursively, in theory if we can start a search starting at a sub-node (as opposed to root), you get a better performance because it narrows down the scope of a search.</p><p>This field specifies the DN of such a subtree.</p><p>But in practice, LDAP servers maintain an extensive index over the data, so specifying this field is rarely necessary — you should just let Jenkins figure this out by talking to LDAP.</p><p>If you do specify this value, the field normally looks something like <code>dc=acme,dc=org</code></p><h3 id="LDAPPlugin-Usersearchbase">User search base</h3><p>One of the searches Jenkins does on LDAP is to locate the user record given the user name.</p><p>If you specify a relative DN (from the root DN) here, Jenkins will further narrow down searches to the sub-tree.</p><p>But in practice, LDAP servers maintain an extensive index over the data, so specifying this field is rarely necessary.</p><p>If you do specify this value, the field normally looks something like <code>ou=people</code></p><h3 id="LDAPPlugin-Usersearchfilter">User search filter</h3><p>One of the searches Jenkins does on LDAP is to locate the user record given the user name.</p><p> This field determines the query to be run to identify the user record.</p><p>The query is almost always <code>uid={0</code>} as per defined in RFC 2798, so in most cases you should leave this field empty and let this default kick in.</p><p>If your LDAP server doesn't have <code>uid</code> or doesn't use a meaningful <code>uid</code> value, try <code>mail={0</code>}, which lets people login by their e-mail address.</p><p>If you do specify a different query, specify an LDAP query string with marker token {<code>0</code>}, which is to be replaced by the user name string entered by the user.</p><h3 id="LDAPPlugin-Groupsearchbase">Group search base</h3><p>One of the searches Jenkins does on LDAP is to locate the list of groups for a user.</p><p>This field determines the query to be run to identify the organizational unit that contains groups.</p><p>The query is almost always <code>ou=groups</code> so try that first, though this field may be left blank to search from the root DN.</p><p>If login attempts result in &quot;Administrative Limit Exceeded&quot; or similar error, try to make this setting as specific as possible for your LDAP structure, to reduce the scope of the query.</p><p>If the error persists, you may need to change the Group membership filter from the default of <code>(| (member={0}) (uniqueMember={0}) (memberUid={1}))</code> to a query only of the field used in your LDAP for group membership, such as: <code>(member={0})</code>.</p><p>You will need to login and logout in order to verify that your group membership is retained with a modified group membership filter.</p><h3 id="LDAPPlugin-Groupsearchfilter">Group search filter</h3><p>When Jenkins is asked to determine if a named group exists, it uses a default filter of:<br/> <code>(&amp; (cn={0}) (| (objectclass=groupOfNames) (objectclass=groupOfUniqueNames) (objectclass=posixGroup)))</code></p><p>relative to the Group search base to determine if there is a group with the specified name ({<code>0</code>} is substituted by the name being searched for.)</p><p>If you know your LDAP server only stores group information in one specific object class, then you can improve group search performance by restricting the filter to just the required object class.</p><p>Note: if you are using the LDAP security realm to connect to Active Directory (as opposed to using the Active Directory plugin's security realm) then you will need to change this filter to:<br/> <code>(&amp; (cn={0}) (objectclass=group) )</code></p><p>Note: if you leave this empty, the default search filter will be used.</p><h3 id="LDAPPlugin-Groupmembership">Group membership</h3><p>When Jenkins resolves a user, the next step in the resolution process is to determine the LDAP groups that the user belongs to.</p><p>There is an extension point for providing a strategy to resolve the LDAP groups that the user belongs to. There are two implementations provided in the LDAP plugin:</p><ul><li>Search for groups containing user (default)</li><li>Parse user attribute for list of groups</li></ul><h4 id="LDAPPlugin-Searchforgroupscontaininguser">Search for groups containing user</h4><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/65143077/73596983.png" data-image-src="attachments/65143077/73596983.png" data-unresolved-comment-count="0" data-linked-resource-id="73596983" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2014-07-15 at 10.19.23.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="65143077" data-linked-resource-container-version="48"></span></p><p>The group membership filter field controls the search filter that is used to determine group membership.</p><p>If left blank, the default filter will be used. The default default filter is: <code>(| (member={0}) (uniqueMember={0}) (memberUid={1}))</code>. Irrespective of what the default is, setting this filter to a non-blank value will determine the filter used.</p><p>You are normally safe leaving this field unchanged, however for large LDAP servers where you are seeing messages such as &quot;OperationNotSupportedException - Function Not Implemented&quot;, &quot;Administrative Limit Exceeded&quot; or similar periodically when trying to login, then that would indicate that you should change to a more optimum filter for your LDAP server, namely one that queries only the required field, such as: <code>(member={0})</code></p><p>The LDAP server may be able to use query hints to optimize the search. For example:</p><ul><li>If all the groups you are interested in are within a specific subtree, adding the subtree information to the filter should improve performance.</li></ul><ul><li>Active Directory's query optimizer can make significant optimizations if it knows that the object category is group: <code>(&amp;(objectCategory=group)(member={0}))</code> this may be relevant if using Active Directory's matching rule in chain extension, e.g. <code>(&amp;(objectCategory=group)(member:1.2.840.113556.1.4.1941:={0}))</code></li></ul><p>Note: in this field there are two available substitutions:<br/> {<code>0</code>} - the fully qualified DN of the user<br/> {<code>1</code>} - the username portion of the user</p><h4 id="LDAPPlugin-Parseuserattributeforlistofgroups">Parse user attribute for list of groups</h4><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/65143077/73596984.png" data-image-src="attachments/65143077/73596984.png" data-unresolved-comment-count="0" data-linked-resource-id="73596984" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2014-07-15 at 10.19.14.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="65143077" data-linked-resource-container-version="48"></span><br/> Some LDAP servers can provide a <code>memberOf</code> attribute within the User's record:</p><ul><li>Active Directory</li><li>OpenLDAP with the <a href="http://www.openldap.org/doc/admin24/overlays.html#Reverse Group Membership Maintenance" class="external-link" rel="nofollow">memberof overlay</a> active (untested, and as memberof is an operational attribute in OpenLDAP it must be explicitly requested, so likely some hacking of LDAPSecurityRealm.groovy required)</li><li>(If you know of others please provide details here)</li></ul><p>This attribute can be used to simplify the group search and return the group membership immediately without a second LDAP query. Note, however, that this may result in only direct group membership being supported.</p><p>The <code>group membership attribute field</code> controls the attribute name that is used to determine the groups to which a user belongs.</p><h3 id="LDAPPlugin-ManagerDNandManagerPassword">Manager DN and Manager Password</h3><p>If your LDAP server doesn't support anonymous binding (IOW, if your LDAP server doesn't even allow a query without authentication), then Jenkins would have to first authenticate itself against the LDAP server, and Jenkins does that by sending &quot;manager&quot; DN and password.</p><p>A DN typically looks like <code>CN=MyUser,CN=Users,DC=mydomain,DC=com</code> although the exact sequence of tokens depends on the LDAP server configuration.</p><p>It can be any valid DN as long as LDAP allows this user to query data.</p><p>This configuration is also useful when you are connecting to Active Directory from a Unix machine, as AD doesn't allow anonymous bind by default. But if you can't figure this out, you can also change AD setting to allow anonymous bind. </p><h3 id="LDAPPlugin-DisableLDAPEmailresolver">Disable LDAP Email resolver</h3><p>Controls whether LDAP will be used to try and resolve the email addresses of users.</p><h3 id="LDAPPlugin-Enablecache">Enable cache</h3><p>Some LDAP servers may be slow, or rate limit client requests.</p><p>In such cases enabling caching may improve performance of Jenkins with the risk of delayed propagation of user changes from LDAP and increased memory usage on the master.</p><p>Note: The default configuration is to leave the cache turned off.</p><h3 id="LDAPPlugin-EnvironmentProperties">Environment Properties</h3><p>As of 1.7 of the LDAP plugin, you can now specify additional Environment Properties to provide the backing Java LDAP client API. See <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/jndi/jndi-ldap.html" class="external-link" rel="nofollow">Oracle's documentation</a> for details of what properties are available and what functionality they provide. As a minimum you should strongly consider providing the following</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property Name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><span style="color: rgb(68,68,68);"><code><strong>com.sun.jndi.ldap.connect.timeout</strong></code></span></p></td><td class="confluenceTd"><p>This is the socket connection timeout in milliseconds. If your LDAP servers are all close to your Jenkins server you can probably set a small value, e.g. 5000 milliseconds. Setting a value smaller that this may result in excessive timeouts due to the TCP/IP connection establishment retry mechanism.</p></td></tr><tr><td class="confluenceTd"><p><code><strong>com.sun.jndi.ldap.read.timeout</strong></code></p></td><td class="confluenceTd"><p>This is the socket read timeout in milliseconds. If your LDAP queries are all fast you can probably set a low value. The value is ignored if the Jenkins Master is running on Java 1.5. A reasonable default is 60000 milliseconds.</p></td></tr></tbody></table></div><h2 id="LDAPPlugin-Troubleshooting">Troubleshooting</h2><p>The following <a href="https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+Script+Console" class="external-link" rel="nofollow">Groovy script</a> can be useful when trying to determine whether you have group search configured correctly:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">    String[] names = [&quot;a group name&quot;,&quot;a user name&quot;,&quot;a name that does not exist&quot;];
    for (name in names) {
      println(&quot;Checking the name &#39;&quot; + name + &quot;&#39;...&quot;)
      try {
        println(&quot;  It is a USER: &quot; + Jenkins.instance.securityRealm.loadUserByUsername(name))
        println(&quot;  Has groups/authorities: &quot; + Jenkins.instance.securityRealm.loadUserByUsername(name).getAuthorities())
      } catch (Exception e) {
          try {
            println(&quot;  It is a GROUP: &quot; + Jenkins.instance.securityRealm.loadGroupByGroupname(name))
            println(&quot;&quot;)
            continue
          } catch (Exception e1) {
            println(&quot;  It is NOT a group, reason: &quot; + e1.getMessage())
          }
        println(&quot;  It is NOT a user, reason: &quot; + e.getMessage())
      }
      println(&quot;&quot;);
    }
</pre>
</div></div><ul><li>If login attempts result in &quot;OperationNotSupportedException - Function Not Implemented&quot;, &quot;Administrative Limit Exceeded&quot; or similar error, the LDAP query to determine the group membership for the user may be triggering this. First try setting the &quot;Group search base&quot; setting as specific as possible for your LDAP structure, to reduce the scope of the query. If the error persists, you may need to edit the <code>WEB-INF/security/LDAPBindSecurityRealm.groovy</code> file that is included in <code>jenkins.war</code>. Change the line with <code>groupSearchFilter = &quot;(| (member={0}) (uniqueMember={0}) (memberUid={1}))&quot;;</code> to query only of the field used in your LDAP for group membership, such as <code>groupSearchFilter = &quot;(member={0})&quot;;</code> (then restart Jenkins).</li><li>The LDAP groups were available in Jenkins in the format of ROLE_Uppercasedgroupname, so the developers ldap group would be ROLE_Developers in Jenkins, but since 1.404 they are available as is: no prefix or upper casing,</li><li>Since Jenkins 1.468, this has been moved to a plugin. The <code>LDAPBindSecurityRealm.groovy</code> file is therefore part of the <code>ldap.jpi</code> file. You can find the default template at <code>$JENKINS_HOME/plugins/ldap/WEB-INF/classes/hudson/security/LDAPBindSecurityRealm.groovy</code>. That file will be recreated from the <code>ldap.jpi</code> file every time Jenkins starts, so if you need to override the defaults, the correct way is to just copy the template file to <code>$JENKINS_HOME/LDAPBindSecurityRealm.groovy</code>. The <code>$JENKINS_HOME/LDAPBindSecurityRealm.groovy</code> file is re-read every time the security components are reconfigured, so it should just be a case of re-saving the security configuration to force the file to be re-read.</li><li>If you are using this plugin and not the <a href="Active-Directory-plugin.html">Active Directory plugin</a> to connect to Active Directory, you will need to change the Group Search Filter to filter to: <code>(&amp; (cn={0}) (objectclass=group) )</code> and change the Group Membership Filter to: <code>(member={0})</code>. If you want AD to return nested group membership then change the Group Membership Filter to: <code>(member:1.2.840.113556.1.4.1941:={0})</code></li></ul><h2 id="LDAPPlugin-PerformanceTuning">Performance Tuning</h2><p>Here is a checklist to help improve performance:</p><ul><li>Ensure you are using the very latest version of the LDAP plugin</li><li>Ensure you have enabled caching. Start with the cache size to just greater than your anticipated maximum concurrent users and set the TTL to the longest time interval you are comfortable with... (i.e. how long before a password change gets picked up... in most cases 5 or 10 minutes is a good TTL)</li></ul><p>Those two changes should give you an immediate significant performance boost (even with a TTL of 30s as long as the cache size is larger than max anticipated concurrent users... but a longer TTL is better)</p><ul><li>Next up is to ensure that you have got the correct most specific <code>user search base</code> and <code>group search base</code> defined for your LDAP tree. Getting this right has two side-effects... you get faster results to your queries; and your LDAP server admin people will thank you for reducing the load on their server by a significant amount.</li><li>Finally, you should ensure that you have defined specific queries for the <code>user search filter</code> and <code>group search filter</code>... the user one is usually fine as is... the group one is, by default, a combination of typical queries. A significant performance improvement can be achieved by switching from the default <code>or</code> filter of <code>(&amp; (cn={0}) (| (objectclass=groupOfNames) (objectclass=groupOfUniqueNames) (objectclass=posixGroup)))</code> to the correct for your LDAP tree query, i.e. it would be one of <code>(&amp; (cn={0}) (objectclass=groupOfNames))</code>,<code>(&amp; (cn={0}) (objectclass=groupOfUniqueNames))</code> or <code>(&amp; (cn={0}) (objectclass=posixGroup))</code>. (...and if it is not one of them then your LDAP server is most likely Active Directory and Kohsuke makes me ask why you are using the LDAP plugin and not the Active Directory plugin in that case! Note that <a href="https://issues.jenkins-ci.org/browse/JENKINS-16429" class="external-link" rel="nofollow">JENKINS-16429</a> might be a good reason to favour the LDAP plugin over the Active Directory plugin, but if that issue is resolved by the time you are reading this then there should be no reason to pick the LDAP plugin over the Active Directory plugin)</li></ul><h3 id="LDAPPlugin-TipsandTricks">Tips and Tricks</h3><p>If you are using the LDAP plugin to connect to Active Directory you should probably read this page of <a href="http://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx" class="external-link" rel="nofollow">AD syntax notes</a>. Pay special attention to Notes 10 and 19. The following settings are reported to work with Active Directory and nested groups, though they should carry a warning that they may impact login performance and they have not been tested for completeness:</p><ul><li>User search filter: <code>sAMAccountName={0</code>}</li><li>Group search filter: <code>(&amp;(objectclass=group)(cn={0}))</code></li><li>Group membership, one of<ul><li><em>Search for groups containing user</em> (if nested group membership required)<ul><li>Group membership filter: <code>(&amp;(objectCategory=group)(member:1.2.840.113556.1.4.1941:={0}))</code></li></ul></li><li><em>Parse user attribute for list of groups</em> (if nested group membership not required this will be faster)<ul><li> Group membership attribute: <code>memberOf</code></li></ul></li></ul></li></ul><h2 id="LDAPPlugin-VersionHistory">Version History</h2><h3 id="LDAPPlugin-Version1.20(19thFeb2018)">Version 1.20 (19th Feb 2018)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-48917" class="external-link" rel="nofollow">JENKINS-48917</a>: Add option to ignore specific LDAP domains in the event of a connection failure.</li><li>Add compatibility warning when upgrading from 1.15 or older due to configuration format changes in 1.16.</li></ul><h3 id="LDAPPlugin-Version1.19(31stJan2018)">Version 1.19 (31st Jan 2018)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-21784" class="external-link" rel="nofollow">JENKINS-21784</a>: Add support for querying membership of LDAP groups.</li><li>Log communication failures with LDAP servers as warnings in the <code>hudson.security.LDAPSecurityRealm</code> logger.</li></ul><h3 id="LDAPPlugin-Version1.18(9thNov2017)">Version 1.18 (9th Nov 2017)</h3><ul><li>Upgrade to <a href="https://github.com/jenkinsci/plugin-pom" class="external-link" rel="nofollow">new parent pom</a> (2.36).</li><li><span style="color: rgb(0,0,0);">Update test text to match UI</span></li><li>Updated baseline version of Jenkins to 1.651.3</li></ul><h3 id="LDAPPlugin-Version1.17(13thSep2017)">Version 1.17 (13th Sep 2017)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-45431" class="external-link" rel="nofollow">JENKINS-45431</a> Environment properties stopped working in 1.16</li></ul><h3 id="LDAPPlugin-Version1.16(3rdJuly2017)">Version 1.16 (3rd July 2017)</h3><ul><li><strong><a href="https://issues.jenkins-ci.org/browse/JENKINS-21475" class="external-link" rel="nofollow">JENKINS-21475</a> Added ability to configure multiple LDAP configurations to connect to LDAP servers with <strong>different schemes etc.</strong></strong></li><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-43994" class="external-link" rel="nofollow">JENKINS-43994</a> <span>When the user can login but lookup fails report this as a potential issue for API tokens and SSH key base authentication of the user.</span></li></ul><h3 id="LDAPPlugin-Version1.15(2ndMay2017)">Version 1.15 (2nd May 2017)</h3><ul><li>Updated baseline version of Jenkins to 1.625.3</li><li>Added some tests that actually connect to an LDAP server to help prevent regressions</li><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-21374" class="external-link" rel="nofollow">JENKINS-21374</a> Allow disabling ROLE_ prefixed role creation</li><li><strong><a href="https://issues.jenkins-ci.org/browse/JENKINS-43388" class="external-link" rel="nofollow">JENKINS-43388</a> Added a validation button that allows for validation of the complete LDAP configuration</strong><ul><li>Fixed a bug in authorities population identified by the new validation button</li></ul></li></ul><h3 id="LDAPPlugin-Version1.14(23rdJan2017)">Version 1.14 (23rd Jan 2017)</h3><ul><li>Fixed <a href="https://issues.jenkins-ci.org/browse/JENKINS-30588" class="external-link" rel="nofollow">JENKINS-30588</a>: Value for &quot;Group membership attribute&quot; not saved.</li></ul><h3 id="LDAPPlugin-Version1.13(20thSep2016)">Version 1.13 (20th Sep 2016)</h3><ul><li>Fixed <a href="https://issues.jenkins-ci.org/browse/JENKINS-8152" class="external-link" rel="nofollow">JENKINS-8152</a>: The rootDN is now URI-encoded when included in the provider URL. If upgrading from previous versions, please take this into account if the value had been manually encoded.</li></ul><h3 id="LDAPPlugin-Version1.12(26thApr2016)">Version 1.12 (26th Apr 2016)</h3><ul><li>Upgrade to <a href="https://github.com/jenkinsci/plugin-pom" class="external-link" rel="nofollow">new parent pom</a>.</li><li>Integrate Findbugs and fix potential errors discovered by the plugin.</li></ul><h3 id="LDAPPlugin-Version1.11(3rdOct2014)">Version 1.11 (3rd Oct 2014)</h3><ul><li>Performance improvements especially in the presence of lots of requests with HTTP basic auth.</li></ul><h3 id="LDAPPlugin-Version1.10.2(23rdMay2014)">Version 1.10.2 (23rd May 2014)</h3><ul><li>Fixed another NPE in FromUserRecordLDAPGroupMembershipStrategy</li></ul><h3 id="LDAPPlugin-Version1.10.1(23rdMay2014)">Version 1.10.1 (23rd May 2014)</h3><ul><li>Fixed NPE in FromUserRecordLDAPGroupMembershipStrategy.</li></ul><h3 id="LDAPPlugin-Version1.10(22ndMay2014)">Version 1.10 (22nd May 2014)</h3><ul><li>Turned the group membership lookup into a strategy. There are now two strategies, the default &quot;look up groups containing the user&quot; strategy and an experimental new strategy which looks for an attribute in the user's LDAP record that contains a list of DNs of the groups that the user belongs to. <span style="color: rgb(153,51,0);"><strong>Rumour has it that this second strategy may actually provide faster performance for Active Directory, but as the person who wrote this code does not have an Active Directory instance to test against - until some kind soul tests, confirms and edits this text to remove the assertion that this is a rumour - using the new strategy is</strong></span> <span style="color: rgb(153,51,0);"><strong><em>Caveat emptor</em></strong></span><span style="color: rgb(153,51,0);"><strong>.</strong></span></li></ul><p><span style="color: rgb(153,51,0);"><strong>[Update 23/05/2014] Some kind testers have confirmed that the new strategy seems to work against Active Directory... but as those testers did not have performance issues to start with, again it is just a rumour that there is a performance increase! Version 1.10.2 is recommended to fix two non-critical but annoying NPEs with the new strategy</strong></span></p><h3 id="LDAPPlugin-Version1.9(9thMay2014)">Version 1.9 (9th May 2014)</h3><ul><li><p>Added some interim hacks to work around <a href="https://issues.jenkins-ci.org/browse/JENKINS-22247" class="external-link" rel="nofollow">JENKINS-22247</a>. Setting the temporary system properties </p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>hudson.security.LDAPSecurityRealm.forceUsernameLowercase=true
</pre>
</div></div><p>and </p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>hudson.security.LDAPSecurityRealm.forceGroupnameLowercase=true
</pre>
</div></div><p>will enable these hacks. These system properties will be removed in a future version once the core issue has been resolved.</p></li><li>Modernised the configuration screen Jelly to use current form-binding.</li><li>The manager password is now correctly encrypted using Secret. This is a downgrade breaking change. <span style="color: rgb(255,0,0);"><strong>WARNING! If you upgrade to 1.9 and then downgrade, the manager password may be lost from your configuration. </strong></span></li></ul><h3 id="LDAPPlugin-Version1.8(17thJan2014)">Version 1.8 (17th Jan 2014)</h3><ul><li>Fixed <a href="https://issues.jenkins-ci.org/browse/JENKINS-18355" class="external-link" rel="nofollow">JENKINS-18355</a></li></ul><h3 id="LDAPPlugin-Version1.7(9thDec2013)">Version 1.7 (9th Dec 2013)</h3><ul><li>Fixed <a href="https://issues.jenkins-ci.org/browse/JENKINS-16443" class="external-link" rel="nofollow">JENKINS-16443</a></li><li>Add ability to define LDAP environment properties.</li></ul><h3 id="LDAPPlugin-Version1.6(24thJul2013)">Version 1.6 (24th Jul 2013)</h3><ul><li>Add support for multiple servers.</li></ul><h3 id="LDAPPlugin-Version1.5(14thJun2013)">Version 1.5 (14th Jun 2013)</h3><ul><li>Add readme.</li><li>Fixed <a href="https://issues.jenkins-ci.org/browse/JENKINS-17281" class="external-link" rel="nofollow">JENKINS-17281</a></li></ul><h3 id="LDAPPlugin-Version1.4(24thApr2013)">Version 1.4 (24th Apr 2013)</h3><ul><li>Move userDetails caching into the user details service to avoid callers bypassing the cache.</li></ul><h3 id="LDAPPlugin-Version1.3(24thApr2013)">Version 1.3 (24th Apr 2013)</h3><ul><li>Add Chinese (traditional) translation.</li><li>Update .gitignore.</li><li>Add an optional caching mechanism for loadByUsername and loadGroupByGroupName.</li></ul><h3 id="LDAPPlugin-Version1.2(6thDev2012)">Version 1.2 (6th Dev 2012)</h3><ul><li>Added .gitignore.</li><li>Update Surefire version.</li><li>Add &quot;Disable Ldap Mail Resolver&quot; checkbox/functionality.</li></ul><h3 id="LDAPPlugin-Version1.1(11thJun2012)">Version 1.1 (11th Jun 2012)</h3><ul><li>Explicitly set the classloader so that classes in the plugin do not fail to resolve.</li><li>Complete pom.xml.</li></ul><h3 id="LDAPPlugin-Version1.0(6thJun2012)">Version 1.0 (6th Jun 2012)</h3><ul><li>Initial release.</li></ul>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/67895383.png">Screen Shot 2013-06-14 at 16.42.14.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/71008315.png">Screen Shot 2013-12-09 at 12.23.23.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/72613937.png">Screen Shot 2014-04-04 at 09.16.33.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/73596982.png">Screen Shot 2014-07-15 at 10.18.48.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/73596983.png">Screen Shot 2014-07-15 at 10.19.23.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/73596984.png">Screen Shot 2014-07-15 at 10.19.14.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/118063707.png">Screen Shot 2017-05-02 at 09.52.20.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/118063708.png">test-ldap-dialog.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/65143077/138444851.jpg">111.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:31</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
