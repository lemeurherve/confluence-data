<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : MSTest Coverage Reports</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                    <li>
                                <span><a href="MSBuild-Plugin.html">MSBuild Plugin</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : MSTest Coverage Reports
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (packadal)</span>, last modified on Oct 28, 2009
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="MSTestCoverageReports-MSTestCoverage">MSTest Coverage</h1>

<p>MSTests can compute Code Coverage Statistics, but its only output is in binary form. To be able to generate reports, this binary must be transformed to XML. Thankfully, Microsoft provides an interface to do just so, and someone created a MSBuild task for this : <strong><a href="http://code.msdn.microsoft.com/vscoveragetoxmltask" title="MSBuild Coverage to XML Task" class="external-link" rel="nofollow">http://code.msdn.microsoft.com/vscoveragetoxmltask</a></strong></p>

<p>This MSBuild tasks creates a xml report that can now be exploited to create a nice Coverage Report.</p>

<p>In order to avoid writing a new hudson plugin from scratch, a XSL Transformation was devised that transformed MSTest's Coverage report into a Emma Coverage report, so the Emma hudson plug-in can display the reports.</p>

<p>The said XSL in attached to this page.</p>

<p>You have to run the XSLT yourself for now (an MSBuild Exec task can do it, provided you have msxsl at hand) :</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">&lt;Exec Command=&quot;msxsl.exe $(SolutionDir)\$(RunConfig)\In\$(ComputerName)\data.xml $(DevToolsDir)\MSTestCoverageToEmma.xsl -o $(SolutionDir)\coverage.xml&quot; /&gt;</pre>
</div></div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/41878013/41975838.xsl">MSTestCoverageToEmma.xsl</a> (text/xml)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:34</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
