<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Split plugin from core</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Extend-Jenkins.html">Extend Jenkins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Split plugin from core
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (batmat)</span>, last modified by <span class='editor'> Unknown User (jglick)</span> on Nov 15, 2017
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 id="Splitpluginfromcore-Presentation">Presentation</h2><p>See <a href="https://youtu.be/vGJtbgghYO8?t=8m" class="external-link" rel="nofollow">this walk-through</a> by <a class="confluence-userlink user-mention" data-username="jglick" href="https://wiki.jenkins.io/display/~jglick" data-linked-resource-id="21233667" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://wiki.jenkins.io">Unknown User (jglick)</a> in Sep 2017.</p><h2 id="Splitpluginfromcore-Goalofthisdoc">Goal of this doc</h2><p>Jenkins has a plugin architecture. For historical reasons, some features were developed inside the Jenkins codebase itself (i.e. not as plugins).</p><p>To keep that core codebase more manageable, there is an ongoing effort to extract some of the existing features into dedicated plugins.</p><h2 id="Splitpluginfromcore-Generalprocesstoextractclasses">General process to extract classes</h2><ul><li>Locate everything that should be moved.<ul><li>Do not forget to look in <code>core/src/main/resources/</code> for associated resources.<ul><li>(<code>Messages.properties</code> shared with other classes in the same package can be a headache: you need to create a new Messages in a novel package.)</li></ul></li><li>And look for relevant functional tests in <code>test/src/test/</code>.</li><li>And icons.</li><li>And double-check that you have really found everything relevant:<ul><li><code>git ls-files | grep -F SOMETHING</code> for filenames and</li><li><code>git ls-files | xargs grep -l SOMETHING</code> for contents.</li></ul></li></ul></li></ul><ul><li>Try temporarily deleting all the classes you propose to split, and do a clean build to verify that there are not unwanted usages from elsewhere in core. If there are, you have some refactoring ahead of you, and this is where it gets hairy.</li><li>Split the code into a new repository with history intact. git-filter-branch can work, though it is not easy to use; IIRC KK had some script expressly for this purpose but I can never find it when I need it. If possible, make sure translated commits mention the original commit hash.</li><li>Do a 1.0 release of the new plugin, with the baseline set to the last weekly prior to your split. Ideally you would actually use the <code>-SNAPSHOT</code> version from the current core but Maven release rules will forbid this.</li><li>Create a core patch to:<ul><li>delete the split files</li><li>bundle in `war/pom.xml`</li><li>list in `ClassicPluginStrategy.DETACHED_LIST`</li></ul></li><li>After a new weekly is produced using the above changes, update the baseline in the new plugin to that and cut a 1.1 (or 1.0.1). This ensures it is only offered to users who do not still have that functionality in core. Assuming the UC is configured properly.</li><li>Pat yourself on the back: Jenkins sources are a little more manageable than they were yesterday.</li></ul>
                    </div>

                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:09</p>
                    <div id="footer-logo"><a href="/display/">Wiki home</a></div>
                </section>
            </div>
        </div>     </body>
</html>
