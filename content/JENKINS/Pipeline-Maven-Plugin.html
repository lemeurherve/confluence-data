<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Pipeline Maven Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Pipeline Maven Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (alobato)</span>, last modified by <span class='editor'> Unknown User (cleclerc)</span> on Aug 16, 2019
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View Pipeline Maven Integration <a href="https://plugins.jenkins.io/pipeline-maven" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>

<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Older versions of this plugin may not be safe to use. Please review the following warnings before using an older version:</p>

<ul>
	<li><a href="https://jenkins.io/security/advisory/2019-05-31/#SECURITY-1409" class="external-link" rel="nofollow">XML External Entity processing vulnerability</a></li>
	<li><a href="https://jenkins.io/security/advisory/2020-08-12/#SECURITY-1794%20(2)" class="external-link" rel="nofollow">CSRF vulnerability and missing permission check allow capturing credentials</a></li>
	<li><a href="https://www.jenkins.io/security/advisory/2020-09-16/#SECURITY-1976" class="external-link" rel="nofollow">Stored XSS vulnerability in upstream cause</a></li>
	<li><a href="https://jenkins.io/security/advisory/2020-08-12/#SECURITY-1794%20(1)" class="external-link" rel="nofollow">Missing permission check allows enumerating credentials IDs</a></li>
	<li><a href="https://jenkins.io/security/advisory/2017-03-09/" class="external-link" rel="nofollow">Arbitrary files from Jenkins controller available in Pipeline by using the withMaven step</a></li>
</ul>

</div></div>
<p><br/></p><h1 id="PipelineMavenPlugin-Introduction">Introduction</h1>Provides Maven integration with <a href="https://wiki.jenkins-ci.org/display/JENKINS/Pipeline+Plugin" class="external-link" rel="nofollow">Pipeline Plugin</a> by using the withMaven step, which configures a maven environment to use within a pipeline job by calling sh mvn or bat mvn.<p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1631021917174 {padding: 0px;}
div.rbtoc1631021917174 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1631021917174 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1631021917174'>
<ul class='toc-indentation'>
<li><a href='#PipelineMavenPlugin-Introduction'>Introduction</a></li>
<li><a href='#PipelineMavenPlugin-Usage'>Usage</a></li>
<li><a href='#PipelineMavenPlugin-Features'>Features</a>
<ul class='toc-indentation'>
<li><a href='#PipelineMavenPlugin-SensibledefaultMavenparameters'>Sensible default Maven parameters</a></li>
<li><a href='#PipelineMavenPlugin-MavenSettingsSupport'>Maven Settings Support</a></li>
<li><a href='#PipelineMavenPlugin-TraceabilityofMavenbuilds'>Traceability of Maven builds</a></li>
<li><a href='#PipelineMavenPlugin-ReportPublishers'>Report Publishers</a>
<ul class='toc-indentation'>
<li><a href='#PipelineMavenPlugin-ImplicitorExplicitactivationofPublishers'>Implicit or Explicit activation of Publishers</a></li>
</ul>
</li>
<li><a href='#PipelineMavenPlugin-DefaultConfiguration'>Default Configuration</a>
<ul class='toc-indentation'>
<li><a href='#PipelineMavenPlugin-GlobalDefaultConfiguration'>Global Default Configuration</a></li>
<li><a href='#PipelineMavenPlugin-FolderLevelConfiguration'>Folder Level Configuration</a></li>
</ul>
</li>
<li><a href='#PipelineMavenPlugin-Triggerdownstreampipelinewhenasnapshotisbuilt(since3.0.0)'>Trigger downstream pipeline when a snapshot is built (since 3.0.0)</a></li>
<li><a href='#PipelineMavenPlugin-Linux,WindowsandMacOSXsupport'>Linux, Windows and MacOSX support</a></li>
<li><a href='#PipelineMavenPlugin-SupportofTakari&#39;sMavenWrapper&#39;mvnw&#39;(since3.0.3)'>Support of Takari&#39;s Maven Wrapper &#39;mvnw&#39; (since 3.0.3)</a></li>
</ul>
</li>
<li><a href='#PipelineMavenPlugin-AddingmoreMavenReporters'>Adding more Maven Reporters</a></li>
<li><a href='#PipelineMavenPlugin-Setup'>Setup</a>
<ul class='toc-indentation'>
<li><a href='#PipelineMavenPlugin-UsingaMySQLDatabase(since3.6.0)'>Using a MySQL Database (since 3.6.0)</a></li>
<li><a href='#PipelineMavenPlugin-UsingaPostgreSQLDatabase(since3.7.0)'>Using a PostgreSQL Database (since 3.7.0)</a></li>
</ul>
</li>
<li><a href='#PipelineMavenPlugin-FAQ'>FAQ</a>
<ul class='toc-indentation'>
<li><a href='#PipelineMavenPlugin-HowtousethePipelineMavenPluginwithDocker?(sinceversion3.0.3)'>How to use the Pipeline Maven Plugin with Docker? (since version 3.0.3)</a>
<ul class='toc-indentation'>
<li><a href='#PipelineMavenPlugin-Using&quot;withMaven&quot;with&quot;docker.image(...).inside{...}&quot;andaJenkinsScriptedPipeline'>Using &quot;withMaven&quot; with &quot;docker.image(...).inside{...}&quot; and a Jenkins Scripted Pipeline </a></li>
<li><a href='#PipelineMavenPlugin-Using&quot;withMaven&quot;with&quot;docker.image(...).inside{...}&quot;toaJenkinsDeclarativePipeline'>Using &quot;withMaven&quot; with &quot;docker.image(...).inside{...}&quot; to a Jenkins Declarative Pipeline </a></li>
<li><a href='#PipelineMavenPlugin-SamplemessagedisplayedinthebuildlogswhenusingwithMaveninaDockerPipelineexecutionenvironment'>Sample message displayed in the build logs when using withMaven in a Docker Pipeline execution environment</a></li>
</ul>
</li>
<li><a href='#PipelineMavenPlugin-HowtodisabletheMavenEventSpyinjectedbythePipelineMavenPlugininMavenbuilds?'>How to disable the Maven Event Spy injected by the Pipeline Maven Plugin in Maven builds?</a></li>
<li><a href='#PipelineMavenPlugin-WhydoIseemessages&quot;[WARNING]PickedupJAVA_TOOL_OPTIONS...&quot;inthebuildlogs?'>Why do I see messages &quot;[WARNING] Picked up JAVA_TOOL_OPTIONS...&quot; in the build logs?</a></li>
<li><a href='#PipelineMavenPlugin-Mydownstreampipelinesdon&#39;tgettriggeredevenifIuse&quot;BuildwheneveraSNAPSHOTdependencyisbuilt&quot;'>My downstream pipelines don&#39;t get triggered even if I use &quot;Build whenever a SNAPSHOT dependency is built&quot;</a></li>
<li><a href='#PipelineMavenPlugin-HowcanItroubleshootproblemsoftriggerofdownstreampipelines'>How can I troubleshoot problems of trigger of downstream pipelines</a></li>
<li><a href='#PipelineMavenPlugin-HowdoIcapturethelogfilegeneratedbytheJenkinsMavenEventSpy'>How do I capture the log file generated by the Jenkins Maven Event Spy</a></li>
<li><a href='#PipelineMavenPlugin-HowdoIchecktheMavensettingsinusebymybuild'>How do I check the Maven settings in use by my build</a></li>
<li><a href='#PipelineMavenPlugin-HowcanIreducethefootprintofthedatabaseoftheJenkinsPipelineMavenPlugin?'>How can I reduce the footprint of the database of the Jenkins Pipeline Maven Plugin?</a></li>
<li><a href='#PipelineMavenPlugin-WhydoIseemessages&quot;[withMaven]OneormultipleMavenexecutionshavebeenignored...&quot;inthebuildlogs?'>Why do I see messages &quot;[withMaven] One or multiple Maven executions have been ignored...&quot; in the build logs?</a></li>
<li><a href='#PipelineMavenPlugin-WhydoIseemessages&quot;javax.xml.parsers.FactoryConfigurationError:Providerforclassjavax.xml.parsers.DocumentBuilderFactorycannotbecreated&quot;'>Why do I see messages &quot;javax.xml.parsers.FactoryConfigurationError: Provider for class javax.xml.parsers.DocumentBuilderFactory cannot be created&quot;</a></li>
<li><a href='#PipelineMavenPlugin-HowtouseMavenbuilddataingeneratedemails'>How to use Maven build data in generated emails</a></li>
</ul>
</li>
<li><a href='#PipelineMavenPlugin-KnownLimitations'>Known Limitations</a>
<ul class='toc-indentation'>
<li><a href='#PipelineMavenPlugin-MavenandJDKinstallationnotsupportedindocker.image(&#39;xxx&#39;).inside{...}'>Maven and JDK installation not supported in docker.image(&#39;xxx&#39;).inside{...}</a></li>
<li><a href='#PipelineMavenPlugin-withMaven()notsupportedin&quot;docker.image(&#39;xxx&#39;).inside{...}&quot;witholdversionsoftheDockerengine'>withMaven() not supported in &quot;docker.image(&#39;xxx&#39;).inside{...}&quot; with old versions of the Docker engine</a></li>
</ul>
</li>
<li><a href='#PipelineMavenPlugin-Changelog'>Changelog</a></li>
</ul>
</div></p><h1 id="PipelineMavenPlugin-Usage">Usage</h1><p>An example pipeline script using the pipeline Maven plugin:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Maven build on a Linux agent</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">node{
  stage (&#39;Build&#39;) {

    git url: &#39;https://github.com/cyrille-leclerc/multi-module-maven-project&#39;

    withMaven(
        // Maven installation declared in the Jenkins &quot;Global Tool Configuration&quot;
        maven: &#39;maven-3&#39;,
        // Maven settings.xml file defined with the Jenkins Config File Provider Plugin
        // We recommend to define Maven settings.xml globally at the folder level using 
        // navigating to the folder configuration in the section &quot;Pipeline Maven Configuration / Override global Maven configuration&quot;
        // or globally to the entire master navigating to  &quot;Manage Jenkins / Global Tools Configuration&quot;
        mavenSettingsConfig: &#39;my-maven-settings&#39;) {

      // Run the maven build
      sh &quot;mvn clean verify&quot;

    } // withMaven will discover the generated Maven artifacts, JUnit Surefire &amp; FailSafe &amp; FindBugs &amp; SpotBugs reports...
  }
}
</pre>
</div></div><p>Within a node or a docker.image block, create a withMaven block to setup a with maven environment. The configured environment will be used when calling maven inside the block by using <code>sh mvn</code> or <code>bat mvn</code>. The following parameters can be used to configure maven:</p><ul><li><strong>Maven</strong> (<code>maven</code>): Allow the selection of a Maven installation configured on the Global Jenkins configuration or on the Global Tool Configuration page if using Jenkins &gt; 2.0. When auto-install is enabled, maven will be downloaded and made available for the pipeline job.</li></ul><ul><li><strong>JDK</strong> (<code>jdk</code>): Allows the selection of a JDK installation. If auto-install is enabled, the JDK will be downloaded and made available for the pipeline job.</li></ul><ul><li><strong>Maven Settings</strong><ul><li><strong>Maven Settings Config</strong> (<code>mavenSettingsConfig</code>): Select a Maven settings file <strong>ID</strong> from <a href="https://wiki.jenkins-ci.org/display/JENKINS/Config+File+Provider+Plugin" class="external-link" rel="nofollow">Config File Provider Plugin</a> allowing the replacement of server credentials and variable substitutions as configured in <a href="https://wiki.jenkins-ci.org/display/JENKINS/Config+File+Provider+Plugin" class="external-link" rel="nofollow">Config File Provider Plugin</a>. The settings element in the <code>settings.xml</code> file contains elements used to define values which configure Maven execution in various ways, like the <code>pom.xml</code>, but should not be bundled to any specific project, or distributed to an audience. See also <a href="http://maven.apache.org/settings.html" class="external-link" rel="nofollow">settings.xml</a> reference</li></ul></li></ul><ul><li style="list-style-type: none;background-image: none;"><ul><li><p><strong>Maven Settings File Path</strong> (<code>mavenSettingsFilePath</code>): Specify the path to a Maven <code>settings.xml</code> file on the build agent. The specified path can be absolute or relative to the workspace. </p></li><li><p>If none of &quot;mavenSettingsConfig&quot; and &quot;<span>mavenSettingsFilePath&quot;</span> are defined, &quot;withMaven(){}&quot; will use the Maven settings defined in the Jenkins Global Tool Configuration if declared</p></li></ul></li></ul><ul><li><p><strong>Maven Global Settings<br/></strong></p><ul><li><p><strong>Maven Global Settings Config</strong> (<code>globalMavenSettingsConfig</code>): Select a Maven global settings file <strong>ID</strong> from <a href="https://wiki.jenkins-ci.org/display/JENKINS/Config+File+Provider+Plugin" class="external-link" rel="nofollow">Config File Provider Plugin</a>.</p></li><li><p><strong>Maven Global Settings File Path</strong> (<code>globalMavenSettingsFilePath</code>): Specify the path to a Maven global <code>settings.xml</code> file on the build agent. The specified path can be absolute or relative to the workspace.</p></li><li><p>If none of &quot;<span>globalMavenSettingsConfig</span>&quot; and &quot;<span>globalMavenSettingsFilePath</span>&quot; are defined, &quot;withMaven(){}&quot; will use the Maven global settings defined in the Jenkins Global Tool Configuration if declared</p></li></ul></li></ul><ul><li><strong>Maven JVM Opts</strong> (<code>mavenOpts</code>): Specify JVM specific options needed when launching Maven as an external process, these are not maven specific options. See: <a href="https://docs.oracle.com/javase/8/docs/technotes/tools/windows/java.html#CBBIJCHG" class="external-link" rel="nofollow">Java Options</a><br/>Shell-like environment variable expansions work in this field, by using the <code>${VARIABLE</code>} syntax.</li></ul><ul><li><strong>Maven Local Repository</strong> (<code>mavenLocalRepo</code>): Specify a custom local repository path. Shell-like environment variable expansions work with this field, by using the <code>${VARIABLE</code>} syntax. Normally, Jenkins uses the local Maven repository as determined by Maven, by default <code>~/.m2/repository</code> and can be overridden by <code>&lt;localRepository&gt;</code> in <code>~/.m2/settings.xml</code> (see Configuring your Local Repository))<br/>This normally means that all the jobs that are executed on the same node shares a single Maven repository. The upside of this is that you can save the disk space, the downside is that the repository is not multi process safe and having multiple builds run concurrently can corrupt it. Additionally builds could interfere with each other by sharing incorrect or partially built artifacts. For example, you might end up having builds incorrectly succeed, just because your have all the dependencies in your local repository, despite that fact that none of the repositories in POM might have them.<br/>By using this option, Jenkins will tell Maven to use a custom path for the build as the local Maven repository by using <code>-Dmaven.repo.local</code><br/>If specified as a relative path then this value will be resolved against the workspace root and not the current working directory.<br/>ie. <code>$WORKSPACE/.repository</code> if <code>.repository</code> value is specified.</li></ul><p><img class="emoticon emoticon-information" src="images/icons/emoticons/information.svg" data-emoticon-name="information" alt="(info)"/> <code>mavenSettingsConfig</code> and <code>globalMavenSettingsConfig</code> use the <strong>ID</strong>, not the <strong>name</strong>, of the Maven settings file (resp Maven Global Settings file).</p><p><em>The Pipeline Syntax snippet code generator can be used to assist on generating the withMaven step parameters</em></p><p>In the above example the following parameters are use to configure maven:</p><ul><li><strong>maven:</strong> 'M3' Maven Installation will be used, this installation has to be declared in the Global Jenkins configuration or Tool installations page.</li><li><strong>mavenLocalRepo:</strong> a local repository folder is specified to avoid shared repositories</li><li><strong>mavenSettingsConfig:</strong> specifies an specific settings.xml configuration from <a href="https://wiki.jenkins-ci.org/display/JENKINS/Config+File+Provider+Plugin" class="external-link" rel="nofollow">Config File Provider Plugin</a> plugin, allowing the replacement of variables and credentials.</li></ul><h1 id="PipelineMavenPlugin-Features">Features</h1><h2 id="PipelineMavenPlugin-SensibledefaultMavenparameters">Sensible default Maven parameters</h2><p>The Maven parameters that are useful on a build server, &quot;<code>--batch-mode</code>&quot; (&quot;<code>-B</code>&quot;) and &quot;<code>--show-version</code>&quot; (&quot;<code>-V</code>&quot;) are enable by default, no need to add them in your mvn invocations.</p><h2 id="PipelineMavenPlugin-MavenSettingsSupport">Maven Settings Support</h2><p>The &quot;<code>withMaven()&quot;</code> pipeline step will setup the Maven settings file and global settings file either explicitly using the attributes of the &quot;withMaven(){}&quot; step declaration or implicitly using the Maven Global Settings and Settings files defined at the folder level or in the Jenkins Global Tools Configuration.</p><p>Using implicit declaration, Jenkins administrators can simplify the work of pipeline authors hiding the &quot;boilerplate&quot; to declare the credentials of the Git, Nexus, Artifactory... servers and all the needed proxies, mirrors...</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="450" src="attachments/99451377/175211733.png" data-image-src="attachments/99451377/175211733.png" data-unresolved-comment-count="0" data-linked-resource-id="175211733" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="global-tools-configuration-maven-settings.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="450" src="attachments/99451377/138448166.png" data-image-src="attachments/99451377/138448166.png" data-unresolved-comment-count="0" data-linked-resource-id="138448166" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="default-maven-settings-defined-at-the-folder-level.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></p><h2 id="PipelineMavenPlugin-TraceabilityofMavenbuilds">Traceability of Maven builds</h2><p>The &quot;<code>withMaven()&quot;</code> pipeline step will capture in the logs of the build all the details of the execution:</p><ul><li>Version of the JVM<ul><li><code>&quot;withMaven(){}&quot;</code> step initialization: &quot;<code>[withMaven] use JDK installation JDK8</code>&quot;</li><li><code>&quot;mvn&quot;</code> executable invocation: &quot;<code>Java version: 1.8.0_102, vendor: Oracle Corporation</code>&quot;&quot;</li></ul></li><li>Version of Maven<ul><li><code>&quot;withMaven(){}&quot;</code> step initialization: &quot;<code>[withMaven] use Maven installation 'M3'</code>&quot;&quot;</li><li><code>&quot;mvn&quot;</code> executable invocation: &quot;<code>Apache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5; 2015-11-10T16:41:47+00:00)</code>&quot;&quot;</li></ul></li><li>Name or path of the Maven settings.xml and Maven global settings.xml file.<ul><li><code>&quot;withMaven(){}&quot;</code> step initialization: &quot;<code>[withMaven] use Maven settings provided by the Jenkins Managed Configuration File 'maven-settings-for-supply-chain-build-job'</code>&quot;</li></ul></li><li>When using the Maven settings.xml and global settings.xml files provided by the <a href="https://wiki.jenkins-ci.org/display/JENKINS/Config+File+Provider+Plugin" class="external-link" rel="nofollow">Jenkins Config File Provider Plugin</a>,<br/>details of the Jenkins credentials injected in the Maven build.<ul><li><code>&quot;withMaven(){}&quot;</code> step initialization: &quot;<code>[withMaven] use Maven settings.xml 'maven-settings-for-supply-chain-build-job' with Maven servers credentials provided by Jenkins (replaceAll: true): [mavenServerId: 'nexus.beescloud.com', jenkinsCredentials: 'beescloud-nexus-deployment-credentials', username: 'deployment', ...]</code>&quot;</li></ul></li></ul><p>Sample:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>[withMaven] use JDK installation JDK8
[withMaven] use Maven installation &#39;M3&#39;
[withMaven] use Maven settings provided by the Jenkins Managed Configuration File &#39;maven-settings-for-supply-chain-build-job&#39;
[withMaven] use Maven settings.xml &#39;maven-settings-for-supply-chain-build-job&#39; with Maven servers credentials provided by Jenkins (replaceAll: true):
     [mavenServerId: &#39;nexus.beescloud.com&#39;, jenkinsCredentials: &#39;beescloud-nexus-deployment-credentials&#39;, username: &#39;deployment&#39;, type: &#39;UsernamePasswordCredentialsImpl&#39;],
     [mavenServerId: &#39;github.beescloud.com&#39;, jenkinsCredentials: &#39;github-enterprise-api-token&#39;, username: &#39;dev1&#39;, type: &#39;UsernamePasswordCredentialsImpl&#39;]
...
Running shell script
+ mvn clean deploy
----- withMaven Wrapper script -----
Picked up JAVA_TOOL_OPTIONS: -Dmaven.ext.class.path=&quot;.../pipeline-maven-spy.jar&quot; -Dorg.jenkinsci.plugins.pipeline.maven.reportsFolder=&quot;...&quot;
Apache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5; 2015-11-10T16:41:47+00:00)
Maven home: /home/ubuntu/jenkins-home/tools/hudson.tasks.Maven_MavenInstallation/M3
Java version: 1.8.0_102, vendor: Oracle Corporation
Java home: /home/ubuntu/jenkins-home/tools/hudson.model.JDK/JDK8/jre
Default locale: en_US, platform encoding: UTF-8
OS name: &quot;linux&quot;, version: &quot;3.13.0-109-generic&quot;, arch: &quot;amd64&quot;, family: &quot;unix&quot;
</pre>
</div></div><h2 id="PipelineMavenPlugin-ReportPublishers">Report Publishers</h2><p>Maven build executions inside the &quot;<code>withMaven(){...</code>}&quot; will be detected and Jenkins will transparently</p><ul><li>Archive and fingerprint generated Maven artifacts and Maven attached artifacts</li><li>Publish JUnit / Surefire reports (if the <a href="http://wiki.jenkins-ci.org/display/JENKINS/JUnit+Plugin" class="external-link" rel="nofollow">Jenkins JUnit Plugin</a> is installed)</li><li>Publish Findbugs reports (if the <a href="http://wiki.jenkins-ci.org/display/JENKINS/FindBugs+Plugin" class="external-link" rel="nofollow">Jenkins FindBugs Plugin</a> is installed)</li><li>Publish a report of the tasks (&quot;<code>FIXME</code>&quot; and &quot;<code>TODO</code>&quot;) found in the java source code (if the <a href="https://wiki.jenkins-ci.org/display/JENKINS/Task+Scanner+Plugin" class="external-link" rel="nofollow">Jenkins Tasks Scanner Plugin</a> is installed)</li><li>Concordion test reports (since 3.0.0)</li></ul><p><img class="emoticon emoticon-information" src="images/icons/emoticons/information.svg" data-emoticon-name="information" alt="(info)"/> The detection of Maven builds require to use Maven 3.2+.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Reporter</p></th><th class="confluenceTh"><p>Description</p></th><th class="confluenceTh"><p>Required Jenkins Plugin (1)</p></th><th colspan="1" class="confluenceTh"><p>Configuration to disable the feature</p><p>Since v2.3.0 (2)</p></th><th class="confluenceTh"><p>Marker file to disable the feature (3)</p></th></tr><tr><td class="confluenceTd"><p>Generated Artifact</p></td><td class="confluenceTd"><p>Archiving and the fingerprinting of the artifacts and attached artifacts generated by the Maven build (jar, sources jar, javadocs jar...)</p></td><td class="confluenceTd"><p><br/></p></td><td colspan="1" class="confluenceTd"><code>withMaven(options: [artifactsPublisher(disabled: true)],...)</code></td><td class="confluenceTd"><p><code>`.skip-archive-generated-artifacts`</code></p></td></tr><tr><td class="confluenceTd"><p>Generated JUnit, Surefire and FailSafe reports</p></td><td class="confluenceTd"><p>Publishing of the JUnit, Surefire and FailSafe reports generated by the Maven build</p></td><td class="confluenceTd"><p><a href="http://wiki.jenkins-ci.org/display/JENKINS/JUnit+Plugin" class="external-link" rel="nofollow">JUnit Plugin</a></p></td><td colspan="1" class="confluenceTd"><code><span>withMaven(options: [junitPublisher(disabled: true)],...)</span></code></td><td class="confluenceTd"><p><code>`.skip-publish-junit-results`</code></p></td></tr><tr><td class="confluenceTd"><p>Generated Findbugs reports</p></td><td class="confluenceTd"><p>Publishing of the Findbugs reports generated by the Maven build</p></td><td class="confluenceTd"><p><a href="https://wiki.jenkins-ci.org/display/JENKINS/FindBugs+Plugin" class="external-link" rel="nofollow">FindBugs Plugin</a></p></td><td colspan="1" class="confluenceTd"><code><span>withMaven(options: [</span><span>findbugsPublisher</span><span>(disabled: true)],...)</span></code></td><td class="confluenceTd"><p><code>`.skip-publish-findbugs-results`</code></p></td></tr><tr><td class="confluenceTd"><p>Tasks scanner report</p></td><td class="confluenceTd"><p>Publishing of a report of the &quot;<code>FIXME</code>&quot; and &quot;<code>TODO</code>&quot; tasks found in the java source code. The keywords can be configured.</p></td><td class="confluenceTd"><p><a href="https://wiki.jenkins-ci.org/display/JENKINS/Task+Scanner+Plugin" class="external-link" rel="nofollow">Jenkins Tasks Scanner Plugin</a></p></td><td colspan="1" class="confluenceTd"><code><span>withMaven(options: [openTasksPublisher</span><span>(disabled: true)],...)</span></code></td><td class="confluenceTd"><p><code>`.skip-task-scanner`</code></p></td></tr><tr><td colspan="1" class="confluenceTd"><p>Dependencies Fingerprinting</p><p>(since 2.5.0)</p></td><td colspan="1" class="confluenceTd"><p>Fingerprint the Maven dependencies.</p><p>By default only the snapshot dependencies of scope compile, runtime and provided are fingerprinted.</p></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><code>withMaven(options: [dependenciesFingerprintPublisher(disabled: true)],...)</code></td><td colspan="1" class="confluenceTd"><code>`.skip-fingerprint-maven-dependencies`</code></td></tr><tr><td colspan="1" class="confluenceTd"><p><a href="http://concordion.org/" class="external-link" rel="nofollow">Concordion</a> test report</p><p>(since 3.0.0)</p></td><td colspan="1" class="confluenceTd"><p>Publishing of the <a href="http://concordion.org/" class="external-link" rel="nofollow">Concordion</a> test reports.</p><p>Publish the Concordion reports generated by the maven-surefire-plugin:test and the maven-failsafe-plugin:integration-test goals and located in the folder described by the system property &quot;concordion.output.dir&quot; as documented in <a href="http://concordion.org/integrations/java/html/#maven" class="external-link" rel="nofollow">Concordion &gt; Integration &gt; Java &gt; Maven</a></p><p><br/></p></td><td colspan="1" class="confluenceTd"><a href="https://wiki.jenkins.io/display/JENKINS/HTML+Publisher+Plugin" rel="nofollow">HTML Publisher Plugin</a></td><td colspan="1" class="confluenceTd"><code><span>withMaven(options: [concordionPublisher(disabled: true)],...)</span></code></td><td colspan="1" class="confluenceTd"><code>`.skip-publish-concordion-results`</code></td></tr><tr><td colspan="1" class="confluenceTd"><a href="https://maven.apache.org/plugins/maven-invoker-plugin/" class="external-link" rel="nofollow">Maven Invoker Plugin</a> test reports</td><td colspan="1" class="confluenceTd">Publish test reports generated by the <a href="https://maven.apache.org/plugins/maven-invoker-plugin/" class="external-link" rel="nofollow">maven-invoker-plugin:run</a> goal</td><td colspan="1" class="confluenceTd"><pre><a href="Maven-Invoker-Plugin.html">Maven Invoker Plugin</a></pre></td><td colspan="1" class="confluenceTd"><code><span>withMaven(options: [invokerPublisher(disabled: true)],...)</span></code></td><td colspan="1" class="confluenceTd"><code>`.skip-publish-invoker-run`</code></td></tr><tr><td colspan="1" class="confluenceTd">JGiven reports</td><td colspan="1" class="confluenceTd">Publish <a href="http://jgiven.org/" class="external-link" rel="nofollow">JGiven</a> test reports</td><td colspan="1" class="confluenceTd"><a href="https://wiki.jenkins.io/display/JENKINS/JGiven+Plugin" rel="nofollow">JGiven Plugin</a></td><td colspan="1" class="confluenceTd"><code><span>withMaven(options: [jgivenPublisher(disabled: true)],...)</span></code></td><td colspan="1" class="confluenceTd"><code>`.skip-publish-jgiven-results`</code></td></tr><tr><td colspan="1" class="confluenceTd">JaCoCo Code Coverage</td><td colspan="1" class="confluenceTd">Publish JaCoCo Code Coverage</td><td colspan="1" class="confluenceTd"><a href="https://wiki.jenkins.io/display/JENKINS/JaCoCo+Plugin" rel="nofollow">JaCoCo Plugin</a></td><td colspan="1" class="confluenceTd"><p>withMaven(options: [<span style="font-family: monospace;letter-spacing: 0.0px;">jacocoPublisher(</span>disabled: true)],...)</p></td><td colspan="1" class="confluenceTd"><br/></td></tr><tr><td colspan="1" class="confluenceTd">Maven Linker Publisher</td><td colspan="1" class="confluenceTd"><p>Publish the Maven report on the pipeline build GUI (list of dependencies, produced artifacts, downstream &amp; upstream pipelines).</p><p>This publisher should be renamed &quot;Maven Build Report Publisher&quot;.</p><p>A reason to disable this publisher is typically to not &quot;pollute&quot; the build screen with Maven invocations when Maven is used as an utility (e.g. invocations of &quot;<span style="color: rgb(51,51,51);">maven-help-plugin:3.2.0:evaluate&quot;...)</span></p></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><code>withMaven(options: [mavenLinkerPublisher(disabled: true)],...)</code></td><td colspan="1" class="confluenceTd">`skip-maven-linker-publisher`</td></tr><tr><td colspan="1" class="confluenceTd">Pipeline Graph Publisher</td><td colspan="1" class="confluenceTd">Build the graph of dependencies between Jenkins pipelines and Maven artifacts in order to trigger downstream pipelines (when using the `snapshotDependencies` on downstream pipelines)</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><code>withMaven(options: [pipelineGraphPublisher(disabled: true)],...)</code></td><td colspan="1" class="confluenceTd">`.skip-pipeline-graph`</td></tr></tbody></table></div><p>(1) Jenkins Plugin to publish the reports on the Jenkins build page. If the plugin is not installed, then the MAven report is ignored.</p><p>(2) Download <a href="https://repo.jenkins-ci.org/releases/org/jenkins-ci/plugins/pipeline-maven/2.3.0-beta-1/pipeline-maven-2.3.0-beta-1.hpi" class="external-link" rel="nofollow">pipeline-maven-2.3.0-beta-1.hpi</a></p><p>(3) Marker file to temporarily disable the feature for a specific Maven build.<br/>Typically used to disable a reporter for a specific build that would generate too much data for the default configuration of the reporter (e.g. too many generated artifacts...) or to workaround a bug in the &quot;<code>withMaven</code>&quot; waiting for a fix. These marker file must be located in the home directory of the build.</p><h3 id="PipelineMavenPlugin-ImplicitorExplicitactivationofPublishers">Implicit or Explicit activation of Publishers</h3><p>By default, all the publishers are enabled by default.</p><p>It is possible to change the default activation of a publisher navigating to the &quot;Global Tool Configuration&quot; screen.</p><p>It is possible to disable the default activation of publishers on a specific &quot;<code>withMaven(){...}</code>&quot; step using the &quot;<code>publisherStrategy='EXPLICIT'</code>&quot; attribute in the step &quot;<code>withMaven(publisherStrategy='EXPLICIT'){...}</code>&quot;. The publishers can then be enabled explicitly in the &quot;<code>withMaven(){...}</code>&quot; step using the &quot;publishers&quot; attribute</p><h2 id="PipelineMavenPlugin-DefaultConfiguration">Default Configuration</h2><p>Default Maven settings can be defined globally and at the folder level.</p><h3 id="PipelineMavenPlugin-GlobalDefaultConfiguration">Global Default Configuration</h3><p>In the &quot;Global Tool Configuration&quot; screen</p><ul><li>Maven settings and Maven global settings </li><li>Publishers settings: enable/disable publishers...</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="414" src="attachments/99451377/130951908.png" data-image-src="attachments/99451377/130951908.png" data-unresolved-comment-count="0" data-linked-resource-id="130951908" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="pipeline-maven-plugin-global-tools-configuration.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></p><h3 id="PipelineMavenPlugin-FolderLevelConfiguration">Folder Level Configuration</h3><p>In the Folder &quot;configuration&quot; screen</p><ul><li>Maven settings and Maven global settings </li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="563" src="attachments/99451377/138451070.png" data-image-src="attachments/99451377/138451070.png" data-unresolved-comment-count="0" data-linked-resource-id="138451070" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="pipeline-maven-folder-level-configuration.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></p><h2 id="PipelineMavenPlugin-Triggerdownstreampipelinewhenasnapshotisbuilt(since3.0.0)">Trigger downstream pipeline when a snapshot is built (since 3.0.0)</h2><p>Trigger downstream pipeline that depend on Maven artifact generated by upstream pipelines.</p><p><img class="emoticon emoticon-information" src="images/icons/emoticons/information.svg" data-emoticon-name="information" alt="(info)"/> Notes</p><ul><li>The upstream artifact must be generated in a &quot;<code>withMaven(){}</code>&quot; wrapping step to be detected by the triggering system</li><li>The downstream pipeline must have selected the build trigger &quot;Build whenever a SNAPSHOT dependency is built&quot;<ul><li>The build trigger can be defined at the pipeline level (&quot;Build Triggers&quot;), at the multibranch pipeline level (&quot;Scan Repository Triggers&quot;) or at the GitHub Organization / Bitbucket Project level (&quot;Scan Organizations Triggers&quot;)</li></ul></li><li>You have to manually trigger once the upstream pipeline and the downstream pipeline so that the link between the pipelines based on the SNAPSHOT dependency is established</li><li>The dependency graph is, for the moment, exclusively stored in an H2 embedded database (&quot;<code>$JENKINS_HOME/jenkins-jobs/jenkins-jobs.mv.db</code>&quot;). Support for an external H2 database and then for alternate databases (PostgreSQL) is on the roadmap (see <a href="https://github.com/jenkinsci/pipeline-maven-plugin/blob/pipeline-maven-3.0.0-beta-1/jenkins-plugin/src/main/java/org/jenkinsci/plugins/pipeline/maven/dao/PipelineMavenPluginH2Dao.java" class="external-link" rel="nofollow">PipelineMavenPluginH2Dao.java</a>)</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="810" src="attachments/99451377/133958072.png" data-image-src="attachments/99451377/133958072.png" data-unresolved-comment-count="0" data-linked-resource-id="133958072" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2017-8-7 12:38:11.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="810" src="attachments/99451377/133958103.png" data-image-src="attachments/99451377/133958103.png" data-unresolved-comment-count="0" data-linked-resource-id="133958103" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2017-8-7 15:22:4.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" alt="Downstream Pipeline Trigger - Org Level Configuration" height="146" width="810" src="attachments/99451377/133958102.png" data-image-src="attachments/99451377/133958102.png" data-unresolved-comment-count="0" data-linked-resource-id="133958102" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2017-8-7 15:19:41.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119" title="Downstream Pipeline Trigger - Org Level Configuration"></span></p><ul><li>Thresholds are applied to define on which type of maven build the downstream pipelines are triggered<ul><li>Threshold based on the status of the upstream pipeline (&quot;success&quot;, &quot;unstable&quot;, &quot;failure&quot;, &quot;no build&quot;, &quot;aborted&quot;). By default, only builds with a &quot;success&quot; result will trigger downstream builds.<ul><li><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" width="600" src="attachments/99451377/135465876.png" data-image-src="attachments/99451377/135465876.png" data-unresolved-comment-count="0" data-linked-resource-id="135465876" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="downstream-pipeline-trigger-threshold-build-result.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></li></ul></li><li>Threshold based on the <a href="https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html" class="external-link" rel="nofollow">Maven lifecycle phase</a> reached in the Maven build of the upstream job (&quot;package&quot;, &quot;install&quot;, &quot;deploy&quot;). By default, only the maven builds who reach the &quot;deploy&quot; phase will trigger downstream builds.<ul><li><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="150" src="attachments/99451377/135465875.png" data-image-src="attachments/99451377/135465875.png" data-unresolved-comment-count="0" data-linked-resource-id="135465875" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="downstream-pipeline-trigger-threshold-lifecycle.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></li></ul></li></ul></li></ul><h2 id="PipelineMavenPlugin-Linux,WindowsandMacOSXsupport">Linux, Windows and MacOSX support</h2><p>The Pipeline Maven Plugin works with Linux, Windows and MacOSX build agents.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Maven build on a Windows agent</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">node (&quot;windows&quot;) {
  stage (&#39;Build&#39;) {

    git url: &#39;https://github.com/cyrille-leclerc/multi-module-maven-project&#39;

    withMaven(...) {

      bat &quot;mvn clean install&quot;

    } // withMaven will discover the generated Maven artifacts, JUnit Surefire &amp; FailSafe reports and FindBugs reports
  }
}
</pre>
</div></div><h2 id="PipelineMavenPlugin-SupportofTakari&#39;sMavenWrapper&#39;mvnw&#39;(since3.0.3)">Support of Takari's Maven Wrapper 'mvnw' (since 3.0.3)</h2><p>The Pipeline Maven Plugin works with <a href="https://github.com/takari/maven-wrapper" class="external-link" rel="nofollow">Takari's Maven wrapper</a> 'mvnw'.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">withMaven(...) {
   sh &quot;./mvnw clean deploy&quot;
}
...</pre>
</div></div><h1 id="PipelineMavenPlugin-AddingmoreMavenReporters"><br/>Adding more Maven Reporters</h1><p>The API for Maven reporters is still experimental. Please open a Request for Enhancement Jira issue to discuss how to add Maven reporters.</p><p>We want to quickly add reporters for CheckStyle, Jacoco...</p><h1 id="PipelineMavenPlugin-Setup">Setup</h1><h2 id="PipelineMavenPlugin-UsingaMySQLDatabase(since3.6.0)">Using a MySQL Database (since 3.6.0)</h2><p>The Jenkins Pipeline Maven Plugin relies on a database to store its data (list of dependencies and of generated artifacts of each build...).</p><p>By default, the Jenkins Pipeline Maven Plugin uses an H2 embedded database but it is recommend to use an external MySQL database.</p><p>Configuration steps to use a MySQL:</p><ul><li>Create an empty MySQL database with a dedicated MySQL user with permissions for Data Manipulation Language actions (DML) and Data Definition Language (DDL) actions<ul><li>Tested with MySQL 8.0, with MariaDB 10.2 and 10.3 and with Amazon Aurora MySQL 5.6</li></ul></li><li>Install the Jenkins &quot;MySQL Database&quot; plugin<ul><li>Navigate to &quot;Manage Jenkins / Manage Plugins / Available&quot;, select the &quot;MySQL Database&quot; plugin and click on &quot;Download now and install after restart&quot;</li></ul></li><li> Configure the Pipeline Maven Plugin to use the created MySQL database<br/><ul><li>Create Jenkins credentials for the MySQL connection navigating to &quot;Credentials&quot; on the left menu</li><li>Navigate to &quot;Manage Jenkins / Global Tools Configuration&quot; and go to the &quot;Pipeline Maven Configuration&quot;</li><li><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="773" src="attachments/99451377/165579460.png" data-image-src="attachments/99451377/165579460.png" data-unresolved-comment-count="0" data-linked-resource-id="165579460" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="pipeline-maven-plugin-configuration-1.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></li><li>In the Database configuration section, define the following<ul><li>JDBC URL: url of the database, e.g. &quot;jdbc:mysql://mysql.example.com/jenkins&quot;</li><li>JDBC Credentials: select the credentials of the MySQL database</li><li>The <a href="https://github.com/brettwooldridge/HikariCP/wiki/MySQL-Configuration" class="external-link" rel="nofollow">parameters recommended by the Hikari Connection Pool team</a> are used by default for the MySQL connections and for the datasource (max pool size:10, server side prepared statements cache with 250 entries...).  To overwrite these defaults, click on the &quot;Advanced Database Convfiguration&quot; button.</li></ul></li><li>Click on &quot;Validate Database Configuration&quot; button to verify that the connection is successful</li><li>Click on &quot;Save&quot;</li><li><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="559" src="attachments/99451377/165579461.png" data-image-src="attachments/99451377/165579461.png" data-unresolved-comment-count="0" data-linked-resource-id="165579461" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="pipeline-maven-plugin-configuration-2.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></li></ul></li></ul><p><br/></p><h2 id="PipelineMavenPlugin-UsingaPostgreSQLDatabase(since3.7.0)">Using a PostgreSQL Database (since 3.7.0)</h2><p>The Jenkins Pipeline Maven Plugin relies on a database to store its data (list of dependencies and of generated artifacts of each build...).</p><p>By default, the Jenkins Pipeline Maven Plugin uses an H2 embedded database but it is recommended to use an external PostgreSQL or MySQL / MariaDB database.</p><p>Configuration steps to use a PostgreSQL:</p><ul><li>Create an empty PostgreSQL database with a dedicated PostgreSQL user with permissions for Data Manipulation Language actions (DML) and Data Definition Language (DDL) actions<ul><li>Tested with PostgreSQL 10.6 and 11.3</li></ul></li><li>Install the Jenkins the &quot;<a href="https://wiki.jenkins.io/display/JENKINS/PostgreSQL+API+Plugin" rel="nofollow">PostgreSQL API</a>&quot; plugin<ul><li>Navigate to &quot;Manage Jenkins / Manage Plugins / Available&quot;, select the &quot;PostgreSQL API&quot; plugin and click on &quot;Download now and install after restart&quot;</li></ul></li><li> Configure the Pipeline Maven Plugin to use the created PostgreSQL database<br/><ul><li>Create Jenkins credentials for the PostgreSQL connection navigating to &quot;Credentials&quot; on the left menu</li><li>Navigate to &quot;Manage Jenkins / Global Tools Configuration&quot; and go to the &quot;Pipeline Maven Configuration&quot;</li><li><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="764" src="attachments/99451377/175211585.png" data-image-src="attachments/99451377/175211585.png" data-unresolved-comment-count="0" data-linked-resource-id="175211585" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="pipeline-maven-plugin-configuration-postgresql.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></li><li>In the Database configuration section, define the following<ul><li>JDBC URL: url of the database, e.g. &quot;jdbc:postgresql://postgresql.example.com:5432/jenkins&quot;</li><li>JDBC Credentials: select the credentials of the PostgreSQL database</li><li>The underlying datasource, <a href="https://github.com/brettwooldridge/HikariCP" class="external-link" rel="nofollow">HikariCP</a>, comes with sensible default configuration values (see <a href="https://github.com/brettwooldridge/HikariCP#configuration-knobs-baby" class="external-link" rel="nofollow">here</a>). To overwrite these defaults, click on the &quot;Advanced Database Configuration&quot; button.</li></ul></li><li>Click on &quot;Validate Database Configuration&quot; button to verify that the connection is successful</li><li>Click on &quot;Save&quot;</li><li>Navigate to &quot;Manage Jenkins / Global Tools Configuration&quot; and go to the &quot;Pipeline Maven Configuration&quot; to verify that the database connection is successful and the database tables have been created (see screenshot above)</li></ul></li></ul><h1 id="PipelineMavenPlugin-FAQ">FAQ</h1><p><span class="confluence-anchor-link" id="PipelineMavenPlugin-withMavenAndDockerPipeline"></span></p><h2 id="PipelineMavenPlugin-HowtousethePipelineMavenPluginwithDocker?(sinceversion3.0.3)">How to use the Pipeline Maven Plugin with Docker? (since version 3.0.3)</h2><p>Since the version 1.14 of the Docker Pipeline plugin, &quot;withMaven&quot; requires to</p><ul><li>Either prepend the '<code>MVN_CMD_DIR</code>' environment variable to the '<code>PATH</code>' environment variable in every '<code>sh</code>' step that invokes '<code>mvn</code>' (e.g. &quot;<code>sh 'export PATH=$MVN_CMD_DIR:$PATH &amp;&amp; mvn clean deploy'</code> &quot;).</li><li><p>Or use Takari's Maven Wrapper (e.g. &quot;sh './mvnw clean deploy'&quot;)</p></li></ul><p>If omitted, the Maven settings file and Mven global settings file will not be injected in the Maven execution.</p><h3 id="PipelineMavenPlugin-Using&quot;withMaven&quot;with&quot;docker.image(...).inside{...}&quot;andaJenkinsScriptedPipeline">Using &quot;<code>withMaven</code>&quot; with &quot;<code>docker.image(...).inside{...}</code>&quot; and a Jenkins Scripted Pipeline </h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Prepending MVN_CMD_DIR to PATH</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">node(&quot;linux-agent-running-docker&quot;) { // Linux agent with the Docker daemon
    docker.image(&#39;maven&#39;).inside { // Docker image with Maven installed
        withMaven(...) {
            git &quot;https://github.com/cyrille-leclerc/my-jar.git&quot;
            sh &quot;export PATH=$MVN_CMD_DIR:$PATH &amp;&amp; mvn clean deploy&quot; // &#39;mvn&#39; command: need to add the $MVN_CMD_DIR to $PATH
        }
    }
}</pre>
</div></div><p><span style="color: rgb(210,73,57);"> </span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Using Takari's Maven Wrapper mvnw</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">node(&quot;linux-agent-running-docker&quot;) { // Linux agent with the Docker daemon
    docker.image(&#39;openjdk:8-jdk&#39;).inside { // Docker image with Java installed
        withMaven(...) {
            git &quot;https://github.com/cyrille-leclerc/my-jar.git&quot;
            sh &quot;./mvnw clean deploy&quot; // &#39;mvnw&#39; command (e.g. &quot;./mvnw deploy&quot;)
        }
    }
}</pre>
</div></div><p><span style="color: rgb(210,73,57);"><br/></span></p><h3 id="PipelineMavenPlugin-Using&quot;withMaven&quot;with&quot;docker.image(...).inside{...}&quot;toaJenkinsDeclarativePipeline"><span style="color: rgb(210,73,57);">Using &quot;</span><code>withMaven</code><span style="color: rgb(210,73,57);">&quot; with &quot;</span><code>docker.image(...).inside{...}</code><span style="color: rgb(210,73,57);">&quot; to a Jenkins Declarative Pipeline </span></h3><p><span style="color: rgb(0,0,0);">TODO provide a sample with Jenkins Declarative Pipeline</span></p><p><span style="color: rgb(0,0,0);"> </span></p><p><span style="color: rgb(0,0,0);"><br/></span></p><h3 id="PipelineMavenPlugin-SamplemessagedisplayedinthebuildlogswhenusingwithMaveninaDockerPipelineexecutionenvironment">Sample message displayed in the build logs when using withMaven in a Docker Pipeline execution environment</h3><p>Warning message displayed in the logs when invoking withMaven within Docker Pipeline:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>[withMaven] WARNING: &quot;withMaven(){...}&quot; step running within &quot;docker.image(&#39;image&#39;).inside {...}&quot;. Since the Docker Pipeline Plugin version 1.14, you MUST:
[withMaven] * Either prepend the &#39;MVN_CMD_DIR&#39; environment variable to the &#39;PATH&#39; environment variable in every &#39;sh&#39; step that invokes &#39;mvn&#39; (e.g. &quot;sh &#39;export PATH=$MVN_CMD_DIR:$PATH &amp;&amp; mvn clean deploy&#39; &quot;). 
[withMaven] * Or use Takari&#39;s Maven Wrapper (e.g. &quot;sh &#39;./mvnw clean deploy&#39;&quot;)
[withMaven] See Pipeline Maven Plugin FAQ.</pre>
</div></div><h2 id="PipelineMavenPlugin-HowtodisabletheMavenEventSpyinjectedbythePipelineMavenPlugininMavenbuilds?"><br/>How to disable the Maven Event Spy injected by the Pipeline Maven Plugin in Maven builds?</h2><p>It may be convenient to temporarily disable the Maven Event Spy of the Jenkins Pipeline Maven plugin, for example for troubleshooting purpose.</p><p>You can disable the Maven Event Spy of the Jenkins Pipeline Maven plugin (making it no-op) doing one of the following:</p><ul><li>Setting the environment variable &quot;<code>JENKINS_MAVEN_AGENT_DISABLED</code>&quot; to &quot;<code>true</code>&quot; in the job execution</li></ul><p><br/></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">...
withMaven() {
   sh &quot;&quot;&quot;
export JENKINS_MAVEN_AGENT_DISABLED=true
mvn package
&quot;&quot;&quot;
}</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">...
withEnv([&#39;JENKINS_MAVEN_AGENT_DISABLED=true&#39;]) {
   sh &quot;mvn package&quot;
}
</pre>
</div></div><p><br/></p><ul><li>Adding the system property &quot;<code>-Dorg.jenkinsci.plugins.pipeline.maven.eventspy.JenkinsMavenEventSpy.disabled=true</code>&quot; to the invocation of the mvn build</li></ul><h2 id="PipelineMavenPlugin-WhydoIseemessages&quot;[WARNING]PickedupJAVA_TOOL_OPTIONS...&quot;inthebuildlogs?">Why do I see messages &quot;<code>[WARNING] Picked up JAVA_TOOL_OPTIONS...</code>&quot; in the build logs?</h2><p>The Jenkins Pipeline Maven Plugin uses the &quot;<code>JAVA_TOOL_OPTIONS</code>&quot; environment variable to pass options to subsequent Maven builds such as the actual release build when invoking &quot;<code>mvn release:prepare release:perform</code>&quot;. The plugins passes the properties &quot;<code>-Dmaven.ext.class.path</code>&quot; and &quot;<code>-Dorg.jenkinsci.plugins.pipeline.maven.reportsFolder</code>&quot;.</p><p>When using the &quot;<code>JAVA_TOOL_OPTIONS</code>&quot;, the JVM outputs a message during its initialization.</p><p>With the Jenkins Pipeline Maven Plugin, this message looks like:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>[WARNING] Picked up JAVA_TOOL_OPTIONS: -Dmaven.ext.class.path=&quot;/path/to/workspace/...@tmp/withMaven.../pipeline-maven-spy.jar&quot; -Dorg.jenkinsci.plugins.pipeline.maven.reportsFolder=&quot;/path/to/workspace/...@tmp&quot;</pre>
</div></div><p><img class="emoticon emoticon-information" src="images/icons/emoticons/information.svg" data-emoticon-name="information" alt="(info)"/> It is not possible to disable this warning message</p><h2 id="PipelineMavenPlugin-Mydownstreampipelinesdon&#39;tgettriggeredevenifIuse&quot;BuildwheneveraSNAPSHOTdependencyisbuilt&quot;">My downstream pipelines don't get triggered even if I use &quot;Build whenever a SNAPSHOT dependency is built&quot;</h2><p>A common reason why downstream pipelines don't get triggered when using &quot;Build whenever a SNAPSHOT dependency is built&quot; is that the upstream pipeline is using &quot;mvn install&quot; when the Jenkins Pipeline Maven integration is configured to trigger pipelines on &quot;mvn deploy&quot;.</p><p>To configure the Jenkins Pipeline Maven integration to trigger downstream pipelines on &quot;mvn install&quot;:</p><ul><li>Either change the default configuration:<ul><li>Navigate to &quot;Manage Jenkins / Global Tools Configuration&quot;</li><li>Click on &quot;Add Publisher&quot; and select &quot;Pipeline Graph Publisher&quot;</li><li>In the section &quot;Downstream Pipeline Triggers&quot;, change the the &quot;Maven lifecycle threshold&quot; from &quot;deploy&quot; to &quot;install&quot;</li></ul></li></ul><p style="margin-left: 90.0px;"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/99451377/175211406.png" data-image-src="attachments/99451377/175211406.png" data-unresolved-comment-count="0" data-linked-resource-id="175211406" data-linked-resource-version="3" data-linked-resource-type="attachment" data-linked-resource-default-alias="pipeline-graph-publisher-maven-lifecycle.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></p><ul><li>Or in the script of the upstream pipeline, configure &quot;<code>withMaven(options: [pipelineGraphPublisher(lifecycleThreshold: 'install')]) {...}</code>&quot;</li></ul><p><br/></p><h2 id="PipelineMavenPlugin-HowcanItroubleshootproblemsoftriggerofdownstreampipelines">How can I troubleshoot problems of trigger of downstream pipelines</h2><ul><li>The Pipeline Maven Plugin uses the Jenkins log levels (see <a href="https://wiki.jenkins.io/display/JENKINS/Logging#Logging-LogsinJenkins" rel="nofollow">here</a>) to output additional troubleshooting information in the pipeline build logs (the &quot;Console Output&quot; menu of the build)</li><li>To output additional troubleshooting information about the  trigger of downstream pipelines, enable in &quot;Manage Jenkins / System Log&quot; (docs <a href="https://wiki.jenkins.io/display/JENKINS/Logging#Logging-LogsinJenkins" rel="nofollow">here</a>)  the following loggers at a level FINE or FINER or more:<ul><li>org.jenkinsci.plugins.pipeline.maven.publishers.PipelineGraphPublisher</li><li>org.jenkinsci.plugins.pipeline.maven.listeners.DownstreamPipelineTriggerRunListener</li></ul></li><li>Re run the pipeline that is supposed to trigger downstream pipelines.</li><li>Look at the pipeline build logs (&quot;Console Output&quot; menu), ensure that the build is completed and that the following message is displayed in the logs: &quot;[withMaven] downstreamPipelineTriggerRunListener - completed in XXX ms&quot;. Troubleshooting details are added</li></ul><h2 id="PipelineMavenPlugin-HowdoIcapturethelogfilegeneratedbytheJenkinsMavenEventSpy">How do I capture the log file generated by the Jenkins Maven Event Spy</h2><p>You can archive the XML log file generated by the Jenkins Maven Event Spy creating the marker file &quot;.archive-jenkins-maven-event-spy-logs&quot;.</p><p>Sample:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">withMaven() {
	sh &quot;mvn package&quot;
	writeFile file: &#39;.archive-jenkins-maven-event-spy-logs&#39;, text: &#39;&#39;
} // will discover the marker file &quot;.archive-jenkins-maven-event-spy-log&quot; and will archive the maven event spy log file maven-spy-....log	</pre>
</div></div><h2 id="PipelineMavenPlugin-HowdoIchecktheMavensettingsinusebymybuild">How do I check the Maven settings in use by my build</h2><p>You can dump the effective Maven settings of your pipeline using the Maven Help plugin and the &quot;<a href="http://maven.apache.org/plugins/maven-help-plugin/effective-settings-mojo.html" class="external-link" rel="nofollow">help:effective-settings</a>&quot; goal</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">withMaven(){
   mvn help:effective-settings
}</pre>
</div></div><p><br/></p><h2 id="PipelineMavenPlugin-HowcanIreducethefootprintofthedatabaseoftheJenkinsPipelineMavenPlugin?">How can I reduce the footprint of the database of the Jenkins Pipeline Maven Plugin?</h2><p>The Jenkins pipeline Maven plugin uses a database to trigger downstream pipelines when a snapshot is built.</p><p>For production grade deployments, a MySQL database is needed instead of the embedded H2 database. My SQL 5.6+, Amazon Aurora MySQL and MariaDB 10.2+ have been successfully tested.</p><p>To reduce the usage of the database, disable the &quot;Pipeline Graph Publisher&quot; navigating to &quot;Manage Jenkins / Global Tool Configuration / Pipeline Maven Configuration&quot; then clicking on &quot;Add Publisher Options&quot;, selecting &quot;Pipeline Graph Publisher&quot; and checking the &quot;disabled&quot; checkbox.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="250" width="556" src="attachments/99451377/165581999.png" data-image-src="attachments/99451377/165581999.png" data-unresolved-comment-count="0" data-linked-resource-id="165581999" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="pipeline-maven-plugin-configuration-disabled-pipeline-graph-publisher.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="99451377" data-linked-resource-container-version="119"></span></p><p><span class="confluence-anchor-link" id="PipelineMavenPlugin-mavenExecutionInterrupted"></span></p><h2 id="PipelineMavenPlugin-WhydoIseemessages&quot;[withMaven]OneormultipleMavenexecutionshavebeenignored...&quot;inthebuildlogs?">Why do I see messages &quot;[withMaven] One or multiple Maven executions have been ignored...&quot; in the build logs?</h2><div>The message &quot;[withMaven] One or multiple Maven executions have been ignored by the Jenkins Pipeline Maven Plugin because they have been interrupted before completion...&quot; because one or several Maven execution (e.g. &quot;<code>mvn deploy</code>&quot;) have been interrupted before they could gracefully complete.</div><div>The event &quot;<code>org.apache.maven.eventspy.EventSpy#close()</code>&quot; has not been invoked on the Maven event spies.</div><div>This interruption usually happens because the mvn process has been killed by the Operating System, typically for memory constraints in Docker or cgroups environments. Another cause is a &quot;<code>kill -9</code>&quot; during the build.</div><h2 id="PipelineMavenPlugin-WhydoIseemessages&quot;javax.xml.parsers.FactoryConfigurationError:Providerforclassjavax.xml.parsers.DocumentBuilderFactorycannotbecreated&quot;">Why do I see messages &quot;javax.xml.parsers.FactoryConfigurationError: Provider for class javax.xml.parsers.DocumentBuilderFactory cannot be created&quot;</h2><p>This error is caused by the installation of another plugin that pulls an outdated version of Apache Xerces. That pulls a version of Apache Xerces that is not compatible with the version of the JVM. Typically, Xerces 2.6 will not be compatible with a JDK 8 due to changes in the JAXP API (sample: 
<span class="jira-issue resolved" data-jira-key="JENKINS-47486" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-47486?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14673&amp;avatarType=issuetype"/>JENKINS-47486</a>
                            -
            <span class="summary">FactoryConfigurationError: Provider for class javax.xml.parsers.DocumentBuilderFactory cannot be created (was &quot;Exceptions after running goals&quot;)</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Closed</span>
                </span>
).</p><p>The solution is to get this plugin updated so that it uses a more recent of Xerces that would be compatible with the JDK.</p><p>To identify the plugin that is pulling an outdated version of a JAXP implementation (typically Xerces), navigate to the Jenkins Script Console (&quot;Manage Jenkins&quot; then &quot;Script Console&quot;) and execute the following groovy script:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">String className = &quot;org.apache.xerces.jaxp.DocumentBuilderFactoryImpl&quot;

Class klass
try {
  klass = Class.forName(className)
} catch (Exception e) {
  println(&quot;Exception trying to load &quot; + className + &quot; from the system classloader, try the thread context classloader &quot; + e)
  // contextClassLoader should not work but let&#39;s try it.
  klass = Class.forName(className, false, Thread.currentThread().getContextClassLoader())
}

java.security.CodeSource codeSource = klass.getProtectionDomain().getCodeSource()

if (codeSource == null) {
  println(klass.toString() + &quot; -&gt; source not found&quot;)
} else {
  println(klass.toString() + &quot; -&gt; &quot; + codeSource.getLocation());
}</pre>
</div></div><p>The output message will show from which plugin the XercesParser is loaded. Sample with a plugin &quot;my_plugin&quot; that would load an outdated 2.6.2 version of Xerces:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>class org.apache.xerces.jaxp.DocumentBuilderFactoryImpl -&gt; file:/var/lib/jenkins/plugins/my_plugin/WEB-INF/lib/xercesImpl-2.6.2.jar </pre>
</div></div><h2 id="PipelineMavenPlugin-HowtouseMavenbuilddataingeneratedemails">How to use Maven build data in generated emails</h2><p>It is possible to use informations generated by Maven pipelines in emails generated by the <a href="https://wiki.jenkins.io/display/JENKINS/Email-ext+plugin" rel="nofollow">Jenkins Email Ext Plugin</a>.</p><p>See <a href="https://groups.google.com/forum/#!topic/jenkinsci-users/sPAYLh1W1cM" class="external-link" rel="nofollow">https://groups.google.com/forum/#!topic/jenkinsci-users/sPAYLh1W1cM</a></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Sample Pipeline code to expose artifact details in emails</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: groovy; gutter: false; theme: Confluence" data-theme="Confluence">env.DEPLOYEDARTIFACTS = getDeployedArtifacts()

@NonCPS
def getDeployedArtifacts() {
    def deployed = &#39;&#39;
    Collection&lt;org.jenkinsci.plugins.pipeline.maven.MavenArtifact&gt; generatedArtifacts = currentBuild.rawBuild.getAction(org.jenkinsci.plugins.pipeline.maven.publishers.MavenReport.class).getGeneratedArtifacts();
    for (org.jenkinsci.plugins.pipeline.maven.MavenArtifact generatedArtifact:generatedArtifacts) {
    	if (generatedArtifact.isDeployed()) {
    	   
    	    deployed= deployed.concat(generatedArtifact.getUrl())
    	    deployed = deployed.concat(&quot;===&quot;)
    	    deployed = deployed.concat(generatedArtifact.getShortDescription())
    	    deployed = deployed.concat(&quot;,&quot;) 
        }

    }
    return deployed
}
</pre>
</div></div><p><br/></p><p>In EXT-MAIL-STANDARD-TEMPLATE</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Sample mail template using Maven build details</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: xml; gutter: false; theme: Confluence" data-theme="Confluence">    &lt;br /&gt;
    &lt;!-- MAVEN ARTIFACTS --&gt;
    &lt;j:set var=&quot;mbuilds&quot; value=&quot;${it.getAction(&#39;org.jenkinsci.plugins.workflow.cps.EnvActionImpl&#39;).getOverriddenEnvironment()}&quot; /&gt;
        &lt;h5&gt;Deployed Artifacts&lt;/h5&gt;
         &lt;j:set var=&quot;generatedArtifacts&quot; value=&quot;${mbuilds.get(&#39;DEPLOYEDArtifacts&#39;)}&quot; /&gt;

       &lt;table width=&quot;100%&quot; style=&quot;font-family: Verdana, Helvetica, sans serif; font-size: 11px; color: black&quot;&gt;
        &lt;j:forEach var=&quot;artifacts&quot; items=&quot;${generatedArtifacts.split(&#39;,&#39;)}&quot; &gt;
        &lt;j:set var=&quot;artifact&quot; value=&quot;${artifacts.split(&#39;===&#39;)}&quot; /&gt;
         &lt;tr bgcolor=&quot;white&quot; &gt;
          &lt;td class=&quot;bg1&quot; colspan=&quot;2&quot; style=&quot;font-family: Verdana, Helvetica, sans serif; font-size: 120%; color: black&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;${artifact[0]}&quot;&gt;
            ${artifact[1]}
          &lt;/a&gt;
          &lt;/li&gt;
           &lt;/td&gt;
         &lt;/tr&gt;
         &lt;/j:forEach&gt;
       &lt;/table&gt;
 &lt;br /&gt;

</pre>
</div></div><h1 id="PipelineMavenPlugin-KnownLimitations"><br/>Known Limitations</h1><h3 id="PipelineMavenPlugin-MavenandJDKinstallationnotsupportedindocker.image(&#39;xxx&#39;).inside{...}">Maven and JDK installation not supported in <code>docker.image('xxx').inside{...}</code></h3><p>Maven and JDK installers do not work with &quot;<code>docker.image('xxx').inside{...}</code>&quot; as the docker step does not allow the use of Tool Installer, the preinstalled Maven and JDK on the docker image will be auto-discovered and used.</p><h3 id="PipelineMavenPlugin-withMaven()notsupportedin&quot;docker.image(&#39;xxx&#39;).inside{...}&quot;witholdversionsoftheDockerengine"><code>withMaven()</code> not supported in &quot;<code>docker.image('xxx').inside{...}&quot;</code> with old versions of the Docker engine</h3><div><p><code>withMaven()</code> not supported in &quot;<code>docker.image('xxx').inside{...}</code>&quot; with old versions of the Docker engine such as Docker 1.13.1 on CentOS7.</p><p>Any help to fix this bug is more than welcome.</p>
<span class="jira-issue" data-jira-key="JENKINS-40484" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-40484?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14673&amp;avatarType=issuetype"/>JENKINS-40484</a>
                            -
            <span class="summary">Unable to use withMaven() step inside docker container for old versions of Docker</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-current
     jira-macro-single-issue-export-pdf">Reopened</span>
                </span>
</div><h1 id="PipelineMavenPlugin-Changelog">Changelog</h1><p>See <a href="https://github.com/jenkinsci/pipeline-maven-plugin/releases" class="external-link" rel="nofollow">https://github.com/jenkinsci/pipeline-maven-plugin/releases</a></p><div><span style="color: rgb(210,73,57);font-size: 16.0px;font-weight: bold;"><br/></span></div><div><span style="color: rgb(41,41,41);font-size: 24.0px;"><br/></span></div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/130951908.png">pipeline-maven-plugin-global-tools-configuration.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/133958072.png">image2017-8-7 12:38:11.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/133958100.png">image2017-8-7 15:18:50.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/133958102.png">image2017-8-7 15:19:41.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/133958103.png">image2017-8-7 15:22:4.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/135465875.png">downstream-pipeline-trigger-threshold-lifecycle.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/135465876.png">downstream-pipeline-trigger-threshold-build-result.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/135467376.png">JENKINS-47589-dao-troubleshooting-details.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/138448166.png">default-maven-settings-defined-at-the-folder-level.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/138451070.png">pipeline-maven-folder-level-configuration.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/165581993.png">pipeline-maven-plugin-configuration-1.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/165581995.png">pipeline-maven-plugin-configuration-2.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/165579460.png">pipeline-maven-plugin-configuration-1.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/165579461.png">pipeline-maven-plugin-configuration-2.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/165581999.png">pipeline-maven-plugin-configuration-disabled-pipeline-graph-publisher.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/175211407.png">pipeline-graph-publisher-maven-lifecycle.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/175211408.png">pipeline-graph-publisher-maven-lifecycle.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/175211406.png">pipeline-graph-publisher-maven-lifecycle.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/175211585.png">pipeline-maven-plugin-configuration-postgresql.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/99451377/175211733.png">global-tools-configuration-maven-settings.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:38</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
