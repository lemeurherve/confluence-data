<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Groovy plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Groovy plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (dvrzalik)</span>, last modified by <span class='editor'> Unknown User (alexander_samoylov)</span> on Oct 15, 2019
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View Groovy <a href="https://plugins.jenkins.io/groovy" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>

<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Older versions of this plugin may not be safe to use. Please review the following warnings before using an older version:</p>

<ul>
	<li><a href="https://jenkins.io/security/advisory/2017-04-10/" class="external-link" rel="nofollow">Arbitrary code execution vulnerability</a></li>
	<li><a href="https://jenkins.io/security/advisory/2019-01-28/#SECURITY-1293" class="external-link" rel="nofollow">Script Security sandbox bypass</a></li>
	<li><a href="https://jenkins.io/security/advisory/2019-03-06/#SECURITY-1338" class="external-link" rel="nofollow">Script security sandbox bypass</a></li>
</ul>

</div></div>
This plugin adds the ability to directly execute Groovy code.<h1 id="Groovyplugin-Configuration">Configuration</h1><p>To configure available Groovy installation on your system, go to Jenkins configuration page, find section 'Groovy' and fill the form as shown bellow.</p><p><br class="atl-forced-newline"/><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/11993090/12124162.png" data-image-src="attachments/11993090/12124162.png" data-unresolved-comment-count="0" data-linked-resource-id="12124162" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="snapshot6.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="11993090" data-linked-resource-container-version="80"></span></p><p>If you don't configure any Groovy installation and select <code>(Default)</code> option in a job, the plugin will fallback into calling just the <code>groovy</code> command, assuming you have <code>groovy</code> binary on the default path on given machine.</p><h1 id="Groovyplugin-Usage">Usage</h1><p>To create Groovy-based project, add new free-style project and select &quot;Execute Groovy script&quot; in the Build section, select previously configured Groovy installation and then type your command, or specify your script file name. In the second case path taken is relatively from the project workspace directory.</p><p>Jenkins 1.x:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/11993090/12124163.png" data-image-src="attachments/11993090/12124163.png" data-unresolved-comment-count="0" data-linked-resource-id="12124163" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="snapshot5.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="11993090" data-linked-resource-container-version="80"></span></p><p><br/></p><p>Jenkins 2.x:</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" alt="Jenkins 2.x" height="250" src="attachments/11993090/159121438.png" data-image-src="attachments/11993090/159121438.png" data-unresolved-comment-count="0" data-linked-resource-id="159121438" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2018-9-13_11-52-26.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="11993090" data-linked-resource-container-version="80" title="Jenkins 2.x"></span></p><p>The plugin also adds the functionality of the <a href="Jenkins-Script-Console.html">Script Console</a> to the project configuration page.</p><p>You can schedule your system management script...</p><p><br class="atl-forced-newline"/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/11993090/159121451.png" data-image-src="attachments/11993090/159121451.png" data-unresolved-comment-count="0" data-linked-resource-id="159121451" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2018-9-13_15-15-45.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="11993090" data-linked-resource-container-version="80"></span></p><p>...and then observe progress in the build log.</p><p><br class="atl-forced-newline"/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/11993090/159121449.png" data-image-src="attachments/11993090/159121449.png" data-unresolved-comment-count="0" data-linked-resource-id="159121449" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2018-9-13_15-14-57.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="11993090" data-linked-resource-container-version="80"></span></p><h2 id="Groovyplugin-GroovyScriptvsSystemGroovyScript">Groovy Script vs System Groovy Script</h2><p>The plain &quot;Groovy Script&quot; is run in a forked JVM, on the slave where the build is run. It's the basically the same as running the &quot;groovy&quot; command and pass in the script.</p><p>The system Groovy script on the other hand runs inside the Jenkins master's JVM. Thus it will have access to all the internal objects of Jenkins, so you can use this to alter the state of Jenkins. It is similar to the <a href="Jenkins-Script-Console.html">Jenkins Script Console</a> functionality.</p><h2 id="Groovyplugin-Security">Security</h2><p>System groovy jobs has access to whole Jenkins, therefore only users with admin rights can add system Groovy build step and configure the system Groovy script. Permissions are not checked when the build is triggered (i.e. also uses without admin rights can also run the script). The idea is to allow users run some well defined (defined by admin) system tasks when they need it (e.g. put slave offline/online, when user wants to start some debugging on slave). To have Jenkins instance secure, the support for Token macro plugin has to be switched off, see section below.</p><h2 id="Groovyplugin-Tokenmacropluginsupport">Token macro plugin support</h2><p>Groovy plugin provides support for  <a href="Token-Macro-Plugin.html">Token Macro Plugin</a>. Expression is <em>GROOVY</em> with parameter <em>script</em>:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>${GROOVY,script = &quot;return hudson.model.Hudson.instance.pluginManager.plugins&quot;}
</pre>
</div></div><p>By default, the support for token macro pressing is switched off and has to be switch on in global config page.</p><div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>If token macro processing via Token Macro Plugin is allowed, the evaluation of macro is done in System Groovy, therefore <span style="text-decoration: underline;">any user can run arbitrary system script</span>, regardless he has administer permission!</p></div></div><h2 id="Groovyplugin-Examples">Examples</h2><h3 id="Groovyplugin-Retrievingparametersandtriggeringanotherbuild">Retrieving parameters and triggering another build</h3><p>Execute a system Groovy script like:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">import hudson.model.*
import hudson.AbortException
import hudson.console.HyperlinkNote
import java.util.concurrent.CancellationException

// Retrieve parameters of the current build
def foo = build.buildVariableResolver.resolve(&quot;FOO&quot;)
println &quot;FOO=$foo&quot;

// Start another job
def job = Hudson.instance.getJob(&#39;MyJobName&#39;)
def anotherBuild
try {
    def params = [
      new StringParameterValue(&#39;FOO&#39;, foo),
    ]
    def future = job.scheduleBuild2(0, new Cause.UpstreamCause(build), new ParametersAction(params))
    println &quot;Waiting for the completion of &quot; + HyperlinkNote.encodeTo(&#39;/&#39; + job.url, job.fullDisplayName)
    anotherBuild = future.get()
} catch (CancellationException x) {
    throw new AbortException(&quot;${job.fullDisplayName} aborted.&quot;)
}
println HyperlinkNote.encodeTo(&#39;/&#39; + anotherBuild.url, anotherBuild.fullDisplayName) + &quot; completed. Result was &quot; + anotherBuild.result

// Check that it succeeded
build.result = anotherBuild.result
if (anotherBuild.result != Result.SUCCESS &amp;&amp; anotherBuild.result != Result.UNSTABLE) {
    // We abort this build right here and now.
    throw new AbortException(&quot;${anotherBuild.fullDisplayName} failed.&quot;)
}

// Do something with the output.
// On the contrary to Parameterized Trigger Plugin, you may now do something from that other build instance.
// Like the parsing the build log (see http://javadoc.jenkins-ci.org/hudson/model/FreeStyleBuild.html )
// You probably may also wish to update the current job&#39;s environment.
build.addAction(new ParametersAction(new StringParameterValue(&#39;BAR&#39;, &#39;3&#39;)))
</pre>
</div></div><h3 id="Groovyplugin-Retrieveproperties">Retrieve properties</h3><p>To retrieve properties defined in the Properties field use:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">System.getProperty(&#39;FOO&#39;)
</pre>
</div></div><h2 id="Groovyplugin-Usagewithpipeline">Usage with pipeline</h2><p>Currently the plugin does not support pipeline syntax. One workaround from <a class="confluence-userlink user-mention" data-username="alexander_samoylov" href="https://wiki.jenkins.io/display/~alexander_samoylov" data-linked-resource-id="104104318" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://wiki.jenkins.io">Unknown User (alexander_samoylov)</a> was mentioned here: <a href="https://stackoverflow.com/a/58381147/4807875" class="external-link" rel="nofollow">https://stackoverflow.com/a/58381147/4807875</a>.</p><h1 id="Groovyplugin-Changelog"><br/>Changelog</h1><h5 id="Groovyplugin-Release2.2(2019-03-06)">Release 2.2 (2019-03-06)</h5><ul><li><a href="https://jenkins.io/security/advisory/2019-03-06/#SECURITY-1339" class="external-link" rel="nofollow">Fix security issue</a></li></ul><h5 id="Groovyplugin-Release2.1(2019-01-28)">Release 2.1 (2019-01-28)</h5><ul><li><a href="https://jenkins.io/security/advisory/2019-01-28/" class="external-link" rel="nofollow">Fix security issue</a></li></ul><h5 id="Groovyplugin-Release2.0(2017-04-10)">Release 2.0 (2017-04-10)</h5><ul><li>Arbitrary code execution by unprivileged user (<a href="https://jenkins.io/security/advisory/2017-04-10/#groovy-plugin" class="external-link" rel="nofollow">SECURITY-292</a>)</li><li>continue with code cleanup - fixed Findbugs issues</li></ul><h5 id="Groovyplugin-Release1.30(2016-11-18)">Release 1.30 (2016-11-18)</h5><ul><li>XSS protection</li><li>code cleanup</li></ul><h5 id="Groovyplugin-Release1.28,1.29(2016-01-05)">Release 1.28, 1.29 (2016-01-05)</h5><ul><li>code cleanup</li></ul><h5 id="Groovyplugin-Release1.27(2015-08-05)">Release 1.27 (2015-08-05)</h5><ul><li><code>Callable</code> roles are properly checked</li></ul><h5 id="Groovyplugin-Release1.26(2015-07-27)">Release 1.26 (2015-07-27)</h5><ul><li>Ensured correct position of class path option (<a href="https://issues.jenkins-ci.org/browse/JENKINS-29577">JENKINS-29577</a>)</li><li>Improved help (<a href="https://github.com/jenkinsci/groovy-plugin/pull/18" class="external-link" rel="nofollow">pr #18</a>)</li></ul><h5 id="Groovyplugin-Release1.25(2015-05-11)">Release 1.25 (2015-05-11)</h5><ul><li>Made default choice also for System Groovy script to avoid zero height of textarea (<a href="https://issues.jenkins-ci.org/browse/JENKINS-25455">JENKINS-25455</a>)</li><li>Add help file for Groovy version (<a href="https://issues.jenkins-ci.org/browse/JENKINS-12988">JENKINS-12988</a>)</li><li>Made setting Groovy installations thread-safe (<a href="https://issues.jenkins-ci.org/browse/JENKINS-28287">JENKINS-28287</a>)</li></ul><h5 id="Groovyplugin-Release1.24(2014-11-09)">Release 1.24 (2014-11-09)</h5><ul><li>Ensure non-zero height of Groovy command text box, making it default choice when adding new build step (<a href="https://issues.jenkins-ci.org/browse/JENKINS-25455">JENKINS-25455</a>)</li></ul><h5 id="Groovyplugin-Release1.23(2014-10-27)">Release 1.23 (2014-10-27)</h5><ul><li>Set up correct GROOVY_HOME environment variable (<a href="https://issues.jenkins-ci.org/browse/JENKINS-25275">JENKINS-25275</a>)</li></ul><h5 id="Groovyplugin-Release1.22(2014-09-30)">Release 1.22 (2014-09-30)</h5><ul><li>Fixed slashes conversion in script parameters (<a href="https://issues.jenkins-ci.org/browse/JENKINS-24870">JENKINS-24870</a>)</li></ul><h5 id="Groovyplugin-Release1.21(2014-09-18)">Release 1.21 (2014-09-18)</h5><ul><li>Allow spaces in script parameters (<a href="https://issues.jenkins-ci.org/browse/JENKINS-24757">JENKINS-24757</a>)</li></ul><h5 id="Groovyplugin-Release1.20(2014-07-30)">Release 1.20 (2014-07-30)</h5><ul><li>Unable to specify multiple jars on class path for a system groovy script (<a href="https://issues.jenkins-ci.org/browse/JENKINS-23997">JENKINS-23997</a>)</li></ul><h5 id="Groovyplugin-Release1.19(2014-07-07)">Release 1.19 (2014-07-07)</h5><ul><li>Better parsing of parameters passed to Groovy binary, <a href="http://commons.apache.org/proper/commons-exec/" class="external-link" rel="nofollow">Apache commons-exec </a> used for parsing (<a href="https://issues.jenkins-ci.org/browse/JENKINS-23617">JENKINS-23617</a>)</li></ul><h5 id="Groovyplugin-Release1.18(2014-05-13)">Release 1.18 (2014-05-13)</h5><ul><li>NPE fixes (<a href="https://issues.jenkins-ci.org/browse/JENKINS-17171">JENKINS-17171</a>)</li></ul><h5 id="Groovyplugin-Release1.17(2014-05-09)">Release 1.17 (2014-05-09)</h5><ul><li>Allow whitespaces in properties (passed via -D switch) (<a href="https://github.com/jenkinsci/groovy-plugin/pull/13" class="external-link" rel="nofollow">pull13</a>)</li></ul><h5 id="Groovyplugin-Release1.16(2014-04-07)">Release 1.16 (2014-04-07)</h5><ul><li>Upgrade to @DataBoundConstructor (<a href="https://issues.jenkins-ci.org/browse/JENKINS-6797">JENKINS-6797</a>)</li><li>Fixed typo in warrning message (<a href="https://github.com/jenkinsci/groovy-plugin/pull/12" class="external-link" rel="nofollow">pull12</a>)</li></ul><h5 id="Groovyplugin-Release1.15(2014-01-31)">Release 1.15 (2014-01-31)</h5><ul><li>Syntax highlighting</li><li>Syntax validation button</li><li>Prepare for Jenkins core upgrade to Groovy 2.x (<a href="https://github.com/jenkinsci/groovy-plugin/pull/9" class="external-link" rel="nofollow">pull9</a>)</li></ul><h5 id="Groovyplugin-Release1.14(2013-07-02)">Release 1.14 (2013-07-02)</h5><ul><li>Right to run the System Groovy script changed from ADMINISTER to RUN_SCRIPTS (<a href="https://github.com/jenkinsci/groovy-plugin/pull/7" class="external-link" rel="nofollow">pull7</a>)</li></ul><h5 id="Groovyplugin-Release1.13(2013-03-01)">Release 1.13 (2013-03-01)</h5><ul><li>Added build context (build, launcher, listener) into system groovy build step (<a href="https://github.com/jenkinsci/groovy-plugin/pull/6" class="external-link" rel="nofollow">pull6</a>)</li></ul><h5 id="Groovyplugin-Release1.12(2012-03-08)">Release 1.12 (2012-03-08)</h5><ul><li>Fixed configuration of Token macro (<a href="https://github.com/jenkinsci/groovy-plugin/pull/5" class="external-link" rel="nofollow">pull5</a>)</li></ul><h5 id="Groovyplugin-Release1.11(2012-02-26)">Release 1.11 (2012-02-26)</h5><ul><li>Enabled env. variables expansion class path, groovy and script parameters</li></ul><h5 id="Groovyplugin-Release1.10(2012-02-09)">Release 1.10 (2012-02-09)</h5><ul><li>Fixed possible job configuration corruption when user isn't admin (<a href="https://issues.jenkins-ci.org/browse/JENKINS-12080">JENKINS-12080</a>)</li><li>Avoid NPE, add fallback if groovy executable is misoncifured (<a href="https://issues.jenkins-ci.org/browse/JENKINS-11652">JENKINS-11652</a>)</li></ul><h5 id="Groovyplugin-Release1.9(2011-09-14)">Release 1.9 (2011-09-14)</h5><ul><li>Auto installer (<a href="https://issues.jenkins-ci.org/browse/JENKINS-7113">JENKINS-7113</a> and <a href="https://issues.jenkins-ci.org/browse/JENKINS-10920">JENKINS-10920</a>)</li><li>Fixed error message on global config page (<a href="https://issues.jenkins-ci.org/browse/JENKINS-10768">JENKINS-10768</a>)</li><li>Expansion of job parameters (<a href="https://issues.jenkins-ci.org/browse/JENKINS-10525">JENKINS-10525</a>)</li><li>Full access to JAVA_OPTS (i.e. parameters like -Xmx can be set up)</li><li>Editable class path</li></ul><h5 id="Groovyplugin-Release1.8(2011-05-13)">Release 1.8 (2011-05-13)</h5><ul><li>Fixed a configuration persistence problem that can create huge config.xml</li></ul><h5 id="Groovyplugin-Release1.7(2011-03-09)">Release 1.7 (2011-03-09)</h5><ul><li>Added support for <a href="Token-Macro-Plugin.html">Token Macro Plugin</a></li></ul><h5 id="Groovyplugin-Release1.6(2011-02-08)">Release 1.6 (2011-02-08)</h5><ul><li>Fixed security issue</li></ul><h5 id="Groovyplugin-Release1.5(2010-11-10)">Release 1.5 (2010-11-10)</h5><ul><li>Classloader for actual System Groovy (<a href="https://issues.jenkins-ci.org/browse/JENKINS-6068">JENKINS-6068</a>)</li><li>Allowed groovy.bat in addition to groovy.exe (<a href="https://issues.jenkins-ci.org/browse/JENKINS-6839">JENKINS-6839</a>)</li><li>Temp files are removed (<a href="https://issues.jenkins-ci.org/browse/JENKINS-3269">JENKINS-3269</a>)</li><li>Hudson global properties are expanded in groovy script file path (<a href="https://issues.jenkins-ci.org/browse/JENKINS-8048">JENKINS-8048</a>)</li><li>Upgraded to 1.358 (<a href="https://issues.jenkins-ci.org/browse/JENKINS-6081">JENKINS-6081</a>)</li></ul><h5 id="Groovyplugin-Release1.4(2009-12-29)">Release 1.4 (2009-12-29)</h5><ul><li>Improve error message for missing groovy executable</li><li>Update uses of deprecated APIs</li></ul><h5 id="Groovyplugin-Release1.2">Release 1.2</h5><ul><li>Added possibility to specify properties and script parameters.</li><li>Added script source choice (file/command) for system groovy scripts.</li><li>Used .exe instead of .bat on Windows (as suggested by Scott Armit).</li><li>Added configuration option for classpath and initial variable bindings for<br/><a href="Jenkins-Script-Console.html">system groovy</a> scripts.</li></ul><h1 id="Groovyplugin-Knownbugs">Known bugs</h1><ul><li>Configuring more builders at once actually doesn't absolutely work. If you need more groovy builders in your project, you have to configure them one by one and always save project configuration before you add new one.</li></ul>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/11993090/12124161.png">snapshot7.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/11993090/12124162.png">snapshot6.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/11993090/12124163.png">snapshot5.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/11993090/12124164.png">snapshot4.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/11993090/159121438.png">image2018-9-13_11-52-26.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/11993090/159121449.png">image2018-9-13_15-14-57.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/11993090/159121451.png">image2018-9-13_15-15-45.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:26</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
