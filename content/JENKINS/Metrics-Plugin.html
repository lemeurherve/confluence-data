<!DOCTYPE html>
<html>
    <head>
        <title>Jenkins : Metrics Plugin</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Jenkins</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Plugins.html">Plugins</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Jenkins : Metrics Plugin
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Unknown User (stephenconnolly)</span>, last modified by <span class='editor'> Unknown User (alecharp)</span> on Jul 03, 2019
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"><p> Plugin Information </p></th>
</tr>
<tr>
<td class="confluenceTd"><p> View Metrics <a href="https://plugins.jenkins.io/metrics" class="external-link" rel="nofollow">on the plugin site</a> for more information. </p></td>
</tr>
</tbody></table>
</p><h1 id="MetricsPlugin-MetricsPlugin">Metrics Plugin</h1><p>This plugin exposes the <span style="text-decoration: line-through;">Codahale</span> <a href="https://github.com/dropwizard/metrics" class="external-link" rel="nofollow">Dropwizard Metrics API</a> within Jenkins</p><h2 id="MetricsPlugin-Standardhealthchecks">Standard health checks</h2><p>The Dropwizard Metrics API includes a contract for health checks. Health checks return a simple `PASS`/`FAIL` status and can include an optional message.</p><p><strong>`disk-space`</strong>:: Returns `FAIL` if any of the Jenkins disk space monitors are reporting<br/>the disk space as less than the configured threshold. The message will<br/>reference the first node which fails this check. There may be other<br/>nodes that fail the check, but this health check is designed to fail<br/>fast.</p><p><strong>`plugins`</strong>:: Returns `FAIL` if any of the Jenkins plugins failed to start. A<br/>failure is typically indicative of a potential issue within the<br/>Jenkins installation that will either be solved by explicitly<br/>disabling the failing plugin(s) or by resolving the corresponding<br/>plugin dependency issues.</p><p><strong>`temporary-space`</strong>:: Returns `FAIL` if any of the Jenkins temporary space monitors are<br/>reporting the temporary space as less than the configured threshold.<br/>The message will reference the first node which fails this check.<br/>There may be other nodes that fail the check, but this health check is<br/>designed to fail fast.</p><p><strong>`thread-deadlock`</strong>:: Returns `FAIL` if there are any deadlocked threads in the Jenkins<br/>master JVM.</p><h2 id="MetricsPlugin-Standardmetrics">Standard metrics</h2><p>There are five types of metric defined in the Dropwizard Metrics API:</p><ul><li>A <strong><em>gauge</em></strong> is an instantaneous measurement of a value</li><li>A <strong><em>counter</em></strong> is a gauge that tracks the count of something</li><li>A <strong><em>meter</em></strong> measures the rate of events over time. </li><li>A <strong><em>histogram</em></strong> measures the statistical distribution of values in a stream of data. </li><li>A <strong><em>timer</em></strong> is basically a histogram of the duration of events coupled with a meter of the rate of the event occurrence. </li></ul><h3 id="MetricsPlugin-SystemandJavaVirtualMachinemetrics">System and Java Virtual Machine metrics</h3><p><strong>`system.cpu.load`</strong> <strong><em>(gauge)</em></strong>:: The system load on the Jenkins master as reported by the JVM's Operating System JMX bean. _The calculation of system load is operating system dependent._ Typically this is the sum of the number<br/>of processes that are currently running plus the number that are waiting to run. This is typically comparable against the number of CPU cores.</p><p><strong>`vm.blocked.count`</strong> <strong><em>(gauge)</em></strong>:: The number of threads in the Jenkins master JVM that are currently blocked waiting for a monitor lock.</p><p><strong>`vm.count`</strong> <strong><em>(gauge)</em></strong><strong>:</strong>: The total number of threads in the Jenkins master JVM. This is the sum of: `vm.blocked.count`, `vm.new.count`, `vm.runnable.count`, `vm.terminated.count`, `vm.timed_waiting.count` and `vm.waiting.count`</p><p><strong>`vm.cpu.load`</strong> <strong><em>(gauge)</em></strong>*:: *The rate of CPU time usage by the JVM per unit time on the Jenkins master. This is equivalent to the number of CPU cores being used by the Jenkins master JVM.</p><p><strong>`</strong><strong>vm.daemon.count`</strong> <strong><em>(gauge)</em></strong>*::*The number of threads in the Jenkins master JVM that are marked as Daemon threads.</p><p><strong>`vm.deadlocks`</strong> <strong><em>(gauge)</em></strong><strong>::</strong> The number of threads that have a currently detected deadlock with at least one other thread.</p><p><strong>`vm.file.descriptor.ratio`</strong> <strong><em>(gauge)</em></strong>*:: *The ratio of used to total file descriptors. (This is a value between `0` and `1` inclusive)</p><p><strong>`vm.gc..count`</strong> <strong><em>(gauge)</em></strong>*:: *The number of times the `` garbage collector has run. The `` names are supplied by and dependent on the JVM. There will be one metric for each of the garbage collectors reported by the JVM.</p><p><strong>`vm.gc..time`</strong> <strong><em>(gauge)</em></strong>*:: *The amount of time spent in the `` garbage collector. The `` names are supplied by and dependent on the JVM. There will be one metric for each of the garbage collectors reported by the JVM.</p><p><strong>`vm.memory.heap.committed`</strong> <strong><em>(gauge)</em></strong>*:: *The amount of memory, in the heap that is used for object allocation, that is guaranteed by the operating system as available for use by the Jenkins master JVM. (Units of measurement: bytes)</p><p><strong>`vm.memory.heap.init`</strong> <strong><em>(gauge)</em></strong>*:: *The amount of memory, in the heap that is used for object allocation, that the Jenkins master JVM initially requested from the operating system. (Units of measurement: bytes)</p><p><strong>`vm.memory.heap.max`</strong> <strong><em>(gauge)</em></strong>*:: *The maximum amount of memory, in the heap that is used for object allocation, that the Jenkins master JVM is allowed to request from the operating system. This amount of memory is not guaranteed to be available for memory management if it is greater than the amount of committed memory. The JVM may fail to allocate memory even if the amount of used memory does not exceed this maximum size. (Units of measurement: bytes)</p><p><strong>`vm.memory.heap.usage`</strong> <strong><em>(gauge)</em></strong>*:: *The ratio of `vm.memory.heap.used` to `vm.memory.heap.max`. (This is a value between `0` and `1` inclusive)</p><p><strong>`vm.memory.heap.used`</strong> <strong><em>(gauge)</em></strong>*:: *The amount of memory, in the heap that is used for object allocation, that the Jenkins master JVM is currently using.(Units of measurement: bytes)</p><p><strong>`vm.memory.non-heap.committed`</strong> <strong><em>(gauge)</em></strong>*:: *The amount of memory, outside the heap that is used for object allocation, that is guaranteed by the operating system as available for use by the Jenkins master JVM. (Units of measurement: bytes)</p><p><strong>`vm.memory.non-heap.init`</strong> <strong><em>(gauge)</em></strong>*:: *The amount of memory, outside the heap that is used for object allocation, that the Jenkins master JVM initially requested from the operating system. (Units of measurement: bytes)</p><p><strong>`vm.memory.non-heap.max`</strong> <strong><em>(gauge)</em></strong>*:: *The maximum amount of memory, outside the heap that is used for object allocation, that the Jenkins master JVM is allowed to request from the operating system. This amount of memory is not guaranteed to be available for memory management if it is greater than the amount of committed memory. The JVM may fail to allocate memory even if the amount of used memory does not exceed this maximum size. (Units of measurement: bytes)</p><p><strong>`vm.memory.non-heap.usage`</strong> <strong><em>(gauge)</em></strong>*:: *The ratio of `vm.memory.non-heap.used` to `vm.memory.non-heap.max`. (This is a value between `0` and `1` inclusive)</p><p><strong>`vm.memory.non-heap.used`</strong> <strong><em>(gauge)</em></strong>*:: *The amount of memory, outside the heap that is used for object allocation, that the Jenkins master JVM is currently using. (Units of measurement: bytes)</p><p><strong>`vm.memory.pools..usage`</strong> <strong><em>(gauge)</em></strong>*:: *The usage level of the `` memory pool, where a value of `0` represents an unused pool while a value of `1` represents a pool that is at capacity. The `` names are supplied by and dependent on the JVM. There will be one metric for each of the memory pools reported by the JVM. `vm.memory.total.committed` <em>(gauge)</em>:: The total amount of memory that is guaranteed by the operating system as available for use by the Jenkins master JVM. (Units of measurement: bytes)</p><p><strong>`vm.memory.total.init`</strong> <strong><em>(gauge)</em></strong>*:: *The total amount of memory that the Jenkins master JVM initially requested from the operating system. (Units of measurement: bytes)</p><p><strong>`vm.memory.total.max`</strong> <strong><em>(gauge)</em></strong>*:: *The maximum amount of memory that the Jenkins master JVM is allowed to request from the operating system. This amount of memory is not guaranteed to be available for memory management if it is greater than the amount of committed memory. The JVM may fail to allocate memory even if the amount of used memory does not exceed this maximum size. (Units of measurement: bytes)</p><p><strong>`vm.memory.total.used`</strong> <strong><em>(gauge)</em></strong>*:: *The total amount of memory that the Jenkins master JVM is currently using.(Units of measurement: bytes)</p><p><strong>`vm.new.count`</strong> <strong><em>(gauge)</em></strong>*:: *The number of threads in the Jenkins master JVM that have not currently started execution.</p><p><strong>`vm.runnable.count`</strong> <strong><em>(gauge)</em></strong><strong>::</strong> The number of threads in the Jenkins master JVM that are currently executing in the JVM. Some of these threads may be waiting for other resources from the operating system such as the processor.</p><p><strong>`vm.terminated.count`</strong> <strong><em>(gauge)</em></strong>*:: *The number of threads in the Jenkins master JVM that have completed execution.</p><p><strong>`vm.timed_waiting.count`</strong> <strong><em>(gauge)</em></strong>*:: *The number of threads in the Jenkins master JVM that have suspended execution for a defined period of time.</p><p><strong>`vm.uptime.milliseconds`</strong> <strong><em>(gauge)</em></strong><strong>::</strong> The number of milliseconds since the Jenkins master JVM started</p><p><strong>`vm.waiting.count`</strong> <strong><em>(gauge)</em></strong>*:: *The number of threads in the Jenkins master JVM that are currently waiting on another thread to perform a particular action.</p><h3 id="MetricsPlugin-WebUImetrics">Web UI metrics</h3><p><strong>`http.activeRequests`</strong> <strong><em>(counter)</em></strong>*:: *The number of currently active requests against the Jenkins master Web UI.<br/><strong>`http.responseCodes.badRequest`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/400` status code<br/><strong>`http.responseCodes.created`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/201` status code<br/><strong>`http.responseCodes.forbidden`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/403` status code<br/><strong>`http.responseCodes.noContent`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/204` status code<br/><strong>`http.responseCodes.notFound`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/404` status code<br/><strong>`http.responseCodes.notModified`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/304` status code<br/><strong>`http.responseCodes.ok`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/200` status code<br/><strong>`http.responseCodes.other`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a non-informational status code that is not in the list: `HTTP/200`, `HTTP/201`, `HTTP/204`, `HTTP/304`, `HTTP/400`, `HTTP/403`, `HTTP/404`, `HTTP/500`, or `HTTP/503`<br/><strong>`http.responseCodes.serverError`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/500` status code<br/><strong>`http.responseCodes.serviceUnavailable`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which the Jenkins master Web UI is responding to requests with a `HTTP/503` status code<br/><strong>`http.requests`</strong> <strong><em>(timer)</em></strong>*:: *The rate at which the Jenkins master Web UI is receiving requests and the time spent generating the corresponding responses.</p><p><span style="color: rgb(210,73,57);"><strong>Jenkins specific metrics</strong></span></p><p><strong>`jenkins.executor.count.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of executors available to Jenkins. This is corresponds to the sum of all the executors of all the on-line nodes.<br/><strong>`jenkins.executor.count.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.executor.count.value`.<br/><strong>`jenkins.executor.free.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of executors available to Jenkins that are not currently in use.<br/><strong>`jenkins.executor.free.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.executor.free.value`.<br/><strong>`jenkins.executor.in-use.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of executors available to Jenkins that are currently in use.<br/><strong>`jenkins.executor.in-use.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.executor.in-use.value`.<br/><strong>`jenkins.health-check.count`</strong> <strong><em>(gauge)</em></strong>*:: *The number of health checks associated with the HealthCheckRegistry defined within the Metrics Plugin<br/><strong>`jenkins.health-check.duration`</strong> <strong><em>(timer)</em></strong>*:: *The rate at which the health checks are being run and the duration of each health check run. The Metrics Plugin, by default, will run the health checks once per minute. The frequency can be controlled by the `jenkins.metrics.api.Metrics.HEALTH_CHECK_INTERVAL_MINS` system property. In addition, the Metrics Plugin's Operational Servlet can be used to request the health checks be run on demand.</p><p><strong>`jenkins.health-check.inverse-score`</strong> <strong><em>(gauge)</em></strong>*:: *The ratio of health checks reporting failure to the total number of health checks. Larger values indicate decreasing health as measured by the health checks. (This is a value between `0` and `1` inclusive)<br/><strong>`jenkins.health-check.score`</strong> <strong><em>(gauge)</em></strong>*:: *The ratio of health checks reporting success to the total number of health checks. Larger values indicate increasing health as measured by the health checks. (This is a value between `0` and `1` inclusive)<br/><strong>`jenkins.job.blocked.duration`</strong> <strong><em>(timer)</em></strong>*:: *The rate at which jobs in the build queue enter the blocked state and the amount of time they spend in that state.<br/><strong>`jenkins.job.buildable.duration`</strong> <strong><em>(timer)</em></strong>*:: *The rate at which jobs in the build queue enter the buildable state and the amount of time they spend in that state.<br/><strong>`jenkins.job.building.duration`</strong> <strong><em>(timer)</em></strong>*:: *The rate at which jobs are built and the time they spend building.<br/><strong>`jenkins.job.queuing.duration`</strong> <strong><em>(timer)</em></strong>*:: *The rate at which jobs are queued and the total time they spend in the build queue.<br/><strong>`jenkins.job.total.duration`</strong> <strong><em>(timer)</em></strong>*:: *The rate at which jobs are queued and the total time they spend from entering the build queue to completing building<br/><strong>`jenkins.job.waiting.duration`</strong> <strong><em>(timer)</em></strong>*:: *The rate at which jobs enter the quiet period and the total amount of time that jobs spend in their quiet period. Jenkins allows configuring a quiet period for most job types. While in the quiet period multiple identical requests for building the job will be coalesced. Traditionally this was used with source control systems that do not provide an atomic commit facility - such as CVS - in order to ensure that all the files in a large commit were picked up as a single build. With more modern source control systems the quiet period can still be useful, for example to ensure that push notification of the came commit via redundant parallel notification paths get coalesced.<br/><strong>`jenkins.job.count.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of jobs in Jenkins<br/><strong>`jenkins.job.count.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.job.count.value`.<br/><strong>`jenkins.job.scheduled`</strong> <strong><em>(meter)</em></strong>*:: *The rate at which jobs are scheduled. If a job is already in the queue and an identical request for scheduling the job is received then Jenkins will coalesce the two requests. This metric gives a reasonably pure measure of the load requirements of the Jenkins master as it is unaffected by the number of executors available to the system. Multiplying this metric by `jenkins.job.building.duration` gives an approximate measure of the number of executors required in order to ensure that every build request results in a build. A more accurate measure can be obtained from a job-by-job summation of the scheduling rate for that job and the average build duration of that job.The most accurate measure would require maintaining separate sums partitioned by the labels that each job can run against in order to determine the number of each type of executor required. Such calculations assume that: every build node is equivalent and/or the build times are comparable across all build nodes; and build times are unaffected by other jobs running in parallel on other executors on the same node. However in most cases even the basic result from multiplying `jenkins.job.scheduled` by `jenkins.job.building.duration` gives a reasonable result. Where larger than `jenkins.executor.count.value` by more than 10-15% the Jenkins build queue is typically observed to grow rapidly until most jobs have at least one build request sitting in the build queue. Whereas when less than `jenkins.executor.count.value` by at least 20-25% the build queue will tend to remain small, except for those cases where there are a large number of build jobs fighting for a small number of executors on nodes with specific labels.</p><p><strong>`jenkins.node.count.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of build nodes available to Jenkins, both on-line and off-line.<br/><strong>`jenkins.node.count.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.node.count.value`.<br/><strong>`jenkins.node._</strong><strong><em>XXX</em></strong><strong><em>.builds` _(timer)</em></strong>*:: *The rate of builds starting on the `_<em>XXX</em>_` node and the amount of time they spend building. There will be one metric for each `_<em>XXX</em>_` named node. The metric is lazily created after the JVM starts up when the first build starts on that node.<br/><strong>`jenkins.node.offline.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of build nodes available to Jenkins but currently off-line.<br/><strong>`jenkins.node.offline.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.node.offline.value`.<br/><strong>`jenkins.node.online.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of build nodes available to Jenkins and currently on-line.<br/><strong>`jenkins.node.online.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.node.online.value`.<br/><strong>`jenkins.plugins.active`</strong> <strong><em>(gauge)</em></strong><strong>::</strong> The number of plugins in the Jenkins instance that started successfully.<br/><strong>`jenkins.plugins.failed`</strong> <strong><em>(gauge)</em></strong>*:: *The number of plugins in the Jenkins instance that failed to start. A value other than `0` is typically indicative of a potential issue within the Jenkins installation that will either be solved by explicitly disabling the plugin(s) or by resolving the plugin dependency issues.<br/><strong>`jenkins.plugins.inactive`</strong> <strong><em>(gauge)</em></strong>*:: *The number of plugins in the Jenkins instance that are not currently enabled.<br/><strong>`jenkins.plugins.withUpdate`</strong> <strong><em>(gauge)</em></strong>*:: *The number of plugins in the Jenkins instance that have an newer version reported as available in the current Jenkins update center metadata held by Jenkins. This value is not indicative of an issue with Jenkins but high values can be used as a trigger to review the plugins with updates with a view to seeing whether those updates potentially contain fixes for issues that could be affecting your Jenkins instance.<br/><strong>`jenkins.queue.blocked.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of jobs that are in the Jenkins build queue and currently in the blocked state.<br/><strong>`jenkins.queue.blocked.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.queue.blocked.value`.<br/><strong>`jenkins.queue.buildable.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of jobs that are in the Jenkins build queue and currently in the blocked state.<br/><strong>`jenkins.queue.buildable.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.queue.buildable.value`.<br/><strong>`jenkins.queue.pending.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of jobs that are in the Jenkins build queue and currently in the blocked state.<br/><strong>`jenkins.queue.pending.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.queue.pending.value`.<br/><strong>`jenkins.queue.size.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of jobs that are in the Jenkins build queue.<br/><strong>`jenkins.queue.size.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.queue.size.value`.<br/><strong>`jenkins.queue.stuck.value`</strong> <strong><em>(gauge)</em></strong>*:: *The number of jobs that are in the Jenkins build queue and currently in the blocked state.<br/><strong>`jenkins.queue.stuck.history`</strong> <strong><em>(histogram)</em></strong>*:: *The historical statistics of `jenkins.queue.stuck.value`.</p><p><span style="color: rgb(210,73,57);"><strong>Dropwizard Operational Menu Servlet</strong></span></p><p>There is a very basic set of standard servlets provided by Dropwizard in conjunction with an Operational menu.<br/><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/71436240/72614007.png" data-image-src="attachments/71436240/72614007.png" data-unresolved-comment-count="0" data-linked-resource-id="72614007" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2014-05-07 at 11.14.32.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71436240" data-linked-resource-container-version="43"></span><br/>The Metrics servlet returns the Metrics in JSON format (There is also support for JSONP format by requesting Content-Type: text/javascript).<br/>The Ping servlet returns the text &quot;pong&quot; and a HTTP/200 status code.<br/>The Threads servlet returns a thread dump from the master only.<br/>The Healthcheck servlet runs the healthchecks defined against the Metrics API and returns the detailed status in JSON (or JSONP) format, while the high level status is reported by the HTTP status code.</p><p>These servlets are protected by security controls in order to ensure that they are not abused</p><h3 id="MetricsPlugin-Useraccess">User access</h3><p>Authenticated users can access the Dropwizard Metrics Servlet at $JENKINS_URL/metrics/currentUser/ if they have the Metrics/View permission.</p><p>Access to the Thread Dumps and Health Checks are given a finer-grained control using the Metrics/ThreadDump and Metrics/HealthCheck permissions respectively.</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/71436240/72614008.png" data-image-src="attachments/71436240/72614008.png" data-unresolved-comment-count="0" data-linked-resource-id="72614008" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2014-05-07 at 11.21.13.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71436240" data-linked-resource-container-version="43"></span></p><p>This is because thread dumps and health checks may expose information about job names or build nodes which may be against organization security policies.</p><h3 id="MetricsPlugin-Machineaccess">Machine access</h3><p>Access to the Metrics Servlet can also be provided by issuing API keys. API keys can be configured from the Jenkins global configuration screen ($JENKINS_URL/configure) under the “Metrics” section. Multiple access can be generated and permissions associated with those keys can also be restricted at this level.</p><p>Alternatively, Metrics can be restricted to users with a specified access key to the metrics. This configuration can be set up using the Jenkins global configuration screen (&lt;jenkins-url&gt;/configure) under the “Metrics” section. Multiple access can be generated, and access keys’ permissions can be restricted at this level.<br/><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="attachments/71436240/72614006.png" data-image-src="attachments/71436240/72614006.png" data-unresolved-comment-count="0" data-linked-resource-id="72614006" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2014-05-07 at 11.08.13.png" data-base-url="https://wiki.jenkins.io" data-linked-resource-content-type="image/png" data-linked-resource-container-id="71436240" data-linked-resource-container-version="43"></span><br/>Each API key can be configured with unique permissions for the four servlets that the Dropwizard Metrics Servlet offers and each API key can be configured with its own CORS supported origins.</p><ul><li>HTTP GET requests are using the base URL $JENKINS_URL/metrics/$KEY/</li><li>HTTP POST requests are using the base URL $JENKINS_URL/metrics/ with the key provided by a standard URL encoded form parameter called key</li></ul><h2 id="MetricsPlugin-VersionHistory"><strong><span style="color: rgb(210,73,57);">Version History</span></strong></h2><h3 id="MetricsPlugin-Version4.0.2.5(3rdJuly2019)"><strong><span style="color: rgb(210,73,57);">Version 4.0.2.5 (3rd July 2019)</span></strong></h3><ul><li>Format JMX names (
<span class="jira-issue resolved" data-jira-key="JENKINS-58169" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-58169?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14680&amp;avatarType=issuetype"/>JENKINS-58169</a>
                            -
            <span class="summary">JMX: Use hierarchical names</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Resolved</span>
                </span>
)</li><li>Do not export VM and System metrics on JXM (
<span class="jira-issue resolved" data-jira-key="JENKINS-57909" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-57909?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14680&amp;avatarType=issuetype"/>JENKINS-57909</a>
                            -
            <span class="summary">JMX: VM and System metrics shouldn&#39;t be exported</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Resolved</span>
                </span>
)</li><li>Use proper domain for JMX elements (
<span class="jira-issue resolved" data-jira-key="JENKINS-57908" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-57908?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14680&amp;avatarType=issuetype"/>JENKINS-57908</a>
                            -
            <span class="summary">Export JMX using a proper domain</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Resolved</span>
                </span>
)</li></ul><h3 id="MetricsPlugin-Version4.0.2.4(12thJune2019)"><strong><span style="color: rgb(210,73,57);">Version 4.0.2.4 (12th June 2019)</span></strong></h3><ul><li>Add a <a href="https://github.com/jenkinsci/configuration-as-code-plugin" class="external-link" rel="nofollow">JCasC</a> roundtrip test (
<span class="jira-issue resolved" data-jira-key="JENKINS-57761" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-57761?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14680&amp;avatarType=issuetype"/>JENKINS-57761</a>
                            -
            <span class="summary">Create JCasC tests for metrics plugin</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Closed</span>
                </span>
)</li></ul><h3 id="MetricsPlugin-Version4.0.2.3(5thFebruary2019)"><strong><span style="color: rgb(210,73,57);">Version 4.0.2.3 (5th February 2019)</span></strong></h3><ul><li>Incrementalify plugin version (
<span class="jira-issue resolved" data-jira-key="JENKINS-51308" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-51308?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14688&amp;avatarType=issuetype"/>JENKINS-51308</a>
                            -
            <span class="summary">[JEP-305] Incrementalify the Metrics plugin</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Resolved</span>
                </span>
)</li><li>Support Java9+ JVM (
<span class="jira-issue resolved" data-jira-key="JENKINS-52017" >
                    <a href="https://issues.jenkins.io/browse/JENKINS-52017?src=confmacro" class="jira-issue-key"><img class="icon"
                                                                                      src="https://issues.jenkins.io/secure/viewavatar?size=xsmall&amp;avatarId=14673&amp;avatarType=issuetype"/>JENKINS-52017</a>
                            -
            <span class="summary">Metrics Plugin relies on un-exposed module API</span>
                                                <span class="aui-lozenge aui-lozenge-subtle             aui-lozenge-success
     jira-macro-single-issue-export-pdf">Resolved</span>
                </span>
)</li></ul><h3 id="MetricsPlugin-Version4.0.2.2(22ndJune2018)">Version 4.0.2.2 (22nd June 2018)</h3><ul><li>Provide an API to report on the Queue Item metrics (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-52141" class="external-link" rel="nofollow">52141</a>)</li></ul><h3 id="MetricsPlugin-Version4.0.2.1(21stJune2018)">Version 4.0.2.1 (21st June 2018)</h3><div><ul><li>Minor follow-up fix after switch to weak hash map for tracking node specific stats (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-32868" class="external-link" rel="nofollow">32868</a>)</li></ul></div><h3 id="MetricsPlugin-Version4.0.2.0(21stJune2018)">Version 4.0.2.0 (21st June 2018)</h3><ul><li>Upgrade to Metrics 4.0.2. Now requires Jenkins 2.60.3 or newer and Java 8 (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-52061" class="external-link" rel="nofollow">52061</a>)</li><li>Register metrics added in dynamically installed plugins (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-52067" class="external-link" rel="nofollow">52067</a>)</li><li>Auto-start PeriodicWork extensions when metrics plugin is dynamically installed on Jenkins &lt; 2.129 (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-52072" class="external-link" rel="nofollow">52072</a>)</li><li>Queuing times of pipeline jobs are incorrectly reported (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-52074" class="external-link" rel="nofollow">52074</a>)</li><li>Track cumulative execution time of pipelins jobs with multiple node blocks (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-52075" class="external-link" rel="nofollow">52075</a>)</li><li>Defence against NPE from Jenkins core (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-44947" class="external-link" rel="nofollow">44947</a>)</li><li>Switch to a weak hash map for tracking node specific stats (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-32868" class="external-link" rel="nofollow">32868</a>)</li><li>Don't run healthchecks before Jenkin startup has completed (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-32926" class="external-link" rel="nofollow">32926</a>) </li></ul><h3 id="MetricsPlugin-Version3.1.2.12(11thMay2018)">Version 3.1.2.12 (11th May 2018)</h3><ul><li>Adjust to new logs rotation root (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-50291" class="external-link" rel="nofollow">50291</a>)</li><li>Origins field was not being saved (issue #<a href="https://issues.jenkins-ci.org/browse/JENKINS-50722" class="external-link" rel="nofollow">50722</a>)</li><li>Add a data bound setter for access keys to allow configuration-as-code to configure (<a href="https://github.com/jenkinsci/metrics-plugin/pull/31" class="external-link" rel="nofollow">PR#31</a>)</li><li>Fix the temporary disk space health check (<a href="https://github.com/jenkinsci/metrics-plugin/pull/33" class="external-link" rel="nofollow">PR#33</a>)</li></ul><h3 id="MetricsPlugin-Version3.1.2.11(7thMarch2018)">Version 3.1.2.11 (7th March 2018)</h3><ul><li>Fix loading of custom health check providers from newly installed plugins (issue <a href="https://issues.jenkins-ci.org/browse/JENKINS-44486" class="external-link" rel="nofollow">#44486</a>)</li></ul><h3 id="MetricsPlugin-Version3.1.2.10(1stJune2017)">Version 3.1.2.10 (1st June 2017)</h3><ul><li>Expose metrics via JMX</li></ul><h3 id="MetricsPlugin-Version3.1.2.9(27thJuly2016)">Version 3.1.2.9 (27th July 2016)</h3><ul><li>Add classloading statistics</li><li>Track average folder depth of jobs</li><li>Provide history and window tracking for important JVM stats such as CPU load, memory usage and file descriptor usage</li></ul><h3 id="MetricsPlugin-Version3.1.2.8(17thJune2016)">Version 3.1.2.8 (17th June 2016)</h3><ul><li>Move the health check logs into JENKINS_HOME/logs</li></ul><h3 id="MetricsPlugin-Version3.1.2.7(19thFebruary2016)">Version 3.1.2.7 (19th February 2016)</h3><ul><li>Fix logging level to stop sending spam to the logs every time the health checks are run</li></ul><h3 id="MetricsPlugin-Version3.1.2.6(18thFebruary2016)">Version 3.1.2.6 (18th February 2016)</h3><ul><li>Fix calculation of queue size to prevent false rejected executions of health checks</li></ul><h3 id="MetricsPlugin-Version3.1.2.5(11thFebruary2016)">Version 3.1.2.5 (11th February 2016)</h3><ul><li>Stop spamming the logs with </li><li><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"> WARNING: HealthCheck Runnable is not an instance of Future: null
</pre>
</div></div></li></ul><h3 id="MetricsPlugin-Version3.1.2.4(5thFebruary2016)">Version 3.1.2.4 (5th February 2016)</h3><ul><li>Restore backwards API binary compatibility by actually processing the @WithBridgeMethods annotations</li></ul><h3 id="MetricsPlugin-Version3.1.2.3(2ndFebruary2016)">Version 3.1.2.3 (2nd February 2016)</h3><ul><li>Results from health checks were lost when more than 3 requests run at the same time (<a href="https://issues.jenkins-ci.org/browse/JENKINS-32695" class="external-link" rel="nofollow">issue #32695</a>)</li><li>Add caching to the health check API end-points (caching can be disabled with Cache-Control: max-age=0 header) (<a href="https://issues.jenkins-ci.org/browse/JENKINS-32696" class="external-link" rel="nofollow">issue #32696</a>)</li><li>Improve Javadoc documentation</li></ul><h3 id="MetricsPlugin-Version3.1.2.2(13thJanuary2016)">Version 3.1.2.2 (13th January 2016)</h3><ul><li>Improve log line readability</li><li>Fix typo in class name</li><li>Make the health check results available as a Java object for downstream plugins to consume</li></ul><h3 id="MetricsPlugin-Version3.1.2.1(28thOctober2015)">Version 3.1.2.1 (28th October 2015)</h3><ul><li>Switch to <a href="Jackson2-API-Plugin.html">Jackson2 API Plugin</a> for dependency on Jackson2 API</li><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-31054" class="external-link" rel="nofollow">JENKINS-31054</a> Generate button did not work</li></ul><h3 id="MetricsPlugin-Version3.1.2(2ndOctober2015)">Version 3.1.2 (2nd October 2015)</h3><ul><li>Upgrade metrics library to 3.1.2</li><li>Expose plugin versions in metrics data </li></ul><h3 id="MetricsPlugin-Version3.0.11(5thJune2015)">Version 3.0.11 (5th June 2015)</h3><ul><li><a href="https://issues.jenkins-ci.org/browse/JENKINS-28620" class="external-link" rel="nofollow">JENKINS-28620</a> NPE after upgrade to 3.0.10</li></ul><h3 id="MetricsPlugin-Version3.0.10(24thApril2015)">Version 3.0.10 (24th April 2015)</h3><ul><li>An endpoint to return status 200 if everything is OK, status 417 otherwise</li></ul><h3 id="MetricsPlugin-Version3.0.9(18thNovember2014)">Version 3.0.9 (18th November 2014)</h3><ul><li>Count AbstractProjects so that MavenModuleSets are included when counting jobs.</li></ul><h3 id="MetricsPlugin-Version3.0.8(12thNovember2014)">Version 3.0.8 (12th November 2014)</h3><ul><li>Add project, disabled, enabled counts</li><li>Only TopLevelItems should be reported in jenkins.job.count.*</li></ul><h3 id="MetricsPlugin-Version3.0.7(3rdOctober2014)">Version 3.0.7 (3rd October 2014)</h3><ul><li>There was a race condition during startup that could occasionally cause a deadlock if there was both an unfortunately timed HTTP request and another plugin was attempting to enumerate extension points before <a href="http://javadoc.jenkins-ci.org/hudson/init/InitMilestone.html#EXTENSIONS_AUGMENTED" class="external-link" rel="nofollow">extension points can safely be enumerated</a>. The metrics plugin now does not attempt to enumerate extension points until after the safe-point has been reached. (If you want to understand one case where this deadlock can occur, see <a href="http://developer-blog.cloudbees.com/2014/10/the-jenkins-plugin-developer-case-files.html" class="external-link" rel="nofollow">this blog post</a>)</li></ul><h3 id="MetricsPlugin-Version3.0.6(8thSeptember2014)">Version 3.0.6 (8th September 2014)</h3><ul><li>Expose Build successful/unstable/failed/etc metrics (<a href="https://issues.jenkins-ci.org/browse/JENKINS-23933" class="external-link" rel="nofollow">JENKINS-23933</a>, <a href="https://github.com/jenkinsci/metrics-plugin/pull/3" class="external-link" rel="nofollow">Pull Request 3</a>)</li><li>Nicer build action reporting build times (<a href="https://github.com/jenkinsci/metrics-plugin/pull/1" class="external-link" rel="nofollow">Pull Request 1</a>)</li></ul><h3 id="MetricsPlugin-Version3.0.5(13thJune2014)">Version 3.0.5 (13th June 2014)</h3><ul><li>Enable the prefix and postfix json path manipulation options in metricsHistory urls</li><li>Performance improvement to avoid the cost of sorting required when calling <strong>Jenkins.getAllItems(Class)</strong></li></ul><h3 id="MetricsPlugin-Version3.0.4(27thMay2014)">Version 3.0.4 (27th May 2014)</h3><ul><li>Fix NPE when using the MetricsAccessKey.Provider and there are no manually defined access keys</li></ul><h3 id="MetricsPlugin-Version3.0.3(12thMay2014)">Version 3.0.3 (12th May 2014)</h3><ul><li>When the health checks are reporting disk space issues on the master, report the node name as <code>(master)</code> and not the empty string!</li></ul><h3 id="MetricsPlugin-Version3.0.2(9thMay2014)">Version 3.0.2 (9th May 2014)</h3><ul><li>Fix braindead bug in boolean logic &quot;optimization&quot; that resulted in the logs still being spammed with identical failing health check reports.</li></ul><h3 id="MetricsPlugin-Version3.0.1(7thMay2014)">Version 3.0.1 (7th May 2014)</h3><ul><li>Decrease log spamming (only log failing health checks above FINE level when there are changes from the last reported failing health checks)</li><li>When logging failing health checks, include the reason for the failure.</li><li>Fix string formatting of failing standard health checks</li><li>Add jenkins.node.offline and jenkins.executor.free metrics (both of which could be calculated but some metrics reporting systems make such calculations more complicated and these metrics are quite useful for alerting etc.)</li></ul><h3 id="MetricsPlugin-Version3.0(19thMarch2014)">Version 3.0 (19th March 2014)</h3><ul><li>Initial release</li></ul>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71436240/72614006.png">Screen Shot 2014-05-07 at 11.08.13.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71436240/72614007.png">Screen Shot 2014-05-07 at 11.14.32.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/71436240/72614008.png">Screen Shot 2014-05-07 at 11.21.13.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                 
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Sep 07, 2021 13:34</p>
                    <div id="footer-logo"><a href="/display/">Wiki home</a></div>
                </section>
            </div>
        </div>     </body>
</html>
